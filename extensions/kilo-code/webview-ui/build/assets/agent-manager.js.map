{
  "version": 3,
  "file": "agent-manager.js",
  "sources": [
    "../../../../node_modules/.pnpm/react-i18next@15.5.1_i18next@25.2.1_typescript@5.8.3__react-dom@18.3.1_react@18.3.1__react@18.3.1_typescript@5.8.3/node_modules/react-i18next/dist/es/I18nextProvider.js",
    "../../../../node_modules/.pnpm/lucide-react@0.518.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/arrow-right-left.js",
    "../../../../node_modules/.pnpm/lucide-react@0.518.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/circle-alert.js",
    "../../../../node_modules/.pnpm/lucide-react@0.518.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/circle-check.js",
    "../../../../node_modules/.pnpm/lucide-react@0.518.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/circle.js",
    "../../../../node_modules/.pnpm/lucide-react@0.518.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/git-pull-request.js",
    "../../../../node_modules/.pnpm/lucide-react@0.518.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/layers.js",
    "../../../../node_modules/.pnpm/lucide-react@0.518.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/loader.js",
    "../../../../node_modules/.pnpm/lucide-react@0.518.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/terminal.js",
    "../../../../node_modules/.pnpm/jotai@2.15.2_@babel+core@7.27.1_@babel+template@7.27.2_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla/internals.mjs",
    "../../../../node_modules/.pnpm/jotai@2.15.2_@babel+core@7.27.1_@babel+template@7.27.2_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla.mjs",
    "../../../../node_modules/.pnpm/jotai@2.15.2_@babel+core@7.27.1_@babel+template@7.27.2_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/react.mjs",
    "../../../../node_modules/.pnpm/jotai@2.15.2_@babel+core@7.27.1_@babel+template@7.27.2_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla/utils.mjs",
    "../../../../webview-ui/src/kilocode/agent-manager/state/sessionStateMachine.ts",
    "../../../../webview-ui/src/kilocode/agent-manager/state/atoms/sessions.ts",
    "../../../../webview-ui/src/kilocode/agent-manager/state/atoms/stateMachine.ts",
    "../../../../webview-ui/src/kilocode/agent-manager/state/atoms/messages.ts",
    "../../../../webview-ui/src/kilocode/agent-manager/state/atoms/todos.ts",
    "../../../../webview-ui/src/kilocode/agent-manager/state/atoms/branches.ts",
    "../../../../webview-ui/src/kilocode/agent-manager/state/atoms/models.ts",
    "../../../../webview-ui/src/kilocode/agent-manager/state/hooks/extractTodosFromMessages.ts",
    "../../../../webview-ui/src/kilocode/agent-manager/state/hooks/useAgentManagerMessages.ts",
    "../../../../webview-ui/src/kilocode/agent-manager/state/atoms/messageQueue.ts",
    "../../../../webview-ui/src/kilocode/agent-manager/utils/vscode.ts",
    "../../../../webview-ui/src/kilocode/agent-manager/state/hooks/useMessageQueueProcessor.ts",
    "../../../../webview-ui/src/kilocode/agent-manager/utils/timeUtils.ts",
    "../../../../webview-ui/src/kilocode/agent-manager/components/SessionSidebar.tsx",
    "../../../../webview-ui/src/kilocode/agent-manager/components/SimpleMarkdown.tsx",
    "../../../../webview-ui/src/kilocode/agent-manager/components/FollowUpSuggestions.tsx",
    "../../../../webview-ui/src/kilocode/agent-manager/components/CommandExecutionBlock.tsx",
    "../../../../webview-ui/src/kilocode/agent-manager/components/MessageList.tsx",
    "../../../../webview-ui/src/kilocode/agent-manager/components/AgentTodoList.tsx",
    "../../../../webview-ui/src/kilocode/agent-manager/components/ChatInput.tsx",
    "../../../../webview-ui/src/kilocode/agent-manager/components/BranchPicker.tsx",
    "../../../../webview-ui/src/kilocode/agent-manager/components/KiloLogo.tsx",
    "../../../../webview-ui/src/kilocode/agent-manager/components/SessionDetail.tsx",
    "../../../../webview-ui/src/kilocode/agent-manager/components/AgentManagerApp.tsx",
    "../../../../webview-ui/src/kilocode/agent-manager/index.tsx"
  ],
  "sourcesContent": [
    "import { createElement, useMemo } from 'react';\nimport { I18nContext } from './context.js';\nexport function I18nextProvider({\n  i18n,\n  defaultNS,\n  children\n}) {\n  const value = useMemo(() => ({\n    i18n,\n    defaultNS\n  }), [i18n, defaultNS]);\n  return createElement(I18nContext.Provider, {\n    value\n  }, children);\n}",
    "/**\n * @license lucide-react v0.518.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m16 3 4 4-4 4\", key: \"1x1c3m\" }],\n  [\"path\", { d: \"M20 7H4\", key: \"zbl0bi\" }],\n  [\"path\", { d: \"m8 21-4-4 4-4\", key: \"h9nckh\" }],\n  [\"path\", { d: \"M4 17h16\", key: \"g4d7ey\" }]\n];\nconst ArrowRightLeft = createLucideIcon(\"arrow-right-left\", __iconNode);\n\nexport { __iconNode, ArrowRightLeft as default };\n//# sourceMappingURL=arrow-right-left.js.map\n",
    "/**\n * @license lucide-react v0.518.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"8\", y2: \"12\", key: \"1pkeuh\" }],\n  [\"line\", { x1: \"12\", x2: \"12.01\", y1: \"16\", y2: \"16\", key: \"4dfq90\" }]\n];\nconst CircleAlert = createLucideIcon(\"circle-alert\", __iconNode);\n\nexport { __iconNode, CircleAlert as default };\n//# sourceMappingURL=circle-alert.js.map\n",
    "/**\n * @license lucide-react v0.518.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"m9 12 2 2 4-4\", key: \"dzmm74\" }]\n];\nconst CircleCheck = createLucideIcon(\"circle-check\", __iconNode);\n\nexport { __iconNode, CircleCheck as default };\n//# sourceMappingURL=circle-check.js.map\n",
    "/**\n * @license lucide-react v0.518.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }]];\nconst Circle = createLucideIcon(\"circle\", __iconNode);\n\nexport { __iconNode, Circle as default };\n//# sourceMappingURL=circle.js.map\n",
    "/**\n * @license lucide-react v0.518.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"18\", cy: \"18\", r: \"3\", key: \"1xkwt0\" }],\n  [\"circle\", { cx: \"6\", cy: \"6\", r: \"3\", key: \"1lh9wr\" }],\n  [\"path\", { d: \"M13 6h3a2 2 0 0 1 2 2v7\", key: \"1yeb86\" }],\n  [\"line\", { x1: \"6\", x2: \"6\", y1: \"9\", y2: \"21\", key: \"rroup\" }]\n];\nconst GitPullRequest = createLucideIcon(\"git-pull-request\", __iconNode);\n\nexport { __iconNode, GitPullRequest as default };\n//# sourceMappingURL=git-pull-request.js.map\n",
    "/**\n * @license lucide-react v0.518.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z\",\n      key: \"zw3jo\"\n    }\n  ],\n  [\n    \"path\",\n    {\n      d: \"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12\",\n      key: \"1wduqc\"\n    }\n  ],\n  [\n    \"path\",\n    {\n      d: \"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17\",\n      key: \"kqbvx6\"\n    }\n  ]\n];\nconst Layers = createLucideIcon(\"layers\", __iconNode);\n\nexport { __iconNode, Layers as default };\n//# sourceMappingURL=layers.js.map\n",
    "/**\n * @license lucide-react v0.518.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 2v4\", key: \"3427ic\" }],\n  [\"path\", { d: \"m16.2 7.8 2.9-2.9\", key: \"r700ao\" }],\n  [\"path\", { d: \"M18 12h4\", key: \"wj9ykh\" }],\n  [\"path\", { d: \"m16.2 16.2 2.9 2.9\", key: \"1bxg5t\" }],\n  [\"path\", { d: \"M12 18v4\", key: \"jadmvz\" }],\n  [\"path\", { d: \"m4.9 19.1 2.9-2.9\", key: \"bwix9q\" }],\n  [\"path\", { d: \"M2 12h4\", key: \"j09sii\" }],\n  [\"path\", { d: \"m4.9 4.9 2.9 2.9\", key: \"giyufr\" }]\n];\nconst Loader = createLucideIcon(\"loader\", __iconNode);\n\nexport { __iconNode, Loader as default };\n//# sourceMappingURL=loader.js.map\n",
    "/**\n * @license lucide-react v0.518.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 19h8\", key: \"baeox8\" }],\n  [\"path\", { d: \"m4 17 6-6-6-6\", key: \"1yngyt\" }]\n];\nconst Terminal = createLucideIcon(\"terminal\", __iconNode);\n\nexport { __iconNode, Terminal as default };\n//# sourceMappingURL=terminal.js.map\n",
    "function hasInitialValue(atom) {\n  return \"init\" in atom;\n}\nfunction isActuallyWritableAtom(atom) {\n  return !!atom.write;\n}\nfunction isAtomStateInitialized(atomState) {\n  return \"v\" in atomState || \"e\" in atomState;\n}\nfunction returnAtomValue(atomState) {\n  if (\"e\" in atomState) {\n    throw atomState.e;\n  }\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && !(\"v\" in atomState)) {\n    throw new Error(\"[Bug] atom state is not initialized\");\n  }\n  return atomState.v;\n}\nconst promiseStateMap = /* @__PURE__ */ new WeakMap();\nfunction isPendingPromise(value) {\n  var _a;\n  return isPromiseLike(value) && !!((_a = promiseStateMap.get(value)) == null ? void 0 : _a[0]);\n}\nfunction abortPromise(promise) {\n  const promiseState = promiseStateMap.get(promise);\n  if (promiseState == null ? void 0 : promiseState[0]) {\n    promiseState[0] = false;\n    promiseState[1].forEach((fn) => fn());\n  }\n}\nfunction registerAbortHandler(promise, abortHandler) {\n  let promiseState = promiseStateMap.get(promise);\n  if (!promiseState) {\n    promiseState = [true, /* @__PURE__ */ new Set()];\n    promiseStateMap.set(promise, promiseState);\n    const settle = () => {\n      promiseState[0] = false;\n    };\n    promise.then(settle, settle);\n  }\n  promiseState[1].add(abortHandler);\n}\nfunction isPromiseLike(p) {\n  return typeof (p == null ? void 0 : p.then) === \"function\";\n}\nfunction addPendingPromiseToDependency(atom, promise, dependencyAtomState) {\n  if (!dependencyAtomState.p.has(atom)) {\n    dependencyAtomState.p.add(atom);\n    const cleanup = () => dependencyAtomState.p.delete(atom);\n    promise.then(cleanup, cleanup);\n  }\n}\nfunction getMountedOrPendingDependents(atom, atomState, mountedMap) {\n  var _a;\n  const dependents = /* @__PURE__ */ new Set();\n  for (const a of ((_a = mountedMap.get(atom)) == null ? void 0 : _a.t) || []) {\n    if (mountedMap.has(a)) {\n      dependents.add(a);\n    }\n  }\n  for (const atomWithPendingPromise of atomState.p) {\n    dependents.add(atomWithPendingPromise);\n  }\n  return dependents;\n}\nconst createStoreHook = () => {\n  const callbacks = /* @__PURE__ */ new Set();\n  const notify = () => callbacks.forEach((fn) => fn());\n  notify.add = (fn) => {\n    callbacks.add(fn);\n    return () => callbacks.delete(fn);\n  };\n  return notify;\n};\nconst createStoreHookForAtoms = () => {\n  const all = {};\n  const callbacks = /* @__PURE__ */ new WeakMap();\n  const notify = (atom) => {\n    var _a, _b;\n    (_a = callbacks.get(all)) == null ? void 0 : _a.forEach((fn) => fn(atom));\n    (_b = callbacks.get(atom)) == null ? void 0 : _b.forEach((fn) => fn());\n  };\n  notify.add = (atom, fn) => {\n    const key = atom || all;\n    const fns = (callbacks.has(key) ? callbacks : callbacks.set(key, /* @__PURE__ */ new Set())).get(key);\n    fns.add(fn);\n    return () => {\n      fns == null ? void 0 : fns.delete(fn);\n      if (!fns.size) {\n        callbacks.delete(key);\n      }\n    };\n  };\n  return notify;\n};\nfunction initializeStoreHooks(storeHooks) {\n  storeHooks.i || (storeHooks.i = createStoreHookForAtoms());\n  storeHooks.r || (storeHooks.r = createStoreHookForAtoms());\n  storeHooks.c || (storeHooks.c = createStoreHookForAtoms());\n  storeHooks.m || (storeHooks.m = createStoreHookForAtoms());\n  storeHooks.u || (storeHooks.u = createStoreHookForAtoms());\n  storeHooks.f || (storeHooks.f = createStoreHook());\n  return storeHooks;\n}\nconst atomRead = (_store, atom, ...params) => atom.read(...params);\nconst atomWrite = (_store, atom, ...params) => atom.write(...params);\nconst atomOnInit = (store, atom) => {\n  var _a;\n  return (_a = atom.unstable_onInit) == null ? void 0 : _a.call(atom, store);\n};\nconst atomOnMount = (_store, atom, setAtom) => {\n  var _a;\n  return (_a = atom.onMount) == null ? void 0 : _a.call(atom, setAtom);\n};\nconst ensureAtomState = (store, atom) => {\n  var _a;\n  const buildingBlocks = getInternalBuildingBlocks(store);\n  const atomStateMap = buildingBlocks[0];\n  const storeHooks = buildingBlocks[6];\n  const atomOnInit2 = buildingBlocks[9];\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && !atom) {\n    throw new Error(\"Atom is undefined or null\");\n  }\n  let atomState = atomStateMap.get(atom);\n  if (!atomState) {\n    atomState = { d: /* @__PURE__ */ new Map(), p: /* @__PURE__ */ new Set(), n: 0 };\n    atomStateMap.set(atom, atomState);\n    (_a = storeHooks.i) == null ? void 0 : _a.call(storeHooks, atom);\n    atomOnInit2 == null ? void 0 : atomOnInit2(store, atom);\n  }\n  return atomState;\n};\nconst flushCallbacks = (store) => {\n  const buildingBlocks = getInternalBuildingBlocks(store);\n  const mountedMap = buildingBlocks[1];\n  const changedAtoms = buildingBlocks[3];\n  const mountCallbacks = buildingBlocks[4];\n  const unmountCallbacks = buildingBlocks[5];\n  const storeHooks = buildingBlocks[6];\n  const recomputeInvalidatedAtoms2 = buildingBlocks[13];\n  const errors = [];\n  const call = (fn) => {\n    try {\n      fn();\n    } catch (e) {\n      errors.push(e);\n    }\n  };\n  do {\n    if (storeHooks.f) {\n      call(storeHooks.f);\n    }\n    const callbacks = /* @__PURE__ */ new Set();\n    const add = callbacks.add.bind(callbacks);\n    changedAtoms.forEach((atom) => {\n      var _a;\n      return (_a = mountedMap.get(atom)) == null ? void 0 : _a.l.forEach(add);\n    });\n    changedAtoms.clear();\n    unmountCallbacks.forEach(add);\n    unmountCallbacks.clear();\n    mountCallbacks.forEach(add);\n    mountCallbacks.clear();\n    callbacks.forEach(call);\n    if (changedAtoms.size) {\n      recomputeInvalidatedAtoms2(store);\n    }\n  } while (changedAtoms.size || unmountCallbacks.size || mountCallbacks.size);\n  if (errors.length) {\n    throw new AggregateError(errors);\n  }\n};\nconst recomputeInvalidatedAtoms = (store) => {\n  const buildingBlocks = getInternalBuildingBlocks(store);\n  const mountedMap = buildingBlocks[1];\n  const invalidatedAtoms = buildingBlocks[2];\n  const changedAtoms = buildingBlocks[3];\n  const ensureAtomState2 = buildingBlocks[11];\n  const readAtomState2 = buildingBlocks[14];\n  const mountDependencies2 = buildingBlocks[17];\n  const topSortedReversed = [];\n  const visiting = /* @__PURE__ */ new WeakSet();\n  const visited = /* @__PURE__ */ new WeakSet();\n  const stack = Array.from(changedAtoms);\n  while (stack.length) {\n    const a = stack[stack.length - 1];\n    const aState = ensureAtomState2(store, a);\n    if (visited.has(a)) {\n      stack.pop();\n      continue;\n    }\n    if (visiting.has(a)) {\n      if (invalidatedAtoms.get(a) === aState.n) {\n        topSortedReversed.push([a, aState]);\n      } else if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && invalidatedAtoms.has(a)) {\n        throw new Error(\"[Bug] invalidated atom exists\");\n      }\n      visited.add(a);\n      stack.pop();\n      continue;\n    }\n    visiting.add(a);\n    for (const d of getMountedOrPendingDependents(a, aState, mountedMap)) {\n      if (!visiting.has(d)) {\n        stack.push(d);\n      }\n    }\n  }\n  for (let i = topSortedReversed.length - 1; i >= 0; --i) {\n    const [a, aState] = topSortedReversed[i];\n    let hasChangedDeps = false;\n    for (const dep of aState.d.keys()) {\n      if (dep !== a && changedAtoms.has(dep)) {\n        hasChangedDeps = true;\n        break;\n      }\n    }\n    if (hasChangedDeps) {\n      readAtomState2(store, a);\n      mountDependencies2(store, a);\n    }\n    invalidatedAtoms.delete(a);\n  }\n};\nconst storeMutationSet = /* @__PURE__ */ new WeakSet();\nconst readAtomState = (store, atom) => {\n  var _a, _b;\n  const buildingBlocks = getInternalBuildingBlocks(store);\n  const mountedMap = buildingBlocks[1];\n  const invalidatedAtoms = buildingBlocks[2];\n  const changedAtoms = buildingBlocks[3];\n  const storeHooks = buildingBlocks[6];\n  const atomRead2 = buildingBlocks[7];\n  const ensureAtomState2 = buildingBlocks[11];\n  const flushCallbacks2 = buildingBlocks[12];\n  const recomputeInvalidatedAtoms2 = buildingBlocks[13];\n  const readAtomState2 = buildingBlocks[14];\n  const writeAtomState2 = buildingBlocks[16];\n  const mountDependencies2 = buildingBlocks[17];\n  const atomState = ensureAtomState2(store, atom);\n  if (isAtomStateInitialized(atomState)) {\n    if (mountedMap.has(atom) && invalidatedAtoms.get(atom) !== atomState.n) {\n      return atomState;\n    }\n    if (Array.from(atomState.d).every(\n      ([a, n]) => (\n        // Recursively, read the atom state of the dependency, and\n        // check if the atom epoch number is unchanged\n        readAtomState2(store, a).n === n\n      )\n    )) {\n      return atomState;\n    }\n  }\n  atomState.d.clear();\n  let isSync = true;\n  function mountDependenciesIfAsync() {\n    if (mountedMap.has(atom)) {\n      mountDependencies2(store, atom);\n      recomputeInvalidatedAtoms2(store);\n      flushCallbacks2(store);\n    }\n  }\n  function getter(a) {\n    var _a2;\n    if (a === atom) {\n      const aState2 = ensureAtomState2(store, a);\n      if (!isAtomStateInitialized(aState2)) {\n        if (hasInitialValue(a)) {\n          setAtomStateValueOrPromise(store, a, a.init);\n        } else {\n          throw new Error(\"no atom init\");\n        }\n      }\n      return returnAtomValue(aState2);\n    }\n    const aState = readAtomState2(store, a);\n    try {\n      return returnAtomValue(aState);\n    } finally {\n      atomState.d.set(a, aState.n);\n      if (isPendingPromise(atomState.v)) {\n        addPendingPromiseToDependency(atom, atomState.v, aState);\n      }\n      (_a2 = mountedMap.get(a)) == null ? void 0 : _a2.t.add(atom);\n      if (!isSync) {\n        mountDependenciesIfAsync();\n      }\n    }\n  }\n  let controller;\n  let setSelf;\n  const options = {\n    get signal() {\n      if (!controller) {\n        controller = new AbortController();\n      }\n      return controller.signal;\n    },\n    get setSelf() {\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && !isActuallyWritableAtom(atom)) {\n        console.warn(\"setSelf function cannot be used with read-only atom\");\n      }\n      if (!setSelf && isActuallyWritableAtom(atom)) {\n        setSelf = (...args) => {\n          if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && isSync) {\n            console.warn(\"setSelf function cannot be called in sync\");\n          }\n          if (!isSync) {\n            try {\n              return writeAtomState2(store, atom, ...args);\n            } finally {\n              recomputeInvalidatedAtoms2(store);\n              flushCallbacks2(store);\n            }\n          }\n        };\n      }\n      return setSelf;\n    }\n  };\n  const prevEpochNumber = atomState.n;\n  try {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      storeMutationSet.delete(store);\n    }\n    const valueOrPromise = atomRead2(store, atom, getter, options);\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && storeMutationSet.has(store)) {\n      console.warn(\n        \"Detected store mutation during atom read. This is not supported.\"\n      );\n    }\n    setAtomStateValueOrPromise(store, atom, valueOrPromise);\n    if (isPromiseLike(valueOrPromise)) {\n      registerAbortHandler(valueOrPromise, () => controller == null ? void 0 : controller.abort());\n      valueOrPromise.then(mountDependenciesIfAsync, mountDependenciesIfAsync);\n    }\n    (_a = storeHooks.r) == null ? void 0 : _a.call(storeHooks, atom);\n    return atomState;\n  } catch (error) {\n    delete atomState.v;\n    atomState.e = error;\n    ++atomState.n;\n    return atomState;\n  } finally {\n    isSync = false;\n    if (prevEpochNumber !== atomState.n && invalidatedAtoms.get(atom) === prevEpochNumber) {\n      invalidatedAtoms.set(atom, atomState.n);\n      changedAtoms.add(atom);\n      (_b = storeHooks.c) == null ? void 0 : _b.call(storeHooks, atom);\n    }\n  }\n};\nconst invalidateDependents = (store, atom) => {\n  const buildingBlocks = getInternalBuildingBlocks(store);\n  const mountedMap = buildingBlocks[1];\n  const invalidatedAtoms = buildingBlocks[2];\n  const ensureAtomState2 = buildingBlocks[11];\n  const stack = [atom];\n  while (stack.length) {\n    const a = stack.pop();\n    const aState = ensureAtomState2(store, a);\n    for (const d of getMountedOrPendingDependents(a, aState, mountedMap)) {\n      const dState = ensureAtomState2(store, d);\n      invalidatedAtoms.set(d, dState.n);\n      stack.push(d);\n    }\n  }\n};\nconst writeAtomState = (store, atom, ...args) => {\n  const buildingBlocks = getInternalBuildingBlocks(store);\n  const changedAtoms = buildingBlocks[3];\n  const storeHooks = buildingBlocks[6];\n  const atomWrite2 = buildingBlocks[8];\n  const ensureAtomState2 = buildingBlocks[11];\n  const flushCallbacks2 = buildingBlocks[12];\n  const recomputeInvalidatedAtoms2 = buildingBlocks[13];\n  const readAtomState2 = buildingBlocks[14];\n  const invalidateDependents2 = buildingBlocks[15];\n  const mountDependencies2 = buildingBlocks[17];\n  let isSync = true;\n  const getter = (a) => returnAtomValue(readAtomState2(store, a));\n  const setter = (a, ...args2) => {\n    var _a;\n    const aState = ensureAtomState2(store, a);\n    try {\n      if (a === atom) {\n        if (!hasInitialValue(a)) {\n          throw new Error(\"atom not writable\");\n        }\n        if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n          storeMutationSet.add(store);\n        }\n        const prevEpochNumber = aState.n;\n        const v = args2[0];\n        setAtomStateValueOrPromise(store, a, v);\n        mountDependencies2(store, a);\n        if (prevEpochNumber !== aState.n) {\n          changedAtoms.add(a);\n          (_a = storeHooks.c) == null ? void 0 : _a.call(storeHooks, a);\n          invalidateDependents2(store, a);\n        }\n        return void 0;\n      } else {\n        return writeAtomState(store, a, ...args2);\n      }\n    } finally {\n      if (!isSync) {\n        recomputeInvalidatedAtoms2(store);\n        flushCallbacks2(store);\n      }\n    }\n  };\n  try {\n    return atomWrite2(store, atom, getter, setter, ...args);\n  } finally {\n    isSync = false;\n  }\n};\nconst mountDependencies = (store, atom) => {\n  var _a;\n  const buildingBlocks = getInternalBuildingBlocks(store);\n  const mountedMap = buildingBlocks[1];\n  const changedAtoms = buildingBlocks[3];\n  const storeHooks = buildingBlocks[6];\n  const ensureAtomState2 = buildingBlocks[11];\n  const invalidateDependents2 = buildingBlocks[15];\n  const mountAtom2 = buildingBlocks[18];\n  const unmountAtom2 = buildingBlocks[19];\n  const atomState = ensureAtomState2(store, atom);\n  const mounted = mountedMap.get(atom);\n  if (mounted && !isPendingPromise(atomState.v)) {\n    for (const [a, n] of atomState.d) {\n      if (!mounted.d.has(a)) {\n        const aState = ensureAtomState2(store, a);\n        const aMounted = mountAtom2(store, a);\n        aMounted.t.add(atom);\n        mounted.d.add(a);\n        if (n !== aState.n) {\n          changedAtoms.add(a);\n          (_a = storeHooks.c) == null ? void 0 : _a.call(storeHooks, a);\n          invalidateDependents2(store, a);\n        }\n      }\n    }\n    for (const a of mounted.d || []) {\n      if (!atomState.d.has(a)) {\n        mounted.d.delete(a);\n        const aMounted = unmountAtom2(store, a);\n        aMounted == null ? void 0 : aMounted.t.delete(atom);\n      }\n    }\n  }\n};\nconst mountAtom = (store, atom) => {\n  var _a;\n  const buildingBlocks = getInternalBuildingBlocks(store);\n  const mountedMap = buildingBlocks[1];\n  const mountCallbacks = buildingBlocks[4];\n  const storeHooks = buildingBlocks[6];\n  const atomOnMount2 = buildingBlocks[10];\n  const ensureAtomState2 = buildingBlocks[11];\n  const flushCallbacks2 = buildingBlocks[12];\n  const recomputeInvalidatedAtoms2 = buildingBlocks[13];\n  const readAtomState2 = buildingBlocks[14];\n  const writeAtomState2 = buildingBlocks[16];\n  const atomState = ensureAtomState2(store, atom);\n  let mounted = mountedMap.get(atom);\n  if (!mounted) {\n    readAtomState2(store, atom);\n    for (const a of atomState.d.keys()) {\n      const aMounted = mountAtom(store, a);\n      aMounted.t.add(atom);\n    }\n    mounted = {\n      l: /* @__PURE__ */ new Set(),\n      d: new Set(atomState.d.keys()),\n      t: /* @__PURE__ */ new Set()\n    };\n    mountedMap.set(atom, mounted);\n    (_a = storeHooks.m) == null ? void 0 : _a.call(storeHooks, atom);\n    if (isActuallyWritableAtom(atom)) {\n      const processOnMount = () => {\n        let isSync = true;\n        const setAtom = (...args) => {\n          try {\n            return writeAtomState2(store, atom, ...args);\n          } finally {\n            if (!isSync) {\n              recomputeInvalidatedAtoms2(store);\n              flushCallbacks2(store);\n            }\n          }\n        };\n        try {\n          const onUnmount = atomOnMount2(store, atom, setAtom);\n          if (onUnmount) {\n            mounted.u = () => {\n              isSync = true;\n              try {\n                onUnmount();\n              } finally {\n                isSync = false;\n              }\n            };\n          }\n        } finally {\n          isSync = false;\n        }\n      };\n      mountCallbacks.add(processOnMount);\n    }\n  }\n  return mounted;\n};\nconst unmountAtom = (store, atom) => {\n  var _a;\n  const buildingBlocks = getInternalBuildingBlocks(store);\n  const mountedMap = buildingBlocks[1];\n  const unmountCallbacks = buildingBlocks[5];\n  const storeHooks = buildingBlocks[6];\n  const ensureAtomState2 = buildingBlocks[11];\n  const unmountAtom2 = buildingBlocks[19];\n  const atomState = ensureAtomState2(store, atom);\n  let mounted = mountedMap.get(atom);\n  if (mounted && !mounted.l.size && !Array.from(mounted.t).some((a) => {\n    var _a2;\n    return (_a2 = mountedMap.get(a)) == null ? void 0 : _a2.d.has(atom);\n  })) {\n    if (mounted.u) {\n      unmountCallbacks.add(mounted.u);\n    }\n    mounted = void 0;\n    mountedMap.delete(atom);\n    (_a = storeHooks.u) == null ? void 0 : _a.call(storeHooks, atom);\n    for (const a of atomState.d.keys()) {\n      const aMounted = unmountAtom2(store, a);\n      aMounted == null ? void 0 : aMounted.t.delete(atom);\n    }\n    return void 0;\n  }\n  return mounted;\n};\nconst setAtomStateValueOrPromise = (store, atom, valueOrPromise) => {\n  const ensureAtomState2 = getInternalBuildingBlocks(store)[11];\n  const atomState = ensureAtomState2(store, atom);\n  const hasPrevValue = \"v\" in atomState;\n  const prevValue = atomState.v;\n  if (isPromiseLike(valueOrPromise)) {\n    for (const a of atomState.d.keys()) {\n      addPendingPromiseToDependency(\n        atom,\n        valueOrPromise,\n        ensureAtomState2(store, a)\n      );\n    }\n  }\n  atomState.v = valueOrPromise;\n  delete atomState.e;\n  if (!hasPrevValue || !Object.is(prevValue, atomState.v)) {\n    ++atomState.n;\n    if (isPromiseLike(prevValue)) {\n      abortPromise(prevValue);\n    }\n  }\n};\nconst storeGet = (store, atom) => {\n  const readAtomState2 = getInternalBuildingBlocks(store)[14];\n  return returnAtomValue(readAtomState2(store, atom));\n};\nconst storeSet = (store, atom, ...args) => {\n  const buildingBlocks = getInternalBuildingBlocks(store);\n  const flushCallbacks2 = buildingBlocks[12];\n  const recomputeInvalidatedAtoms2 = buildingBlocks[13];\n  const writeAtomState2 = buildingBlocks[16];\n  try {\n    return writeAtomState2(store, atom, ...args);\n  } finally {\n    recomputeInvalidatedAtoms2(store);\n    flushCallbacks2(store);\n  }\n};\nconst storeSub = (store, atom, listener) => {\n  const buildingBlocks = getInternalBuildingBlocks(store);\n  const flushCallbacks2 = buildingBlocks[12];\n  const mountAtom2 = buildingBlocks[18];\n  const unmountAtom2 = buildingBlocks[19];\n  const mounted = mountAtom2(store, atom);\n  const listeners = mounted.l;\n  listeners.add(listener);\n  flushCallbacks2(store);\n  return () => {\n    listeners.delete(listener);\n    unmountAtom2(store, atom);\n    flushCallbacks2(store);\n  };\n};\nconst buildingBlockMap = /* @__PURE__ */ new WeakMap();\nconst getInternalBuildingBlocks = (store) => {\n  const buildingBlocks = buildingBlockMap.get(store);\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && !buildingBlocks) {\n    throw new Error(\n      \"Store must be created by buildStore to read its building blocks\"\n    );\n  }\n  return buildingBlocks;\n};\nfunction getBuildingBlocks(store) {\n  const buildingBlocks = getInternalBuildingBlocks(store);\n  const enhanceBuildingBlocks = buildingBlocks[24];\n  if (enhanceBuildingBlocks) {\n    return enhanceBuildingBlocks(buildingBlocks);\n  }\n  return buildingBlocks;\n}\nfunction buildStore(...buildArgs) {\n  const store = {\n    get(atom) {\n      const storeGet2 = getInternalBuildingBlocks(store)[21];\n      return storeGet2(store, atom);\n    },\n    set(atom, ...args) {\n      const storeSet2 = getInternalBuildingBlocks(store)[22];\n      return storeSet2(store, atom, ...args);\n    },\n    sub(atom, listener) {\n      const storeSub2 = getInternalBuildingBlocks(store)[23];\n      return storeSub2(store, atom, listener);\n    }\n  };\n  const buildingBlocks = [\n    // store state\n    /* @__PURE__ */ new WeakMap(),\n    // atomStateMap\n    /* @__PURE__ */ new WeakMap(),\n    // mountedMap\n    /* @__PURE__ */ new WeakMap(),\n    // invalidatedAtoms\n    /* @__PURE__ */ new Set(),\n    // changedAtoms\n    /* @__PURE__ */ new Set(),\n    // mountCallbacks\n    /* @__PURE__ */ new Set(),\n    // unmountCallbacks\n    {},\n    // storeHooks\n    // atom interceptors\n    atomRead,\n    atomWrite,\n    atomOnInit,\n    atomOnMount,\n    // building-block functions\n    ensureAtomState,\n    flushCallbacks,\n    recomputeInvalidatedAtoms,\n    readAtomState,\n    invalidateDependents,\n    writeAtomState,\n    mountDependencies,\n    mountAtom,\n    unmountAtom,\n    setAtomStateValueOrPromise,\n    storeGet,\n    storeSet,\n    storeSub,\n    void 0\n  ].map((fn, i) => buildArgs[i] || fn);\n  buildingBlockMap.set(store, Object.freeze(buildingBlocks));\n  return store;\n}\n\nexport { abortPromise as INTERNAL_abortPromise, addPendingPromiseToDependency as INTERNAL_addPendingPromiseToDependency, buildStore as INTERNAL_buildStoreRev2, getBuildingBlocks as INTERNAL_getBuildingBlocksRev2, getMountedOrPendingDependents as INTERNAL_getMountedOrPendingDependents, hasInitialValue as INTERNAL_hasInitialValue, initializeStoreHooks as INTERNAL_initializeStoreHooksRev2, isActuallyWritableAtom as INTERNAL_isActuallyWritableAtom, isAtomStateInitialized as INTERNAL_isAtomStateInitialized, isPendingPromise as INTERNAL_isPendingPromise, isPromiseLike as INTERNAL_isPromiseLike, promiseStateMap as INTERNAL_promiseStateMap, registerAbortHandler as INTERNAL_registerAbortHandler, returnAtomValue as INTERNAL_returnAtomValue };\n",
    "import { INTERNAL_buildStoreRev2 } from 'jotai/vanilla/internals';\n\nlet keyCount = 0;\nfunction atom(read, write) {\n  const key = `atom${++keyCount}`;\n  const config = {\n    toString() {\n      return (import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && this.debugLabel ? key + \":\" + this.debugLabel : key;\n    }\n  };\n  if (typeof read === \"function\") {\n    config.read = read;\n  } else {\n    config.init = read;\n    config.read = defaultRead;\n    config.write = defaultWrite;\n  }\n  if (write) {\n    config.write = write;\n  }\n  return config;\n}\nfunction defaultRead(get) {\n  return get(this);\n}\nfunction defaultWrite(get, set, arg) {\n  return set(\n    this,\n    typeof arg === \"function\" ? arg(get(this)) : arg\n  );\n}\n\nlet overiddenCreateStore;\nfunction INTERNAL_overrideCreateStore(fn) {\n  overiddenCreateStore = fn(overiddenCreateStore);\n}\nfunction createStore() {\n  if (overiddenCreateStore) {\n    return overiddenCreateStore();\n  }\n  return INTERNAL_buildStoreRev2();\n}\nlet defaultStore;\nfunction getDefaultStore() {\n  if (!defaultStore) {\n    defaultStore = createStore();\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      globalThis.__JOTAI_DEFAULT_STORE__ || (globalThis.__JOTAI_DEFAULT_STORE__ = defaultStore);\n      if (globalThis.__JOTAI_DEFAULT_STORE__ !== defaultStore) {\n        console.warn(\n          \"Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044\"\n        );\n      }\n    }\n  }\n  return defaultStore;\n}\n\nexport { INTERNAL_overrideCreateStore, atom, createStore, getDefaultStore };\n",
    "'use client';\nimport React, { createContext, useContext, useRef, createElement, useReducer, useEffect, useDebugValue, useCallback } from 'react';\nimport { getDefaultStore, createStore } from 'jotai/vanilla';\nimport { INTERNAL_registerAbortHandler } from 'jotai/vanilla/internals';\n\nconst StoreContext = createContext(\n  void 0\n);\nfunction useStore(options) {\n  const store = useContext(StoreContext);\n  return (options == null ? void 0 : options.store) || store || getDefaultStore();\n}\nfunction Provider({\n  children,\n  store\n}) {\n  const storeRef = useRef(null);\n  if (store) {\n    return createElement(StoreContext.Provider, { value: store }, children);\n  }\n  if (storeRef.current === null) {\n    storeRef.current = createStore();\n  }\n  return createElement(\n    StoreContext.Provider,\n    {\n      // TODO should we use useState instead?\n      // eslint-disable-next-line react-hooks/refs\n      value: storeRef.current\n    },\n    children\n  );\n}\n\nconst isPromiseLike = (x) => typeof (x == null ? void 0 : x.then) === \"function\";\nconst attachPromiseStatus = (promise) => {\n  if (!promise.status) {\n    promise.status = \"pending\";\n    promise.then(\n      (v) => {\n        promise.status = \"fulfilled\";\n        promise.value = v;\n      },\n      (e) => {\n        promise.status = \"rejected\";\n        promise.reason = e;\n      }\n    );\n  }\n};\nconst use = React.use || // A shim for older React versions\n((promise) => {\n  if (promise.status === \"pending\") {\n    throw promise;\n  } else if (promise.status === \"fulfilled\") {\n    return promise.value;\n  } else if (promise.status === \"rejected\") {\n    throw promise.reason;\n  } else {\n    attachPromiseStatus(promise);\n    throw promise;\n  }\n});\nconst continuablePromiseMap = /* @__PURE__ */ new WeakMap();\nconst createContinuablePromise = (promise, getValue) => {\n  let continuablePromise = continuablePromiseMap.get(promise);\n  if (!continuablePromise) {\n    continuablePromise = new Promise((resolve, reject) => {\n      let curr = promise;\n      const onFulfilled = (me) => (v) => {\n        if (curr === me) {\n          resolve(v);\n        }\n      };\n      const onRejected = (me) => (e) => {\n        if (curr === me) {\n          reject(e);\n        }\n      };\n      const onAbort = () => {\n        try {\n          const nextValue = getValue();\n          if (isPromiseLike(nextValue)) {\n            continuablePromiseMap.set(nextValue, continuablePromise);\n            curr = nextValue;\n            nextValue.then(onFulfilled(nextValue), onRejected(nextValue));\n            INTERNAL_registerAbortHandler(nextValue, onAbort);\n          } else {\n            resolve(nextValue);\n          }\n        } catch (e) {\n          reject(e);\n        }\n      };\n      promise.then(onFulfilled(promise), onRejected(promise));\n      INTERNAL_registerAbortHandler(promise, onAbort);\n    });\n    continuablePromiseMap.set(promise, continuablePromise);\n  }\n  return continuablePromise;\n};\nfunction useAtomValue(atom, options) {\n  const { delay, unstable_promiseStatus: promiseStatus = !React.use } = options || {};\n  const store = useStore(options);\n  const [[valueFromReducer, storeFromReducer, atomFromReducer], rerender] = useReducer(\n    (prev) => {\n      const nextValue = store.get(atom);\n      if (Object.is(prev[0], nextValue) && prev[1] === store && prev[2] === atom) {\n        return prev;\n      }\n      return [nextValue, store, atom];\n    },\n    void 0,\n    () => [store.get(atom), store, atom]\n  );\n  let value = valueFromReducer;\n  if (storeFromReducer !== store || atomFromReducer !== atom) {\n    rerender();\n    value = store.get(atom);\n  }\n  useEffect(() => {\n    const unsub = store.sub(atom, () => {\n      if (promiseStatus) {\n        try {\n          const value2 = store.get(atom);\n          if (isPromiseLike(value2)) {\n            attachPromiseStatus(\n              createContinuablePromise(value2, () => store.get(atom))\n            );\n          }\n        } catch (e) {\n        }\n      }\n      if (typeof delay === \"number\") {\n        setTimeout(rerender, delay);\n        return;\n      }\n      rerender();\n    });\n    rerender();\n    return unsub;\n  }, [store, atom, delay, promiseStatus]);\n  useDebugValue(value);\n  if (isPromiseLike(value)) {\n    const promise = createContinuablePromise(value, () => store.get(atom));\n    if (promiseStatus) {\n      attachPromiseStatus(promise);\n    }\n    return use(promise);\n  }\n  return value;\n}\n\nfunction useSetAtom(atom, options) {\n  const store = useStore(options);\n  const setAtom = useCallback(\n    (...args) => {\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && !(\"write\" in atom)) {\n        throw new Error(\"not writable atom\");\n      }\n      return store.set(atom, ...args);\n    },\n    [store, atom]\n  );\n  return setAtom;\n}\n\nfunction useAtom(atom, options) {\n  return [\n    useAtomValue(atom, options),\n    // We do wrong type assertion here, which results in throwing an error.\n    useSetAtom(atom, options)\n  ];\n}\n\nexport { Provider, useAtom, useAtomValue, useSetAtom, useStore };\n",
    "import { atom } from 'jotai/vanilla';\n\nconst RESET = Symbol(\n  (import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" ? \"RESET\" : \"\"\n);\n\nfunction atomWithReset(initialValue) {\n  const anAtom = atom(\n    initialValue,\n    (get, set, update) => {\n      const nextValue = typeof update === \"function\" ? update(get(anAtom)) : update;\n      set(anAtom, nextValue === RESET ? initialValue : nextValue);\n    }\n  );\n  return anAtom;\n}\n\nfunction atomWithReducer(initialValue, reducer) {\n  return atom(initialValue, function(get, set, action) {\n    set(this, reducer(get(this), action));\n  });\n}\n\nfunction atomFamily(initializeAtom, areEqual) {\n  let shouldRemove = null;\n  const atoms = /* @__PURE__ */ new Map();\n  const listeners = /* @__PURE__ */ new Set();\n  const createAtom = (param) => {\n    let item;\n    if (areEqual === void 0) {\n      item = atoms.get(param);\n    } else {\n      for (const [key, value] of atoms) {\n        if (areEqual(key, param)) {\n          item = value;\n          break;\n        }\n      }\n    }\n    if (item !== void 0) {\n      if (shouldRemove == null ? void 0 : shouldRemove(item[1], param)) {\n        createAtom.remove(param);\n      } else {\n        return item[0];\n      }\n    }\n    const newAtom = initializeAtom(param);\n    atoms.set(param, [newAtom, Date.now()]);\n    notifyListeners(\"CREATE\", param, newAtom);\n    return newAtom;\n  };\n  const notifyListeners = (type, param, atom) => {\n    for (const listener of listeners) {\n      listener({ type, param, atom });\n    }\n  };\n  createAtom.unstable_listen = (callback) => {\n    listeners.add(callback);\n    return () => {\n      listeners.delete(callback);\n    };\n  };\n  createAtom.getParams = () => atoms.keys();\n  createAtom.remove = (param) => {\n    if (areEqual === void 0) {\n      if (!atoms.has(param)) return;\n      const [atom] = atoms.get(param);\n      atoms.delete(param);\n      notifyListeners(\"REMOVE\", param, atom);\n    } else {\n      for (const [key, [atom]] of atoms) {\n        if (areEqual(key, param)) {\n          atoms.delete(key);\n          notifyListeners(\"REMOVE\", key, atom);\n          break;\n        }\n      }\n    }\n  };\n  createAtom.setShouldRemove = (fn) => {\n    shouldRemove = fn;\n    if (!shouldRemove) return;\n    for (const [key, [atom, createdAt]] of atoms) {\n      if (shouldRemove(createdAt, key)) {\n        atoms.delete(key);\n        notifyListeners(\"REMOVE\", key, atom);\n      }\n    }\n  };\n  return createAtom;\n}\n\nconst getCached$2 = (c, m, k) => (m.has(k) ? m : m.set(k, c())).get(k);\nconst cache1$3 = /* @__PURE__ */ new WeakMap();\nconst memo3 = (create, dep1, dep2, dep3) => {\n  const cache2 = getCached$2(() => /* @__PURE__ */ new WeakMap(), cache1$3, dep1);\n  const cache3 = getCached$2(() => /* @__PURE__ */ new WeakMap(), cache2, dep2);\n  return getCached$2(create, cache3, dep3);\n};\nfunction selectAtom(anAtom, selector, equalityFn = Object.is) {\n  return memo3(\n    () => {\n      const EMPTY = Symbol();\n      const selectValue = ([value, prevSlice]) => {\n        if (prevSlice === EMPTY) {\n          return selector(value);\n        }\n        const slice = selector(value, prevSlice);\n        return equalityFn(prevSlice, slice) ? prevSlice : slice;\n      };\n      const derivedAtom = atom((get) => {\n        const prev = get(derivedAtom);\n        const value = get(anAtom);\n        return selectValue([value, prev]);\n      });\n      derivedAtom.init = EMPTY;\n      return derivedAtom;\n    },\n    anAtom,\n    selector,\n    equalityFn\n  );\n}\n\nconst frozenAtoms = /* @__PURE__ */ new WeakSet();\nconst deepFreeze = (value) => {\n  if (typeof value !== \"object\" || value === null) {\n    return value;\n  }\n  Object.freeze(value);\n  const propNames = Object.getOwnPropertyNames(value);\n  for (const name of propNames) {\n    deepFreeze(value[name]);\n  }\n  return value;\n};\nfunction freezeAtom(anAtom) {\n  if (frozenAtoms.has(anAtom)) {\n    return anAtom;\n  }\n  frozenAtoms.add(anAtom);\n  const origRead = anAtom.read;\n  anAtom.read = function(get, options) {\n    return deepFreeze(origRead.call(this, get, options));\n  };\n  if (\"write\" in anAtom) {\n    const origWrite = anAtom.write;\n    anAtom.write = function(get, set, ...args) {\n      return origWrite.call(\n        this,\n        get,\n        (...setArgs) => {\n          if (setArgs[0] === anAtom) {\n            setArgs[1] = deepFreeze(setArgs[1]);\n          }\n          return set(...setArgs);\n        },\n        ...args\n      );\n    };\n  }\n  return anAtom;\n}\nfunction freezeAtomCreator(createAtom) {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] freezeAtomCreator is deprecated, define it on users end\"\n    );\n  }\n  return ((...args) => freezeAtom(createAtom(...args)));\n}\n\nconst getCached$1 = (c, m, k) => (m.has(k) ? m : m.set(k, c())).get(k);\nconst cache1$2 = /* @__PURE__ */ new WeakMap();\nconst memo2$1 = (create, dep1, dep2) => {\n  const cache2 = getCached$1(() => /* @__PURE__ */ new WeakMap(), cache1$2, dep1);\n  return getCached$1(create, cache2, dep2);\n};\nconst cacheKeyForEmptyKeyExtractor = {};\nconst isWritable = (atom2) => !!atom2.write;\nconst isFunction = (x) => typeof x === \"function\";\nfunction splitAtom(arrAtom, keyExtractor) {\n  return memo2$1(\n    () => {\n      const mappingCache = /* @__PURE__ */ new WeakMap();\n      const getMapping = (arr, prev) => {\n        let mapping = mappingCache.get(arr);\n        if (mapping) {\n          return mapping;\n        }\n        const prevMapping = prev && mappingCache.get(prev);\n        const atomList = [];\n        const keyList = [];\n        arr.forEach((item, index) => {\n          const key = keyExtractor ? keyExtractor(item) : index;\n          keyList[index] = key;\n          const cachedAtom = prevMapping && prevMapping.atomList[prevMapping.keyList.indexOf(key)];\n          if (cachedAtom) {\n            atomList[index] = cachedAtom;\n            return;\n          }\n          const read = (get) => {\n            const prev2 = get(mappingAtom);\n            const currArr = get(arrAtom);\n            const mapping2 = getMapping(currArr, prev2 == null ? void 0 : prev2.arr);\n            const index2 = mapping2.keyList.indexOf(key);\n            if (index2 < 0 || index2 >= currArr.length) {\n              const prevItem = arr[getMapping(arr).keyList.indexOf(key)];\n              if (prevItem) {\n                return prevItem;\n              }\n              throw new Error(\"splitAtom: index out of bounds for read\");\n            }\n            return currArr[index2];\n          };\n          const write = (get, set, update) => {\n            const prev2 = get(mappingAtom);\n            const arr2 = get(arrAtom);\n            const mapping2 = getMapping(arr2, prev2 == null ? void 0 : prev2.arr);\n            const index2 = mapping2.keyList.indexOf(key);\n            if (index2 < 0 || index2 >= arr2.length) {\n              throw new Error(\"splitAtom: index out of bounds for write\");\n            }\n            const nextItem = isFunction(update) ? update(arr2[index2]) : update;\n            if (!Object.is(arr2[index2], nextItem)) {\n              set(arrAtom, [\n                ...arr2.slice(0, index2),\n                nextItem,\n                ...arr2.slice(index2 + 1)\n              ]);\n            }\n          };\n          atomList[index] = isWritable(arrAtom) ? atom(read, write) : atom(read);\n        });\n        if (prevMapping && prevMapping.keyList.length === keyList.length && prevMapping.keyList.every((x, i) => x === keyList[i])) {\n          mapping = prevMapping;\n        } else {\n          mapping = { arr, atomList, keyList };\n        }\n        mappingCache.set(arr, mapping);\n        return mapping;\n      };\n      const mappingAtom = atom((get) => {\n        const prev = get(mappingAtom);\n        const arr = get(arrAtom);\n        const mapping = getMapping(arr, prev == null ? void 0 : prev.arr);\n        return mapping;\n      });\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n        mappingAtom.debugPrivate = true;\n      }\n      mappingAtom.init = void 0;\n      const splittedAtom = isWritable(arrAtom) ? atom(\n        (get) => get(mappingAtom).atomList,\n        (get, set, action) => {\n          switch (action.type) {\n            case \"remove\": {\n              const index = get(splittedAtom).indexOf(action.atom);\n              if (index >= 0) {\n                const arr = get(arrAtom);\n                set(arrAtom, [\n                  ...arr.slice(0, index),\n                  ...arr.slice(index + 1)\n                ]);\n              }\n              break;\n            }\n            case \"insert\": {\n              const index = action.before ? get(splittedAtom).indexOf(action.before) : get(splittedAtom).length;\n              if (index >= 0) {\n                const arr = get(arrAtom);\n                set(arrAtom, [\n                  ...arr.slice(0, index),\n                  action.value,\n                  ...arr.slice(index)\n                ]);\n              }\n              break;\n            }\n            case \"move\": {\n              const index1 = get(splittedAtom).indexOf(action.atom);\n              const index2 = action.before ? get(splittedAtom).indexOf(action.before) : get(splittedAtom).length;\n              if (index1 >= 0 && index2 >= 0) {\n                const arr = get(arrAtom);\n                if (index1 < index2) {\n                  set(arrAtom, [\n                    ...arr.slice(0, index1),\n                    ...arr.slice(index1 + 1, index2),\n                    arr[index1],\n                    ...arr.slice(index2)\n                  ]);\n                } else {\n                  set(arrAtom, [\n                    ...arr.slice(0, index2),\n                    arr[index1],\n                    ...arr.slice(index2, index1),\n                    ...arr.slice(index1 + 1)\n                  ]);\n                }\n              }\n              break;\n            }\n          }\n        }\n      ) : atom((get) => get(mappingAtom).atomList);\n      return splittedAtom;\n    },\n    arrAtom,\n    keyExtractor || cacheKeyForEmptyKeyExtractor\n  );\n}\n\nfunction atomWithDefault(getDefault) {\n  const EMPTY = Symbol();\n  const overwrittenAtom = atom(EMPTY);\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    overwrittenAtom.debugPrivate = true;\n  }\n  const anAtom = atom(\n    (get, options) => {\n      const overwritten = get(overwrittenAtom);\n      if (overwritten !== EMPTY) {\n        return overwritten;\n      }\n      return getDefault(get, options);\n    },\n    (get, set, update) => {\n      const newValue = typeof update === \"function\" ? update(get(anAtom)) : update;\n      set(overwrittenAtom, newValue === RESET ? EMPTY : newValue);\n    }\n  );\n  return anAtom;\n}\n\nconst isPromiseLike$3 = (x) => typeof (x == null ? void 0 : x.then) === \"function\";\nfunction withStorageValidator(validator) {\n  return (unknownStorage) => {\n    const storage = {\n      ...unknownStorage,\n      getItem: (key, initialValue) => {\n        const validate = (value2) => {\n          if (!validator(value2)) {\n            return initialValue;\n          }\n          return value2;\n        };\n        const value = unknownStorage.getItem(key, initialValue);\n        if (isPromiseLike$3(value)) {\n          return value.then(validate);\n        }\n        return validate(value);\n      }\n    };\n    return storage;\n  };\n}\nfunction createJSONStorage(getStringStorage = () => {\n  try {\n    return window.localStorage;\n  } catch (e) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      if (typeof window !== \"undefined\") {\n        console.warn(e);\n      }\n    }\n    return void 0;\n  }\n}, options) {\n  var _a;\n  let lastStr;\n  let lastValue;\n  const storage = {\n    getItem: (key, initialValue) => {\n      var _a2, _b;\n      const parse = (str2) => {\n        str2 = str2 || \"\";\n        if (lastStr !== str2) {\n          try {\n            lastValue = JSON.parse(str2, options == null ? void 0 : options.reviver);\n          } catch (e) {\n            return initialValue;\n          }\n          lastStr = str2;\n        }\n        return lastValue;\n      };\n      const str = (_b = (_a2 = getStringStorage()) == null ? void 0 : _a2.getItem(key)) != null ? _b : null;\n      if (isPromiseLike$3(str)) {\n        return str.then(parse);\n      }\n      return parse(str);\n    },\n    setItem: (key, newValue) => {\n      var _a2;\n      return (_a2 = getStringStorage()) == null ? void 0 : _a2.setItem(\n        key,\n        JSON.stringify(newValue, options == null ? void 0 : options.replacer)\n      );\n    },\n    removeItem: (key) => {\n      var _a2;\n      return (_a2 = getStringStorage()) == null ? void 0 : _a2.removeItem(key);\n    }\n  };\n  const createHandleSubscribe = (subscriber2) => (key, callback, initialValue) => subscriber2(key, (v) => {\n    let newValue;\n    try {\n      newValue = JSON.parse(v || \"\");\n    } catch (e) {\n      newValue = initialValue;\n    }\n    callback(newValue);\n  });\n  let subscriber;\n  try {\n    subscriber = (_a = getStringStorage()) == null ? void 0 : _a.subscribe;\n  } catch (e) {\n  }\n  if (!subscriber && typeof window !== \"undefined\" && typeof window.addEventListener === \"function\" && window.Storage) {\n    subscriber = (key, callback) => {\n      if (!(getStringStorage() instanceof window.Storage)) {\n        return () => {\n        };\n      }\n      const storageEventCallback = (e) => {\n        if (e.storageArea === getStringStorage() && e.key === key) {\n          callback(e.newValue);\n        }\n      };\n      window.addEventListener(\"storage\", storageEventCallback);\n      return () => {\n        window.removeEventListener(\"storage\", storageEventCallback);\n      };\n    };\n  }\n  if (subscriber) {\n    storage.subscribe = createHandleSubscribe(subscriber);\n  }\n  return storage;\n}\nconst defaultStorage = createJSONStorage();\nfunction atomWithStorage(key, initialValue, storage = defaultStorage, options) {\n  const getOnInit = options == null ? void 0 : options.getOnInit;\n  const baseAtom = atom(\n    getOnInit ? storage.getItem(key, initialValue) : initialValue\n  );\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    baseAtom.debugPrivate = true;\n  }\n  baseAtom.onMount = (setAtom) => {\n    setAtom(storage.getItem(key, initialValue));\n    let unsub;\n    if (storage.subscribe) {\n      unsub = storage.subscribe(key, setAtom, initialValue);\n    }\n    return unsub;\n  };\n  const anAtom = atom(\n    (get) => get(baseAtom),\n    (get, set, update) => {\n      const nextValue = typeof update === \"function\" ? update(get(baseAtom)) : update;\n      if (nextValue === RESET) {\n        set(baseAtom, initialValue);\n        return storage.removeItem(key);\n      }\n      if (isPromiseLike$3(nextValue)) {\n        return nextValue.then((resolvedValue) => {\n          set(baseAtom, resolvedValue);\n          return storage.setItem(key, resolvedValue);\n        });\n      }\n      set(baseAtom, nextValue);\n      return storage.setItem(key, nextValue);\n    }\n  );\n  return anAtom;\n}\n\nconst isPromiseLike$2 = (x) => typeof (x == null ? void 0 : x.then) === \"function\";\nfunction atomWithObservable(getObservable, options) {\n  const returnResultData = (result) => {\n    if (\"e\" in result) {\n      throw result.e;\n    }\n    return result.d;\n  };\n  const observableResultAtom = atom((get) => {\n    var _a;\n    let observable = getObservable(get);\n    const itself = (_a = observable[Symbol.observable]) == null ? void 0 : _a.call(observable);\n    if (itself) {\n      observable = itself;\n    }\n    let resolve;\n    const makePending = () => new Promise((r) => {\n      resolve = r;\n    });\n    const initialResult = options && \"initialValue\" in options ? {\n      d: typeof options.initialValue === \"function\" ? options.initialValue() : options.initialValue\n    } : makePending();\n    let setResult;\n    let lastResult;\n    const listener = (result) => {\n      lastResult = result;\n      resolve == null ? void 0 : resolve(result);\n      setResult == null ? void 0 : setResult(result);\n    };\n    let subscription;\n    let timer;\n    const isNotMounted = () => !setResult;\n    const unsubscribe = () => {\n      if (subscription) {\n        subscription.unsubscribe();\n        subscription = void 0;\n      }\n    };\n    const start = () => {\n      if (subscription) {\n        clearTimeout(timer);\n        subscription.unsubscribe();\n      }\n      subscription = observable.subscribe({\n        next: (d) => listener({ d }),\n        error: (e) => listener({ e }),\n        complete: () => {\n        }\n      });\n      if (isNotMounted() && (options == null ? void 0 : options.unstable_timeout)) {\n        timer = setTimeout(unsubscribe, options.unstable_timeout);\n      }\n    };\n    start();\n    const resultAtom = atom(lastResult || initialResult);\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      resultAtom.debugPrivate = true;\n    }\n    resultAtom.onMount = (update) => {\n      setResult = update;\n      if (lastResult) {\n        update(lastResult);\n      }\n      if (subscription) {\n        clearTimeout(timer);\n      } else {\n        start();\n      }\n      return () => {\n        setResult = void 0;\n        if (options == null ? void 0 : options.unstable_timeout) {\n          timer = setTimeout(unsubscribe, options.unstable_timeout);\n        } else {\n          unsubscribe();\n        }\n      };\n    };\n    return [resultAtom, observable, makePending, start, isNotMounted];\n  });\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    observableResultAtom.debugPrivate = true;\n  }\n  const observableAtom = atom(\n    (get) => {\n      const [resultAtom] = get(observableResultAtom);\n      const result = get(resultAtom);\n      if (isPromiseLike$2(result)) {\n        return result.then(returnResultData);\n      }\n      return returnResultData(result);\n    },\n    (get, set, data) => {\n      const [resultAtom, observable, makePending, start, isNotMounted] = get(observableResultAtom);\n      if (\"next\" in observable) {\n        if (isNotMounted()) {\n          set(resultAtom, makePending());\n          start();\n        }\n        observable.next(data);\n      } else {\n        throw new Error(\"observable is not subject\");\n      }\n    }\n  );\n  return observableAtom;\n}\n\nconst cache1$1 = /* @__PURE__ */ new WeakMap();\nconst memo1 = (create, dep1) => (cache1$1.has(dep1) ? cache1$1 : cache1$1.set(dep1, create())).get(dep1);\nconst isPromiseLike$1 = (p) => typeof (p == null ? void 0 : p.then) === \"function\";\nconst LOADING = { state: \"loading\" };\nfunction loadable(anAtom) {\n  return memo1(() => {\n    const loadableCache = /* @__PURE__ */ new WeakMap();\n    const refreshAtom = atom([() => {\n    }, 0]);\n    refreshAtom.unstable_onInit = (store) => {\n      store.set(refreshAtom, ([, c]) => [\n        () => store.set(refreshAtom, ([f, c2]) => [f, c2 + 1]),\n        c\n      ]);\n    };\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      refreshAtom.debugPrivate = true;\n    }\n    const derivedAtom = atom((get) => {\n      const [triggerRefresh] = get(refreshAtom);\n      let value;\n      try {\n        value = get(anAtom);\n      } catch (error) {\n        return { state: \"hasError\", error };\n      }\n      if (!isPromiseLike$1(value)) {\n        return { state: \"hasData\", data: value };\n      }\n      const promise = value;\n      const cached1 = loadableCache.get(promise);\n      if (cached1) {\n        return cached1;\n      }\n      promise.then(\n        (data) => {\n          loadableCache.set(promise, { state: \"hasData\", data });\n          triggerRefresh();\n        },\n        (error) => {\n          loadableCache.set(promise, { state: \"hasError\", error });\n          triggerRefresh();\n        }\n      );\n      const cached2 = loadableCache.get(promise);\n      if (cached2) {\n        return cached2;\n      }\n      loadableCache.set(promise, LOADING);\n      return LOADING;\n    });\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      derivedAtom.debugPrivate = true;\n    }\n    return atom((get) => get(derivedAtom));\n  }, anAtom);\n}\n\nconst getCached = (c, m, k) => (m.has(k) ? m : m.set(k, c())).get(k);\nconst cache1 = /* @__PURE__ */ new WeakMap();\nconst memo2 = (create, dep1, dep2) => {\n  const cache2 = getCached(() => /* @__PURE__ */ new WeakMap(), cache1, dep1);\n  return getCached(create, cache2, dep2);\n};\nconst isPromiseLike = (p) => typeof (p == null ? void 0 : p.then) === \"function\";\nconst defaultFallback = () => void 0;\nfunction unwrap(anAtom, fallback = defaultFallback) {\n  return memo2(\n    () => {\n      const promiseErrorCache = /* @__PURE__ */ new WeakMap();\n      const promiseResultCache = /* @__PURE__ */ new WeakMap();\n      const refreshAtom = atom([() => {\n      }, 0]);\n      refreshAtom.unstable_onInit = (store) => {\n        store.set(refreshAtom, ([, c]) => [\n          () => store.set(refreshAtom, ([f, c2]) => [f, c2 + 1]),\n          c\n        ]);\n      };\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n        refreshAtom.debugPrivate = true;\n      }\n      const promiseAndValueAtom = atom((get) => {\n        const [triggerRefresh] = get(refreshAtom);\n        let prev;\n        try {\n          prev = get(promiseAndValueAtom);\n        } catch (e) {\n        }\n        const promise = get(anAtom);\n        if (!isPromiseLike(promise)) {\n          return { v: promise };\n        }\n        if (promise !== (prev == null ? void 0 : prev.p)) {\n          promise.then(\n            (v) => {\n              promiseResultCache.set(promise, v);\n              triggerRefresh();\n            },\n            (e) => {\n              promiseErrorCache.set(promise, e);\n              triggerRefresh();\n            }\n          );\n        }\n        if (promiseErrorCache.has(promise)) {\n          throw promiseErrorCache.get(promise);\n        }\n        if (promiseResultCache.has(promise)) {\n          return {\n            p: promise,\n            v: promiseResultCache.get(promise)\n          };\n        }\n        if (prev && \"v\" in prev) {\n          return { p: promise, f: fallback(prev.v), v: prev.v };\n        }\n        return { p: promise, f: fallback() };\n      });\n      promiseAndValueAtom.init = void 0;\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n        promiseAndValueAtom.debugPrivate = true;\n      }\n      return atom(\n        (get) => {\n          const state = get(promiseAndValueAtom);\n          if (\"f\" in state) {\n            return state.f;\n          }\n          return state.v;\n        },\n        (_get, set, ...args) => set(anAtom, ...args)\n      );\n    },\n    anAtom,\n    fallback\n  );\n}\n\nfunction atomWithRefresh(read, write) {\n  const refreshAtom = atom(0);\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    refreshAtom.debugPrivate = true;\n  }\n  return atom(\n    (get, options) => {\n      get(refreshAtom);\n      return read(get, options);\n    },\n    (get, set, ...args) => {\n      if (args.length === 0) {\n        set(refreshAtom, (c) => c + 1);\n      } else if (write) {\n        return write(get, set, ...args);\n      } else if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n        throw new Error(\"refresh must be called without arguments\");\n      }\n    }\n  );\n}\n\nfunction atomWithLazy(makeInitial) {\n  const a = atom(void 0);\n  delete a.init;\n  Object.defineProperty(a, \"init\", {\n    get() {\n      return makeInitial();\n    }\n  });\n  return a;\n}\n\nexport { RESET, atomFamily, atomWithDefault, atomWithLazy, atomWithObservable, atomWithReducer, atomWithRefresh, atomWithReset, atomWithStorage, createJSONStorage, freezeAtom, freezeAtomCreator, loadable, selectAtom, splitAtom, withStorageValidator as unstable_withStorageValidator, unwrap };\n",
    "/**\n * Session State Machine\n *\n * Manages the lifecycle state of an agent session from creation to completion.\n * See SESSION_STATE_MACHINE.md for the full design specification.\n */\n\n// ============ States ============\nexport const SessionState = {\n\tidle: \"idle\",\n\tcreating: \"creating\",\n\tstreaming: \"streaming\",\n\twaiting_approval: \"waiting_approval\",\n\twaiting_input: \"waiting_input\",\n\tcompleted: \"completed\",\n\tpaused: \"paused\",\n\terror: \"error\",\n\tstopped: \"stopped\",\n} as const\n\nexport type SessionState = (typeof SessionState)[keyof typeof SessionState]\n\n// ============ Events ============\n\ntype StartSessionEvent = { type: \"start_session\" }\ntype SessionCreatedEvent = { type: \"session_created\"; sessionId: string }\ntype ApiReqStartedEvent = { type: \"api_req_started\" }\ntype SayTextEvent = { type: \"say_text\"; partial: boolean }\ntype AskToolEvent = { type: \"ask_tool\"; partial: boolean }\ntype AskCommandEvent = { type: \"ask_command\"; partial: boolean }\ntype AskBrowserActionLaunchEvent = { type: \"ask_browser_action_launch\"; partial: boolean }\ntype AskUseMcpServerEvent = { type: \"ask_use_mcp_server\"; partial: boolean }\ntype AskFollowupEvent = { type: \"ask_followup\"; partial: boolean }\ntype AskCompletionResultEvent = { type: \"ask_completion_result\" }\ntype AskApiReqFailedEvent = { type: \"ask_api_req_failed\" }\ntype AskMistakeLimitReachedEvent = { type: \"ask_mistake_limit_reached\" }\ntype AskInvalidModelEvent = { type: \"ask_invalid_model\" }\ntype AskPaymentRequiredPromptEvent = { type: \"ask_payment_required_prompt\" }\ntype AskResumeTaskEvent = { type: \"ask_resume_task\" }\ntype ProcessErrorEvent = { type: \"process_error\"; error: string }\ntype ApproveActionEvent = { type: \"approve_action\" }\ntype RejectActionEvent = { type: \"reject_action\" }\ntype SendMessageEvent = { type: \"send_message\"; content: string }\ntype CancelSessionEvent = { type: \"cancel_session\" }\ntype RetryEvent = { type: \"retry\" }\n\nexport type SessionEvent =\n\t| StartSessionEvent\n\t| SessionCreatedEvent\n\t| ApiReqStartedEvent\n\t| SayTextEvent\n\t| AskToolEvent\n\t| AskCommandEvent\n\t| AskBrowserActionLaunchEvent\n\t| AskUseMcpServerEvent\n\t| AskFollowupEvent\n\t| AskCompletionResultEvent\n\t| AskApiReqFailedEvent\n\t| AskMistakeLimitReachedEvent\n\t| AskInvalidModelEvent\n\t| AskPaymentRequiredPromptEvent\n\t| AskResumeTaskEvent\n\t| ProcessErrorEvent\n\t| ApproveActionEvent\n\t| RejectActionEvent\n\t| SendMessageEvent\n\t| CancelSessionEvent\n\t| RetryEvent\n\n// ============ Context ============\n\nexport interface SessionContext {\n\tsessionId?: string\n\terrorMessage?: string\n\tsawApiReqStarted: boolean\n\tsawSessionCreated: boolean\n}\n\n// ============ UI State ============\n\nexport interface SessionUiState {\n\tshowSpinner: boolean\n\tshowCancelButton: boolean\n\tisActive: boolean\n}\n\n// ============ State Machine Interface ============\n\nexport interface SessionStateMachine {\n\tgetState(): SessionState\n\tsend(event: SessionEvent): void\n\tgetUiState(): SessionUiState\n\tgetContext(): SessionContext\n\treset(): void\n}\n\n// ============ Implementation ============\n\nfunction createInitialContext(): SessionContext {\n\treturn {\n\t\tsessionId: undefined,\n\t\terrorMessage: undefined,\n\t\tsawApiReqStarted: false,\n\t\tsawSessionCreated: false,\n\t}\n}\n\nexport function createSessionStateMachine(): SessionStateMachine {\n\tlet state: SessionState = SessionState.idle\n\tlet context: SessionContext = createInitialContext()\n\n\tconst send = (event: SessionEvent): void => {\n\t\tconst { nextState, contextUpdate } = transition(state, event, context)\n\t\tstate = nextState\n\t\tif (contextUpdate) {\n\t\t\tcontext = { ...context, ...contextUpdate }\n\t\t}\n\t}\n\n\tconst getState = (): SessionState => state\n\n\tconst getUiState = (): SessionUiState => {\n\t\treturn {\n\t\t\tshowSpinner: state === SessionState.creating || state === SessionState.streaming,\n\t\t\tshowCancelButton:\n\t\t\t\tstate === SessionState.creating ||\n\t\t\t\tstate === SessionState.streaming ||\n\t\t\t\tstate === SessionState.waiting_approval ||\n\t\t\t\tstate === SessionState.waiting_input,\n\t\t\tisActive:\n\t\t\t\tstate === SessionState.creating ||\n\t\t\t\tstate === SessionState.streaming ||\n\t\t\t\tstate === SessionState.waiting_approval ||\n\t\t\t\tstate === SessionState.waiting_input,\n\t\t}\n\t}\n\n\tconst getContext = (): SessionContext => ({ ...context })\n\n\tconst reset = (): void => {\n\t\tstate = SessionState.idle\n\t\tcontext = createInitialContext()\n\t}\n\n\treturn {\n\t\tgetState,\n\t\tsend,\n\t\tgetUiState,\n\t\tgetContext,\n\t\treset,\n\t}\n}\n\n// ============ Transition Logic ============\n\ninterface TransitionResult {\n\tnextState: SessionState\n\tcontextUpdate?: Partial<SessionContext>\n}\n\nfunction transition(currentState: SessionState, event: SessionEvent, context: SessionContext): TransitionResult {\n\tswitch (currentState) {\n\t\tcase SessionState.idle:\n\t\t\treturn transitionFromIdle(event)\n\n\t\tcase SessionState.creating:\n\t\t\treturn transitionFromCreating(event, context)\n\n\t\tcase SessionState.streaming:\n\t\t\treturn transitionFromStreaming(event)\n\n\t\tcase SessionState.waiting_approval:\n\t\t\treturn transitionFromWaitingApproval(event)\n\n\t\tcase SessionState.waiting_input:\n\t\t\treturn transitionFromWaitingInput(event)\n\n\t\tcase SessionState.completed:\n\t\t\treturn transitionFromCompleted(event)\n\n\t\tcase SessionState.paused:\n\t\t\treturn transitionFromPaused(event)\n\n\t\tcase SessionState.error:\n\t\t\treturn transitionFromError(event)\n\n\t\tcase SessionState.stopped:\n\t\t\treturn transitionFromStopped(event)\n\n\t\tdefault:\n\t\t\treturn { nextState: currentState }\n\t}\n}\n\nfunction transitionFromIdle(event: SessionEvent): TransitionResult {\n\tswitch (event.type) {\n\t\tcase \"start_session\":\n\t\t\treturn { nextState: SessionState.creating }\n\n\t\t// Allow direct transition to streaming if we receive events that indicate\n\t\t// the session is already running (e.g., multi-version mode, or missed start_session)\n\t\tcase \"session_created\":\n\t\t\treturn {\n\t\t\t\tnextState: SessionState.streaming,\n\t\t\t\tcontextUpdate: {\n\t\t\t\t\tsawSessionCreated: true,\n\t\t\t\t\tsessionId: (event as SessionCreatedEvent).sessionId,\n\t\t\t\t},\n\t\t\t}\n\n\t\tcase \"api_req_started\":\n\t\t\treturn {\n\t\t\t\tnextState: SessionState.streaming,\n\t\t\t\tcontextUpdate: { sawApiReqStarted: true },\n\t\t\t}\n\n\t\tdefault:\n\t\t\treturn { nextState: SessionState.idle }\n\t}\n}\n\nfunction transitionFromCreating(event: SessionEvent, context: SessionContext): TransitionResult {\n\tswitch (event.type) {\n\t\tcase \"session_created\": {\n\t\t\tconst newContext: Partial<SessionContext> = {\n\t\t\t\tsawSessionCreated: true,\n\t\t\t\tsessionId: event.sessionId,\n\t\t\t}\n\t\t\t// Transition to streaming only if we've seen both events\n\t\t\tif (context.sawApiReqStarted) {\n\t\t\t\treturn { nextState: SessionState.streaming, contextUpdate: newContext }\n\t\t\t}\n\t\t\treturn { nextState: SessionState.creating, contextUpdate: newContext }\n\t\t}\n\n\t\tcase \"api_req_started\": {\n\t\t\tconst newContext: Partial<SessionContext> = { sawApiReqStarted: true }\n\t\t\t// Transition to streaming only if we've seen both events\n\t\t\tif (context.sawSessionCreated) {\n\t\t\t\treturn { nextState: SessionState.streaming, contextUpdate: newContext }\n\t\t\t}\n\t\t\treturn { nextState: SessionState.creating, contextUpdate: newContext }\n\t\t}\n\n\t\tcase \"process_error\":\n\t\t\treturn {\n\t\t\t\tnextState: SessionState.error,\n\t\t\t\tcontextUpdate: { errorMessage: event.error },\n\t\t\t}\n\n\t\tcase \"cancel_session\":\n\t\t\treturn { nextState: SessionState.stopped }\n\n\t\tdefault:\n\t\t\treturn { nextState: SessionState.creating }\n\t}\n}\n\nfunction transitionFromStreaming(event: SessionEvent): TransitionResult {\n\tswitch (event.type) {\n\t\t// Stay streaming on any say message\n\t\tcase \"say_text\":\n\t\t\treturn { nextState: SessionState.streaming }\n\n\t\t// Stay streaming on api_req_started (new request)\n\t\tcase \"api_req_started\":\n\t\t\treturn { nextState: SessionState.streaming }\n\n\t\t// Approval-required asks (only on complete)\n\t\tcase \"ask_tool\":\n\t\tcase \"ask_command\":\n\t\tcase \"ask_browser_action_launch\":\n\t\tcase \"ask_use_mcp_server\":\n\t\t\tif (event.partial) {\n\t\t\t\treturn { nextState: SessionState.streaming }\n\t\t\t}\n\t\t\treturn { nextState: SessionState.waiting_approval }\n\n\t\t// Input-required asks (only on complete)\n\t\tcase \"ask_followup\":\n\t\t\t// In practice, followup questions may only arrive as partial chunks and never emit a final\n\t\t\t// non-partial event. Treat any followup as \"waiting for user input\".\n\t\t\treturn { nextState: SessionState.waiting_input }\n\n\t\t// Completion\n\t\tcase \"ask_completion_result\":\n\t\t\treturn { nextState: SessionState.completed }\n\n\t\t// Errors\n\t\tcase \"ask_api_req_failed\":\n\t\tcase \"ask_mistake_limit_reached\":\n\t\tcase \"ask_invalid_model\":\n\t\tcase \"ask_payment_required_prompt\":\n\t\t\treturn { nextState: SessionState.error }\n\n\t\t// Paused\n\t\tcase \"ask_resume_task\":\n\t\t\treturn { nextState: SessionState.paused }\n\n\t\t// Cancel\n\t\tcase \"cancel_session\":\n\t\t\treturn { nextState: SessionState.stopped }\n\n\t\tdefault:\n\t\t\treturn { nextState: SessionState.streaming }\n\t}\n}\n\nfunction transitionFromWaitingApproval(event: SessionEvent): TransitionResult {\n\tswitch (event.type) {\n\t\tcase \"approve_action\":\n\t\tcase \"reject_action\":\n\t\tcase \"api_req_started\": // Auto-approved\n\t\t\treturn { nextState: SessionState.streaming }\n\n\t\tcase \"cancel_session\":\n\t\t\treturn { nextState: SessionState.stopped }\n\n\t\tdefault:\n\t\t\treturn { nextState: SessionState.waiting_approval }\n\t}\n}\n\nfunction transitionFromWaitingInput(event: SessionEvent): TransitionResult {\n\tswitch (event.type) {\n\t\tcase \"api_req_started\":\n\t\t\treturn { nextState: SessionState.streaming }\n\n\t\tcase \"send_message\":\n\t\t\treturn { nextState: SessionState.streaming }\n\n\t\tcase \"cancel_session\":\n\t\t\treturn { nextState: SessionState.stopped }\n\n\t\tdefault:\n\t\t\treturn { nextState: SessionState.waiting_input }\n\t}\n}\n\nfunction transitionFromCompleted(event: SessionEvent): TransitionResult {\n\tswitch (event.type) {\n\t\tcase \"api_req_started\":\n\t\t\treturn { nextState: SessionState.streaming }\n\n\t\tcase \"send_message\": // Continue with follow-up\n\t\t\treturn { nextState: SessionState.streaming }\n\n\t\tcase \"start_session\": // New task\n\t\t\treturn { nextState: SessionState.creating }\n\n\t\tdefault:\n\t\t\treturn { nextState: SessionState.completed }\n\t}\n}\n\nfunction transitionFromPaused(event: SessionEvent): TransitionResult {\n\tswitch (event.type) {\n\t\tcase \"api_req_started\":\n\t\t\treturn { nextState: SessionState.streaming }\n\n\t\tcase \"cancel_session\":\n\t\t\treturn { nextState: SessionState.stopped }\n\n\t\tdefault:\n\t\t\treturn { nextState: SessionState.paused }\n\t}\n}\n\nfunction transitionFromError(event: SessionEvent): TransitionResult {\n\tswitch (event.type) {\n\t\tcase \"api_req_started\":\n\t\t\treturn { nextState: SessionState.streaming }\n\n\t\tcase \"retry\":\n\t\t\treturn { nextState: SessionState.streaming }\n\n\t\tcase \"cancel_session\":\n\t\t\treturn { nextState: SessionState.stopped }\n\n\t\tdefault:\n\t\t\treturn { nextState: SessionState.error }\n\t}\n}\n\nfunction transitionFromStopped(event: SessionEvent): TransitionResult {\n\tswitch (event.type) {\n\t\tcase \"api_req_started\":\n\t\t\treturn { nextState: SessionState.streaming }\n\n\t\tcase \"start_session\": // New task\n\t\t\treturn { nextState: SessionState.creating }\n\n\t\tdefault:\n\t\t\treturn { nextState: SessionState.stopped }\n\t}\n}\n",
    "import { atom } from \"jotai\"\nimport { atomFamily } from \"jotai/utils\"\n\nexport type AgentStatus = \"creating\" | \"running\" | \"done\" | \"error\" | \"stopped\"\nexport type SessionSource = \"local\" | \"remote\"\n\nexport interface ParallelModeInfo {\n\tenabled: boolean\n\tbranch?: string\n\tworktreePath?: string\n\tparentBranch?: string\n\tcompletionMessage?: string\n}\n\nexport interface AgentSession {\n\tsessionId: string\n\tlabel: string\n\tprompt: string\n\tstatus: AgentStatus\n\tstartTime: number\n\tendTime?: number\n\texitCode?: number\n\terror?: string\n\tpid?: number\n\tsource: SessionSource\n\tparallelMode?: ParallelModeInfo\n\tgitUrl?: string\n\tautoMode?: boolean // True if session was started with --auto flag (non-interactive)\n\tmodel?: string // Model ID used for this session\n}\n\n/**\n * Represents a session that is being created (waiting for CLI's session_created event)\n */\nexport interface PendingSession {\n\tprompt: string\n\tlabel: string\n\tstartTime: number\n\tparallelMode?: boolean\n\tgitUrl?: string\n\tautoMode?: boolean // True if session will be started with --auto flag\n}\n\nexport interface RemoteSession {\n\tsession_id: string\n\ttitle: string\n\tcreated_at: string\n\tupdated_at: string\n\tgit_url?: string\n}\n\n// Core atoms\nexport const sessionsMapAtom = atom<Record<string, AgentSession>>({})\nexport const sessionOrderAtom = atom<string[]>([])\nexport const selectedSessionIdAtom = atom<string | null>(null)\nexport const remoteSessionsAtom = atom<RemoteSession[]>([])\nexport const isRefreshingRemoteSessionsAtom = atom(false)\nexport const pendingSessionAtom = atom<PendingSession | null>(null)\n\nexport const startSessionFailedCounterAtom = atom(0)\n\n// Per-session input value for the chat input field\nexport const sessionInputAtomFamily = atomFamily((_sessionId: string) => atom(\"\"))\n\n// User preference for run mode (persisted across new agent forms)\nexport type RunMode = \"local\" | \"worktree\"\n// Default to local until worktree mode is ready to ship\nexport const preferredRunModeAtom = atom<RunMode>(\"local\")\n\n// Version count for multi-version mode (1 = single, 2-4 = multi-version with worktrees)\nexport type VersionCount = 1 | 2 | 3 | 4\nexport const MAX_VERSION_COUNT = 4\n// Derive options from MAX_VERSION_COUNT to ensure consistency\nexport const VERSION_COUNT_OPTIONS = Array.from({ length: MAX_VERSION_COUNT }, (_, i) => (i + 1) as VersionCount)\nexport const versionCountAtom = atom<VersionCount>(1)\n\n/**\n * Generate version labels with (v1), (v2), etc. suffixes for multi-version mode.\n * Single version (count=1) returns the original label without suffix.\n */\nexport function generateVersionLabels(baseLabel: string, count: VersionCount): string[] {\n\tif (count === 1) {\n\t\treturn [baseLabel]\n\t}\n\n\treturn Array.from({ length: count }, (_, i) => `${baseLabel} (v${i + 1})`)\n}\n\n// Derived - local sessions only\nexport const sessionsArrayAtom = atom((get) => {\n\tconst map = get(sessionsMapAtom)\n\tconst order = get(sessionOrderAtom)\n\treturn order.map((id) => map[id]).filter((s): s is AgentSession => s !== undefined)\n})\n\nfunction toAgentSession(remote: RemoteSession): AgentSession {\n\t// Parse dates safely - invalid dates will produce NaN from getTime()\n\tconst createdTime = remote.created_at ? new Date(remote.created_at).getTime() : 0\n\tconst updatedTime = remote.updated_at ? new Date(remote.updated_at).getTime() : 0\n\n\treturn {\n\t\tsessionId: remote.session_id,\n\t\tlabel: remote.title || \"Untitled\",\n\t\tprompt: \"\",\n\t\tstatus: \"done\",\n\t\t// Use 0 as fallback if dates are invalid (NaN)\n\t\tstartTime: Number.isNaN(createdTime) ? 0 : createdTime,\n\t\tendTime: Number.isNaN(updatedTime) ? 0 : updatedTime,\n\t\tsource: \"remote\",\n\t\tgitUrl: remote.git_url,\n\t}\n}\n\n// Merged sessions: local sessions + remote sessions (deduplicated)\nexport const mergedSessionsAtom = atom((get) => {\n\tconst localSessions = get(sessionsArrayAtom)\n\tconst remoteSessions = get(remoteSessionsAtom)\n\n\t// Build set of session IDs we already have locally\n\tconst localSessionIds = new Set(localSessions.filter((s) => s.sessionId).map((s) => s.sessionId))\n\n\t// Convert remote sessions, excluding those we already have locally\n\tconst remoteAsDisplay = remoteSessions.filter((rs) => !localSessionIds.has(rs.session_id)).map(toAgentSession)\n\n\t// Local sessions first (may be running), then remote sessions (completed)\n\treturn [...localSessions, ...remoteAsDisplay]\n})\n\nexport const selectedSessionAtom = atom((get) => {\n\tconst id = get(selectedSessionIdAtom)\n\tif (!id) return null\n\n\t// First check local sessions map\n\tconst localSession = get(sessionsMapAtom)[id]\n\tif (localSession) return localSession\n\n\t// Then check remote sessions (converted to AgentSession format)\n\tconst remoteSessions = get(remoteSessionsAtom)\n\tconst remoteSession = remoteSessions.find((rs) => rs.session_id === id)\n\tif (remoteSession) return toAgentSession(remoteSession)\n\n\treturn null\n})\n\n// Actions\nexport const upsertSessionAtom = atom(null, (get, set, session: AgentSession) => {\n\tconst current = get(sessionsMapAtom)\n\tconst order = get(sessionOrderAtom)\n\tconst isNewSession = !order.includes(session.sessionId)\n\n\tset(sessionsMapAtom, { ...current, [session.sessionId]: session })\n\tif (isNewSession) {\n\t\tset(sessionOrderAtom, [session.sessionId, ...order])\n\t\tif (get(selectedSessionIdAtom) === null) {\n\t\t\tset(selectedSessionIdAtom, session.sessionId)\n\t\t}\n\t}\n})\n\nexport const removeSessionAtom = atom(null, (get, set, sessionId: string) => {\n\tconst current = get(sessionsMapAtom)\n\tconst { [sessionId]: _, ...rest } = current\n\tset(sessionsMapAtom, rest)\n\tset(\n\t\tsessionOrderAtom,\n\t\tget(sessionOrderAtom).filter((id) => id !== sessionId),\n\t)\n\tif (get(selectedSessionIdAtom) === sessionId) {\n\t\tconst remaining = get(sessionOrderAtom)\n\t\tset(selectedSessionIdAtom, remaining[0] || null)\n\t}\n})\n\nexport const updateSessionStatusAtom = atom(\n\tnull,\n\t(\n\t\tget,\n\t\tset,\n\t\tpayload: {\n\t\t\tsessionId: string\n\t\t\tstatus: AgentStatus\n\t\t\texitCode?: number\n\t\t\terror?: string\n\t\t},\n\t) => {\n\t\tconst current = get(sessionsMapAtom)\n\t\tconst session = current[payload.sessionId]\n\t\tif (!session) return\n\n\t\tset(sessionsMapAtom, {\n\t\t\t...current,\n\t\t\t[payload.sessionId]: {\n\t\t\t\t...session,\n\t\t\t\tstatus: payload.status,\n\t\t\t\texitCode: payload.exitCode,\n\t\t\t\terror: payload.error,\n\t\t\t\tendTime: payload.status !== \"running\" ? Date.now() : session.endTime,\n\t\t\t},\n\t\t})\n\t},\n)\n\nexport const setRemoteSessionsAtom = atom(null, (_get, set, sessions: RemoteSession[]) => {\n\tset(remoteSessionsAtom, sessions)\n\tset(isRefreshingRemoteSessionsAtom, false)\n})\n",
    "/**\n * Jotai atoms for session state machines.\n *\n * Wraps the state machine to provide reactive state management for each session.\n */\nimport { atom } from \"jotai\"\nimport {\n\tcreateSessionStateMachine,\n\ttype SessionStateMachine,\n\ttype SessionEvent,\n\ttype SessionState,\n\ttype SessionUiState,\n} from \"../sessionStateMachine\"\nimport { selectedSessionIdAtom } from \"./sessions\"\n\n// Map of session ID to state machine instance\nconst sessionStateMachines = new Map<string, SessionStateMachine>()\n\n/**\n * Reset all state machines. Only for testing.\n */\nexport function __resetStateMachines() {\n\tsessionStateMachines.clear()\n}\n\n/**\n * Get or create a state machine for a session.\n */\nfunction getOrCreateMachine(sessionId: string): SessionStateMachine {\n\tlet machine = sessionStateMachines.get(sessionId)\n\tif (!machine) {\n\t\tmachine = createSessionStateMachine()\n\t\tsessionStateMachines.set(sessionId, machine)\n\t}\n\treturn machine\n}\n\n/**\n * Stores the current state for each session (triggers Jotai reactivity).\n */\nexport const sessionMachineStateAtom = atom<Record<string, SessionState>>({})\n\n/**\n * Stores the UI state for each session (triggers Jotai reactivity).\n */\nexport const sessionMachineUiStateAtom = atom<Record<string, SessionUiState>>({})\n\n/**\n * Send an event to a session's state machine.\n * This will update the machine state and trigger Jotai reactivity.\n */\nexport const sendSessionEventAtom = atom(null, (get, set, payload: { sessionId: string; event: SessionEvent }) => {\n\tconst { sessionId, event } = payload\n\tconst machine = getOrCreateMachine(sessionId)\n\n\tmachine.send(event)\n\n\t// Update atoms to trigger reactivity\n\tconst currentStates = get(sessionMachineStateAtom)\n\tconst currentUiStates = get(sessionMachineUiStateAtom)\n\n\tset(sessionMachineStateAtom, {\n\t\t...currentStates,\n\t\t[sessionId]: machine.getState(),\n\t})\n\n\tset(sessionMachineUiStateAtom, {\n\t\t...currentUiStates,\n\t\t[sessionId]: machine.getUiState(),\n\t})\n})\n\n/**\n * Reset a session's state machine to idle.\n */\nexport const resetSessionMachineAtom = atom(null, (get, set, sessionId: string) => {\n\tconst machine = sessionStateMachines.get(sessionId)\n\tif (machine) {\n\t\tmachine.reset()\n\n\t\tconst currentStates = get(sessionMachineStateAtom)\n\t\tconst currentUiStates = get(sessionMachineUiStateAtom)\n\n\t\tset(sessionMachineStateAtom, {\n\t\t\t...currentStates,\n\t\t\t[sessionId]: machine.getState(),\n\t\t})\n\n\t\tset(sessionMachineUiStateAtom, {\n\t\t\t...currentUiStates,\n\t\t\t[sessionId]: machine.getUiState(),\n\t\t})\n\t}\n})\n\n/**\n * Clean up a session's state machine (e.g., when session is removed).\n */\nexport const cleanupSessionMachineAtom = atom(null, (_get, _set, sessionId: string) => {\n\tsessionStateMachines.delete(sessionId)\n})\n\n/**\n * Get the state for the selected session.\n */\nexport const selectedSessionMachineStateAtom = atom((get) => {\n\tconst sessionId = get(selectedSessionIdAtom)\n\tif (!sessionId) return null\n\n\tconst states = get(sessionMachineStateAtom)\n\treturn states[sessionId] ?? null\n})\n\n/**\n * Get the UI state for the selected session.\n */\nexport const selectedSessionMachineUiStateAtom = atom((get) => {\n\tconst sessionId = get(selectedSessionIdAtom)\n\tif (!sessionId) return null\n\n\tconst uiStates = get(sessionMachineUiStateAtom)\n\treturn uiStates[sessionId] ?? null\n})\n\n/**\n * Derived: should show spinner for a session.\n * Falls back to false if no state machine exists.\n */\nexport const sessionShowSpinnerAtom = atom((get) => {\n\tconst uiStates = get(sessionMachineUiStateAtom)\n\treturn (sessionId: string) => uiStates[sessionId]?.showSpinner ?? false\n})\n\n/**\n * Derived: should show cancel button for a session.\n */\nexport const sessionShowCancelButtonAtom = atom((get) => {\n\tconst uiStates = get(sessionMachineUiStateAtom)\n\treturn (sessionId: string) => uiStates[sessionId]?.showCancelButton ?? false\n})\n\n/**\n * Derived: is session active (creating, streaming, waiting).\n */\nexport const sessionIsActiveAtom = atom((get) => {\n\tconst uiStates = get(sessionMachineUiStateAtom)\n\treturn (sessionId: string) => uiStates[sessionId]?.isActive ?? false\n})\n",
    "import { atom } from \"jotai\"\nimport { atomFamily } from \"jotai/utils\"\nimport type { ClineMessage } from \"@roo-code/types\"\nimport { sendSessionEventAtom } from \"./stateMachine\"\nimport type { SessionEvent } from \"../sessionStateMachine\"\n\n// Per-session messages using atomFamily\nexport const sessionMessagesAtomFamily = atomFamily((_sessionId: string) => atom<ClineMessage[]>([]))\n\n// Version tracking for reconciliation (per session)\nexport const sessionMessageVersionsAtomFamily = atomFamily((_sessionId: string) => atom<Map<number, number>>(new Map()))\n\n// Derived: last message per session\nexport const lastSessionMessageAtomFamily = atomFamily((sessionId: string) =>\n\tatom((get) => {\n\t\tconst messages = get(sessionMessagesAtomFamily(sessionId))\n\t\treturn messages[messages.length - 1] || null\n\t}),\n)\n\n// Derived: check if session has messages\nexport const hasSessionMessagesAtomFamily = atomFamily((sessionId: string) =>\n\tatom((get) => {\n\t\tconst messages = get(sessionMessagesAtomFamily(sessionId))\n\t\treturn messages.length > 0\n\t}),\n)\n\n// Actions\nexport const updateSessionMessagesAtom = atom(\n\tnull,\n\t(get, set, payload: { sessionId: string; messages: ClineMessage[] }) => {\n\t\tconst { sessionId, messages } = payload\n\t\tconst current = get(sessionMessagesAtomFamily(sessionId))\n\t\tconst versions = get(sessionMessageVersionsAtomFamily(sessionId))\n\n\t\t// Reconcile to prevent streaming flicker\n\t\tconst reconciled = reconcileMessages(current, messages, versions)\n\t\tset(sessionMessagesAtomFamily(sessionId), reconciled)\n\n\t\t// Update version map\n\t\tconst newVersions = new Map<number, number>()\n\t\treconciled.forEach((m) => newVersions.set(m.ts, getContentLength(m)))\n\t\tset(sessionMessageVersionsAtomFamily(sessionId), newVersions)\n\n\t\t// Send events for new/updated messages (in order)\n\t\tconst previous = new Map(current.map((m) => [m.ts, m]))\n\t\tfor (const msg of reconciled) {\n\t\t\tconst prev = previous.get(msg.ts)\n\t\t\tconst isNew = !prev\n\t\t\tconst becameComplete = prev?.partial && !msg.partial\n\t\t\tif (!isNew && !becameComplete) continue\n\t\t\tconst event = messageToEvent(msg)\n\t\t\tif (event) {\n\t\t\t\tset(sendSessionEventAtom, { sessionId, event })\n\t\t\t}\n\t\t}\n\t},\n)\n\nexport const updateSessionMessageByTsAtom = atom(\n\tnull,\n\t(get, set, payload: { sessionId: string; message: ClineMessage }) => {\n\t\tconst { sessionId, message } = payload\n\t\tconst messages = get(sessionMessagesAtomFamily(sessionId))\n\t\tconst idx = messages.findIndex((m) => m.ts === message.ts)\n\t\tif (idx === -1) return\n\n\t\tconst newMessages = [...messages]\n\t\tnewMessages[idx] = message\n\t\tset(sessionMessagesAtomFamily(sessionId), newMessages)\n\n\t\t// Update version\n\t\tconst versions = get(sessionMessageVersionsAtomFamily(sessionId))\n\t\tconst newVersions = new Map(versions)\n\t\tnewVersions.set(message.ts, getContentLength(message))\n\t\tset(sessionMessageVersionsAtomFamily(sessionId), newVersions)\n\t},\n)\n\nexport const clearSessionMessagesAtom = atom(null, (_get, set, sessionId: string) => {\n\tset(sessionMessagesAtomFamily(sessionId), [])\n\tset(sessionMessageVersionsAtomFamily(sessionId), new Map())\n})\n\n// Helpers - adapted from cli/src/state/atoms/extension.ts\nexport function getContentLength(msg: ClineMessage): number {\n\treturn (msg.text?.length || 0) + (msg.say?.length || 0) + (msg.ask?.length || 0)\n}\n\nexport function reconcileMessages(\n\tcurrent: ClineMessage[],\n\tincoming: ClineMessage[],\n\tversions: Map<number, number>,\n): ClineMessage[] {\n\tconst currentMap = new Map(current.map((m) => [m.ts, m]))\n\n\treturn incoming.map((incomingMsg) => {\n\t\tconst existing = currentMap.get(incomingMsg.ts)\n\t\tif (!existing) return incomingMsg\n\n\t\t// Protect completed messages from partial rollback\n\t\tif (!existing.partial && incomingMsg.partial) {\n\t\t\tconst currentLen = versions.get(incomingMsg.ts) || 0\n\t\t\tif (getContentLength(incomingMsg) <= currentLen) {\n\t\t\t\treturn existing\n\t\t\t}\n\t\t}\n\n\t\treturn incomingMsg\n\t})\n}\n\n/**\n * Convert a ClineMessage to a SessionEvent for the state machine.\n * Returns null if the message doesn't map to a state-changing event.\n */\nexport function messageToEvent(msg: ClineMessage): SessionEvent | null {\n\tconst partial = msg.partial ?? false\n\n\t// Say messages - check the say field for specific event types\n\tif (msg.type === \"say\" && msg.say) {\n\t\tswitch (msg.say) {\n\t\t\t// API request started - important for transitioning to streaming\n\t\t\tcase \"api_req_started\":\n\t\t\t\treturn { type: \"api_req_started\" }\n\n\t\t\t// Text and other say messages - stay streaming\n\t\t\tcase \"text\":\n\t\t\tcase \"command_output\":\n\t\t\tcase \"user_feedback\":\n\t\t\tcase \"user_feedback_diff\":\n\t\t\tcase \"api_req_finished\":\n\t\t\tcase \"api_req_retried\":\n\t\t\tcase \"completion_result\":\n\t\t\tcase \"shell_integration_warning\":\n\t\t\tcase \"checkpoint_saved\":\n\t\t\t\treturn { type: \"say_text\", partial }\n\n\t\t\tdefault:\n\t\t\t\treturn { type: \"say_text\", partial }\n\t\t}\n\t}\n\n\t// Ask messages - depend on ask type\n\tif (msg.type === \"ask\" && msg.ask) {\n\t\tswitch (msg.ask) {\n\t\t\t// Approval-required asks\n\t\t\tcase \"tool\":\n\t\t\t\treturn { type: \"ask_tool\", partial }\n\t\t\tcase \"command\":\n\t\t\t\treturn { type: \"ask_command\", partial }\n\t\t\tcase \"browser_action_launch\":\n\t\t\t\treturn { type: \"ask_browser_action_launch\", partial }\n\t\t\tcase \"use_mcp_server\":\n\t\t\t\treturn { type: \"ask_use_mcp_server\", partial }\n\n\t\t\t// Input-required asks\n\t\t\tcase \"followup\":\n\t\t\t\treturn { type: \"ask_followup\", partial }\n\n\t\t\t// Completion\n\t\t\tcase \"completion_result\":\n\t\t\t\treturn { type: \"ask_completion_result\" }\n\n\t\t\t// Errors\n\t\t\tcase \"api_req_failed\":\n\t\t\t\treturn { type: \"ask_api_req_failed\" }\n\t\t\tcase \"mistake_limit_reached\":\n\t\t\t\treturn { type: \"ask_mistake_limit_reached\" }\n\t\t\tcase \"invalid_model\":\n\t\t\t\treturn { type: \"ask_invalid_model\" }\n\t\t\tcase \"payment_required_prompt\":\n\t\t\t\treturn { type: \"ask_payment_required_prompt\" }\n\n\t\t\t// Resumable\n\t\t\tcase \"resume_task\":\n\t\t\t\treturn { type: \"ask_resume_task\" }\n\t\t\tcase \"resume_completed_task\":\n\t\t\t\treturn { type: \"ask_resume_task\" }\n\n\t\t\tdefault:\n\t\t\t\treturn null\n\t\t}\n\t}\n\n\treturn null\n}\n",
    "import { atom } from \"jotai\"\nimport { atomFamily } from \"jotai/utils\"\nimport type { TodoItem } from \"@roo-code/types\"\n\n/**\n * Per-session todo list using atomFamily.\n * Tracks the latest todos extracted from session messages.\n */\nexport const sessionTodosAtomFamily = atomFamily((_sessionId: string) => atom<TodoItem[]>([]))\n\n/**\n * Computed stats for a todo list.\n */\nexport interface TodoStats {\n\ttodos: TodoItem[]\n\tcompletedCount: number\n\ttotalCount: number\n\tinProgressTodo: TodoItem | undefined\n\tnextPendingTodo: TodoItem | undefined\n\tcurrentTodo: TodoItem | undefined\n\tallCompleted: boolean\n\tprogressPercent: number\n}\n\n/**\n * Compute stats from a todo list. Pure function for testability.\n */\nexport function computeTodoStats(todos: TodoItem[]): TodoStats {\n\tconst completedCount = todos.filter((t) => t.status === \"completed\").length\n\tconst totalCount = todos.length\n\tconst inProgressTodo = todos.find((t) => t.status === \"in_progress\")\n\tconst nextPendingTodo = todos.find((t) => t.status === \"pending\")\n\tconst currentTodo = inProgressTodo || nextPendingTodo\n\tconst allCompleted = totalCount > 0 && completedCount === totalCount\n\tconst progressPercent = totalCount > 0 ? (completedCount / totalCount) * 100 : 0\n\n\treturn {\n\t\ttodos,\n\t\tcompletedCount,\n\t\ttotalCount,\n\t\tinProgressTodo,\n\t\tnextPendingTodo,\n\t\tcurrentTodo,\n\t\tallCompleted,\n\t\tprogressPercent,\n\t}\n}\n\n/**\n * Derived atom family for todo stats per session.\n */\nexport const sessionTodoStatsAtomFamily = atomFamily((sessionId: string) =>\n\tatom((get): TodoStats => {\n\t\tconst todos = get(sessionTodosAtomFamily(sessionId))\n\t\treturn computeTodoStats(todos)\n\t}),\n)\n\n/**\n * Action atom to update todos for a session.\n */\nexport const updateSessionTodosAtom = atom(null, (_get, set, payload: { sessionId: string; todos: TodoItem[] }) => {\n\tconst { sessionId, todos } = payload\n\tset(sessionTodosAtomFamily(sessionId), todos)\n})\n",
    "import { atom } from \"jotai\"\n\n/**\n * List of local branches available in the workspace repository.\n * This is workspace-level state (not session-specific) because all sessions\n * share the same git repository and have access to the same branches.\n */\nexport const branchesAtom = atom<string[]>([])\n\n/**\n * Current branch name in the workspace (not session-specific)\n */\nexport const currentBranchAtom = atom<string | undefined>(undefined)\n\n/**\n * Action atom to update the branches list and current branch\n */\nexport const updateBranchesAtom = atom(null, (_get, set, payload: { branches: string[]; currentBranch?: string }) => {\n\tconst { branches, currentBranch } = payload\n\tset(branchesAtom, branches)\n\tset(currentBranchAtom, currentBranch)\n})\n",
    "import { atom } from \"jotai\"\n\nconst STORAGE_KEY = \"agentManager.selectedModelId\"\n\n/**\n * Model information returned from CLI models command\n */\nexport interface AvailableModel {\n\tid: string\n\tdisplayName: string | null\n\tcontextWindow: number\n\tsupportsImages?: boolean\n\tinputPrice?: number\n\toutputPrice?: number\n}\n\n/**\n * Provider and model configuration from CLI\n */\nexport interface ModelsConfig {\n\tprovider: string\n\tcurrentModel: string\n\tmodels: AvailableModel[]\n}\n\n/**\n * Whether models are currently being loaded from CLI.\n * Starts as true since we fetch models on panel open.\n */\nexport const modelsLoadingAtom = atom<boolean>(true)\n\n/**\n * Available models fetched from CLI via `kilocode models --json`.\n * This is workspace-level state (not session-specific) because the provider\n * configuration is shared across all sessions.\n */\nexport const modelsConfigAtom = atom<ModelsConfig | null>(null)\n\n/**\n * Helper to get persisted model ID from localStorage\n */\nfunction getPersistedModelId(): string | null {\n\ttry {\n\t\treturn localStorage.getItem(STORAGE_KEY)\n\t} catch (error) {\n\t\tconsole.error(\"[AgentManager] Failed to read model selection from localStorage:\", error)\n\t\treturn null\n\t}\n}\n\n/**\n * Helper to persist model ID to localStorage\n */\nfunction persistModelId(modelId: string | null): void {\n\ttry {\n\t\tif (modelId) {\n\t\t\tlocalStorage.setItem(STORAGE_KEY, modelId)\n\t\t} else {\n\t\t\tlocalStorage.removeItem(STORAGE_KEY)\n\t\t}\n\t} catch (error) {\n\t\tconsole.error(\"[AgentManager] Failed to persist model selection to localStorage:\", error)\n\t}\n}\n\n/**\n * Currently selected model for new sessions.\n * Initialized from localStorage if available.\n * Defaults to currentModel from CLI if not explicitly set.\n */\nexport const selectedModelIdAtom = atom<string | null>(getPersistedModelId())\n\n/**\n * Derived atom: the effective model ID to use for new sessions.\n * Returns selectedModelIdAtom if set, otherwise currentModel from modelsConfigAtom.\n */\nexport const effectiveModelIdAtom = atom((get) => {\n\tconst selected = get(selectedModelIdAtom)\n\tif (selected) return selected\n\n\tconst config = get(modelsConfigAtom)\n\treturn config?.currentModel ?? null\n})\n\n/**\n * Action atom to update the models configuration from extension message.\n * Also sets loading to false when models are received.\n * Validates persisted model selection against available models.\n */\nexport const updateModelsConfigAtom = atom(\n\tnull,\n\t(get, set, payload: { provider: string; currentModel: string; models: AvailableModel[] }) => {\n\t\tset(modelsConfigAtom, payload)\n\t\tset(modelsLoadingAtom, false)\n\n\t\t// Validate persisted selection - clear if model no longer exists\n\t\tconst currentSelection = get(selectedModelIdAtom)\n\t\tif (currentSelection) {\n\t\t\tconst modelExists = payload.models.some((m) => m.id === currentSelection)\n\t\t\tif (!modelExists) {\n\t\t\t\t// Clear invalid persisted selection\n\t\t\t\tset(selectedModelIdAtom, null)\n\t\t\t\tpersistModelId(null)\n\t\t\t}\n\t\t}\n\t},\n)\n\n/**\n * Action atom to handle model loading failure.\n * Sets loading to false so UI exits loading state.\n */\nexport const modelsLoadFailedAtom = atom(null, (_get, set, _error?: string) => {\n\tset(modelsLoadingAtom, false)\n\t// Keep modelsConfigAtom as null - UI will show nothing for model selector\n})\n\n/**\n * Action atom to set selected model ID with localStorage persistence\n */\nexport const setSelectedModelIdAtom = atom(null, (_get, set, modelId: string | null) => {\n\tset(selectedModelIdAtom, modelId)\n\tpersistModelId(modelId)\n})\n",
    "import type { ClineMessage, TodoItem } from \"@roo-code/types\"\n\ninterface TodoMetadata {\n\ttool?: string\n\ttodos?: TodoItem[]\n}\n\n/**\n * Extract the latest todos from a list of ClineMessages.\n * Checks both metadata (from CLI) and parsed text for todo data.\n */\nexport function extractTodosFromMessages(messages: ClineMessage[]): TodoItem[] {\n\tconst todos = messages\n\t\t.filter(\n\t\t\t(msg) =>\n\t\t\t\t(msg.type === \"ask\" && msg.ask === \"tool\") || (msg.type === \"say\" && msg.say === \"user_edit_todos\"),\n\t\t)\n\t\t.map((msg) => {\n\t\t\t// Check metadata first (CLI sends tool info here)\n\t\t\tconst metadata = msg.metadata as TodoMetadata | undefined\n\t\t\tif (metadata?.tool === \"updateTodoList\" && Array.isArray(metadata.todos)) {\n\t\t\t\treturn { tool: \"updateTodoList\", todos: metadata.todos }\n\t\t\t}\n\t\t\t// Fall back to parsing text\n\t\t\ttry {\n\t\t\t\treturn JSON.parse(msg.text ?? \"{}\")\n\t\t\t} catch {\n\t\t\t\treturn null\n\t\t\t}\n\t\t})\n\t\t.filter((item) => item && item.tool === \"updateTodoList\" && Array.isArray(item.todos))\n\t\t.map((item) => item.todos as TodoItem[])\n\t\t.pop()\n\n\treturn todos ?? []\n}\n",
    "import { useEffect, useRef } from \"react\"\nimport { useAtomValue, useSetAtom } from \"jotai\"\nimport type { ClineMessage } from \"@roo-code/types\"\nimport { updateSessionMessagesAtom } from \"../atoms/messages\"\nimport { updateSessionTodosAtom } from \"../atoms/todos\"\nimport { updateBranchesAtom } from \"../atoms/branches\"\nimport { updateModelsConfigAtom, modelsLoadFailedAtom, type AvailableModel } from \"../atoms/models\"\nimport { extractTodosFromMessages } from \"./extractTodosFromMessages\"\nimport {\n\tupsertSessionAtom,\n\tremoveSessionAtom,\n\tselectedSessionIdAtom,\n\tstartSessionFailedCounterAtom,\n\tsessionOrderAtom,\n\tremoteSessionsAtom,\n\tpendingSessionAtom,\n\tisRefreshingRemoteSessionsAtom,\n\ttype AgentSession,\n\ttype RemoteSession,\n\ttype PendingSession,\n} from \"../atoms/sessions\"\nimport { sendSessionEventAtom, cleanupSessionMachineAtom } from \"../atoms/stateMachine\"\nimport type { SessionEvent } from \"../sessionStateMachine\"\n\ninterface AgentManagerState {\n\tsessions: AgentSession[]\n\tselectedId: string | null\n}\n\ninterface ChatMessagesMessage {\n\ttype: \"agentManager.chatMessages\"\n\tsessionId: string\n\tmessages: ClineMessage[]\n}\n\ninterface StateMessage {\n\ttype: \"agentManager.state\"\n\tstate: AgentManagerState\n}\n\ninterface StartSessionFailedMessage {\n\ttype: \"agentManager.startSessionFailed\"\n}\n\ninterface RemoteSessionsMessage {\n\ttype: \"agentManager.remoteSessions\"\n\tsessions: RemoteSession[]\n}\n\ninterface PendingSessionMessage {\n\ttype: \"agentManager.pendingSession\"\n\tpendingSession: PendingSession | null\n}\n\ninterface StateEventMessage {\n\ttype: \"agentManager.stateEvent\"\n\tsessionId: string\n\teventType: string\n\tpartial?: boolean\n}\n\ninterface BranchesMessage {\n\ttype: \"agentManager.branches\"\n\tbranches: string[]\n\tcurrentBranch?: string\n}\n\ninterface AvailableModelsMessage {\n\ttype: \"agentManager.availableModels\"\n\tprovider: string\n\tcurrentModel: string\n\tmodels: AvailableModel[]\n}\n\ninterface ModelsLoadFailedMessage {\n\ttype: \"agentManager.modelsLoadFailed\"\n\terror?: string\n}\n\ntype ExtensionMessage =\n\t| ChatMessagesMessage\n\t| StateMessage\n\t| StartSessionFailedMessage\n\t| RemoteSessionsMessage\n\t| PendingSessionMessage\n\t| StateEventMessage\n\t| BranchesMessage\n\t| AvailableModelsMessage\n\t| ModelsLoadFailedMessage\n\t| { type: string; [key: string]: unknown }\n\n/**\n * Maps extension state event types to state machine events.\n */\nfunction mapToStateMachineEvent(eventType: string, partial?: boolean): SessionEvent | null {\n\tswitch (eventType) {\n\t\tcase \"api_req_started\":\n\t\t\treturn { type: \"api_req_started\" }\n\n\t\t// Input-required asks\n\t\tcase \"ask_followup\":\n\t\t\t// Followups should always transition to waiting_input (partial handling is done in the state machine).\n\t\t\treturn { type: \"ask_followup\", partial: partial ?? false }\n\n\t\t// Approval-required asks\n\t\tcase \"ask_tool\":\n\t\t\treturn { type: \"ask_tool\", partial: partial ?? false }\n\t\tcase \"ask_command\":\n\t\t\treturn { type: \"ask_command\", partial: partial ?? false }\n\t\tcase \"ask_browser_action_launch\":\n\t\t\treturn { type: \"ask_browser_action_launch\", partial: partial ?? false }\n\t\tcase \"ask_use_mcp_server\":\n\t\t\treturn { type: \"ask_use_mcp_server\", partial: partial ?? false }\n\n\t\t// Completion\n\t\tcase \"ask_completion_result\":\n\t\t\treturn { type: \"ask_completion_result\" }\n\n\t\t// Paused state\n\t\tcase \"ask_resume_task\":\n\t\t\treturn { type: \"ask_resume_task\" }\n\n\t\t// Error states\n\t\tcase \"ask_api_req_failed\":\n\t\t\treturn { type: \"ask_api_req_failed\" }\n\t\tcase \"ask_mistake_limit_reached\":\n\t\t\treturn { type: \"ask_mistake_limit_reached\" }\n\t\tcase \"ask_invalid_model\":\n\t\t\treturn { type: \"ask_invalid_model\" }\n\t\tcase \"ask_payment_required_prompt\":\n\t\t\treturn { type: \"ask_payment_required_prompt\" }\n\n\t\t// Cancellation\n\t\tcase \"cancel_session\":\n\t\t\treturn { type: \"cancel_session\" }\n\n\t\tdefault:\n\t\t\treturn null\n\t}\n}\n\n/**\n * Hook that listens for messages from the extension and updates Jotai state.\n * This bridges the VS Code extension IPC with the Jotai state management.\n */\nexport function useAgentManagerMessages() {\n\tconst updateSessionMessages = useSetAtom(updateSessionMessagesAtom)\n\tconst updateSessionTodos = useSetAtom(updateSessionTodosAtom)\n\tconst updateBranches = useSetAtom(updateBranchesAtom)\n\tconst updateModelsConfig = useSetAtom(updateModelsConfigAtom)\n\tconst handleModelsLoadFailed = useSetAtom(modelsLoadFailedAtom)\n\tconst upsertSession = useSetAtom(upsertSessionAtom)\n\tconst removeSession = useSetAtom(removeSessionAtom)\n\tconst setSelectedSessionId = useSetAtom(selectedSessionIdAtom)\n\tconst setStartSessionFailedCounter = useSetAtom(startSessionFailedCounterAtom)\n\tconst setRemoteSessions = useSetAtom(remoteSessionsAtom)\n\tconst setPendingSession = useSetAtom(pendingSessionAtom)\n\tconst setIsRefreshingRemoteSessions = useSetAtom(isRefreshingRemoteSessionsAtom)\n\tconst sendSessionEvent = useSetAtom(sendSessionEventAtom)\n\tconst cleanupSessionMachine = useSetAtom(cleanupSessionMachineAtom)\n\tconst sessionOrder = useAtomValue(sessionOrderAtom)\n\tconst hasInitializedSelection = useRef(false)\n\tconst knownSessionsRef = useRef(new Set<string>())\n\n\tuseEffect(() => {\n\t\tfunction handleMessage(event: MessageEvent<ExtensionMessage>) {\n\t\t\tconst message = event.data\n\n\t\t\tswitch (message.type) {\n\t\t\t\tcase \"agentManager.chatMessages\": {\n\t\t\t\t\tconst { sessionId, messages } = message as ChatMessagesMessage\n\t\t\t\t\tupdateSessionMessages({ sessionId, messages })\n\t\t\t\t\t// Extract and update todos from messages\n\t\t\t\t\tconst todos = extractTodosFromMessages(messages)\n\t\t\t\t\tupdateSessionTodos({ sessionId, todos })\n\t\t\t\t\tbreak\n\t\t\t\t}\n\n\t\t\t\tcase \"agentManager.state\": {\n\t\t\t\t\tconst { state } = message as StateMessage\n\t\t\t\t\tfor (const session of state.sessions) {\n\t\t\t\t\t\t// Check if this is a new session we haven't seen before\n\t\t\t\t\t\tconst isNewSession = !knownSessionsRef.current.has(session.sessionId)\n\t\t\t\t\t\tupsertSession(session)\n\n\t\t\t\t\t\t// Send state machine events for new sessions based on status\n\t\t\t\t\t\tif (isNewSession) {\n\t\t\t\t\t\t\tknownSessionsRef.current.add(session.sessionId)\n\t\t\t\t\t\t\tif (session.status === \"creating\" || session.status === \"running\") {\n\t\t\t\t\t\t\t\tsendSessionEvent({\n\t\t\t\t\t\t\t\t\tsessionId: session.sessionId,\n\t\t\t\t\t\t\t\t\tevent: { type: \"start_session\" },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\tsendSessionEvent({\n\t\t\t\t\t\t\t\t\tsessionId: session.sessionId,\n\t\t\t\t\t\t\t\t\tevent: { type: \"session_created\", sessionId: session.sessionId },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t// If session is already running, also send api_req_started\n\t\t\t\t\t\t\t\t// The state machine needs both session_created AND api_req_started\n\t\t\t\t\t\t\t\t// to transition from \"creating\" to \"streaming\"\n\t\t\t\t\t\t\t\tif (session.status === \"running\") {\n\t\t\t\t\t\t\t\t\tsendSessionEvent({\n\t\t\t\t\t\t\t\t\t\tsessionId: session.sessionId,\n\t\t\t\t\t\t\t\t\t\tevent: { type: \"api_req_started\" },\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconst extensionSessionIds = new Set(state.sessions.map((s) => s.sessionId))\n\t\t\t\t\tfor (const sessionId of sessionOrder) {\n\t\t\t\t\t\tif (!extensionSessionIds.has(sessionId)) {\n\t\t\t\t\t\t\tremoveSession(sessionId)\n\t\t\t\t\t\t\tcleanupSessionMachine(sessionId)\n\t\t\t\t\t\t\tknownSessionsRef.current.delete(sessionId)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!hasInitializedSelection.current && state.selectedId !== undefined) {\n\t\t\t\t\t\tsetSelectedSessionId(state.selectedId)\n\t\t\t\t\t\thasInitializedSelection.current = true\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\n\t\t\t\tcase \"agentManager.startSessionFailed\": {\n\t\t\t\t\t// Increment counter so components can reset their loading state\n\t\t\t\t\tsetStartSessionFailedCounter((c) => c + 1)\n\t\t\t\t\t// Also clear pending session\n\t\t\t\t\tsetPendingSession(null)\n\t\t\t\t\tbreak\n\t\t\t\t}\n\n\t\t\t\tcase \"agentManager.remoteSessions\": {\n\t\t\t\t\tconst { sessions } = message as RemoteSessionsMessage\n\t\t\t\t\tsetRemoteSessions(sessions)\n\t\t\t\t\tsetIsRefreshingRemoteSessions(false)\n\t\t\t\t\tbreak\n\t\t\t\t}\n\n\t\t\t\tcase \"agentManager.pendingSession\": {\n\t\t\t\t\tconst { pendingSession } = message as PendingSessionMessage\n\t\t\t\t\tsetPendingSession(pendingSession)\n\t\t\t\t\tbreak\n\t\t\t\t}\n\n\t\t\t\tcase \"agentManager.stateEvent\": {\n\t\t\t\t\tconst { sessionId, eventType, partial } = message as StateEventMessage\n\t\t\t\t\t// Convert extension state events to state machine events\n\t\t\t\t\tconst event = mapToStateMachineEvent(eventType, partial)\n\t\t\t\t\tif (event) {\n\t\t\t\t\t\tsendSessionEvent({ sessionId, event })\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\n\t\t\t\tcase \"agentManager.branches\": {\n\t\t\t\t\tconst { branches, currentBranch } = message as BranchesMessage\n\t\t\t\t\tupdateBranches({ branches, currentBranch })\n\t\t\t\t\tbreak\n\t\t\t\t}\n\n\t\t\t\tcase \"agentManager.availableModels\": {\n\t\t\t\t\tconst { provider, currentModel, models } = message as AvailableModelsMessage\n\t\t\t\t\tupdateModelsConfig({ provider, currentModel, models })\n\t\t\t\t\tbreak\n\t\t\t\t}\n\n\t\t\t\tcase \"agentManager.modelsLoadFailed\": {\n\t\t\t\t\tconst { error } = message as ModelsLoadFailedMessage\n\t\t\t\t\thandleModelsLoadFailed(error)\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\twindow.addEventListener(\"message\", handleMessage)\n\t\treturn () => window.removeEventListener(\"message\", handleMessage)\n\t}, [\n\t\tupdateSessionMessages,\n\t\tupdateSessionTodos,\n\t\tupdateBranches,\n\t\tupdateModelsConfig,\n\t\thandleModelsLoadFailed,\n\t\tupsertSession,\n\t\tremoveSession,\n\t\tsetSelectedSessionId,\n\t\tsetStartSessionFailedCounter,\n\t\tsetRemoteSessions,\n\t\tsetPendingSession,\n\t\tsetIsRefreshingRemoteSessions,\n\t\tsendSessionEvent,\n\t\tcleanupSessionMachine,\n\t\tsessionOrder,\n\t])\n}\n",
    "import { atom } from \"jotai\"\nimport { atomFamily } from \"jotai/utils\"\n\n/**\n * Generate a random UUID using native crypto.randomUUID().\n * Available in all modern browsers and Node.js environments.\n */\nconst generateId = (): string => crypto.randomUUID()\n\nexport interface QueuedMessage {\n\tid: string\n\tsessionId: string\n\tcontent: string\n\tstatus: \"queued\" | \"sending\" | \"sent\" | \"failed\"\n\ttimestamp: number\n\terror?: string\n\tretryCount: number\n\tmaxRetries: number\n}\n\n// Per-session message queue\nexport const sessionMessageQueueAtomFamily = atomFamily((_sessionId: string) => atom<QueuedMessage[]>([]))\n\n// Track currently sending message ID per session\nexport const sessionSendingMessageIdAtomFamily = atomFamily((_sessionId: string) => atom<string | null>(null))\n\n// Derived: is session queue empty?\nexport const isSessionQueueEmptyAtomFamily = atomFamily((sessionId: string) =>\n\tatom((get) => {\n\t\tconst queue = get(sessionMessageQueueAtomFamily(sessionId))\n\t\treturn queue.length === 0\n\t}),\n)\n\n// Derived: get next queued message (first one with \"queued\" status)\nexport const nextQueuedMessageAtomFamily = atomFamily((sessionId: string) =>\n\tatom((get) => {\n\t\tconst queue = get(sessionMessageQueueAtomFamily(sessionId))\n\t\treturn queue.find((msg) => msg.status === \"queued\") || null\n\t}),\n)\n\n// Action: Add message to queue\nexport const addToQueueAtom = atom(null, (get, set, payload: { sessionId: string; content: string }) => {\n\tconst { sessionId, content } = payload\n\tconst queue = get(sessionMessageQueueAtomFamily(sessionId))\n\n\tconst newMessage: QueuedMessage = {\n\t\tid: generateId(),\n\t\tsessionId,\n\t\tcontent,\n\t\tstatus: \"queued\",\n\t\ttimestamp: Date.now(),\n\t\tretryCount: 0,\n\t\tmaxRetries: 3,\n\t}\n\n\tset(sessionMessageQueueAtomFamily(sessionId), [...queue, newMessage])\n\treturn newMessage\n})\n\n// Action: Update message status\nexport const updateMessageStatusAtom = atom(\n\tnull,\n\t(\n\t\tget,\n\t\tset,\n\t\tpayload: {\n\t\t\tsessionId: string\n\t\t\tmessageId: string\n\t\t\tstatus: \"queued\" | \"sending\" | \"sent\" | \"failed\"\n\t\t\terror?: string\n\t\t},\n\t) => {\n\t\tconst { sessionId, messageId, status, error } = payload\n\t\tconst queue = get(sessionMessageQueueAtomFamily(sessionId))\n\n\t\tconst updated = queue.map((msg) =>\n\t\t\tmsg.id === messageId\n\t\t\t\t? {\n\t\t\t\t\t\t...msg,\n\t\t\t\t\t\tstatus,\n\t\t\t\t\t\terror: error || undefined,\n\t\t\t\t\t}\n\t\t\t\t: msg,\n\t\t)\n\n\t\tset(sessionMessageQueueAtomFamily(sessionId), updated)\n\t},\n)\n\n// Action: Remove message from queue\nexport const removeFromQueueAtom = atom(null, (get, set, payload: { sessionId: string; messageId: string }) => {\n\tconst { sessionId, messageId } = payload\n\tconst queue = get(sessionMessageQueueAtomFamily(sessionId))\n\n\tconst filtered = queue.filter((msg) => msg.id !== messageId)\n\tset(sessionMessageQueueAtomFamily(sessionId), filtered)\n})\n\n// Action: Retry a failed message\nexport const retryFailedMessageAtom = atom(null, (get, set, payload: { sessionId: string; messageId: string }) => {\n\tconst { sessionId, messageId } = payload\n\tconst queue = get(sessionMessageQueueAtomFamily(sessionId))\n\n\tconst updated = queue.map((msg) => {\n\t\tif (msg.id === messageId && msg.status === \"failed\") {\n\t\t\t// Only retry if haven't exceeded max retries\n\t\t\tif (msg.retryCount < msg.maxRetries) {\n\t\t\t\treturn {\n\t\t\t\t\t...msg,\n\t\t\t\t\tstatus: \"queued\" as const,\n\t\t\t\t\terror: undefined,\n\t\t\t\t\tretryCount: msg.retryCount + 1,\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn msg\n\t})\n\n\tset(sessionMessageQueueAtomFamily(sessionId), updated)\n})\n\n// Action: Clear queue for session\nexport const clearSessionQueueAtom = atom(null, (_get, set, sessionId: string) => {\n\tset(sessionMessageQueueAtomFamily(sessionId), [])\n\tset(sessionSendingMessageIdAtomFamily(sessionId), null)\n})\n\n// Action: Set currently sending message\nexport const setSendingMessageAtom = atom(\n\tnull,\n\t(_get, set, payload: { sessionId: string; messageId: string | null }) => {\n\t\tconst { sessionId, messageId } = payload\n\t\tset(sessionSendingMessageIdAtomFamily(sessionId), messageId)\n\t},\n)\n",
    "/**\n * VS Code webview API wrapper for Agent Manager\n */\n\ninterface VSCodeApi {\n\tpostMessage: (message: unknown) => void\n\tgetState: () => unknown\n\tsetState: (state: unknown) => void\n}\n\n// Declare the VS Code API acquisition function\ndeclare function acquireVsCodeApi(): VSCodeApi\n\n// Cache the API instance\nlet vsCodeApi: VSCodeApi | undefined\n\nexport function getVSCodeApi(): VSCodeApi {\n\tif (!vsCodeApi) {\n\t\tvsCodeApi = acquireVsCodeApi()\n\t}\n\treturn vsCodeApi\n}\n\nexport const vscode = {\n\tpostMessage: (message: unknown) => getVSCodeApi().postMessage(message),\n\tgetState: () => getVSCodeApi().getState(),\n\tsetState: (state: unknown) => getVSCodeApi().setState(state),\n}\n",
    "import { useEffect, useCallback } from \"react\"\nimport { useAtomValue, useSetAtom } from \"jotai\"\nimport {\n\tsessionMessageQueueAtomFamily,\n\tsessionSendingMessageIdAtomFamily,\n\tupdateMessageStatusAtom,\n\tremoveFromQueueAtom,\n\tsetSendingMessageAtom,\n} from \"../atoms/messageQueue\"\nimport { vscode } from \"../../utils/vscode\"\n\n/**\n * Hook that processes the message queue for a session.\n * Listens for message status updates from the extension and:\n * - Updates queue item status\n * - Removes sent messages from queue\n * - Sends next queued message when current one completes\n *\n * @param sessionId - The current session ID (can be null)\n */\nexport function useMessageQueueProcessor(sessionId: string | null) {\n\tconst queue = useAtomValue(sessionMessageQueueAtomFamily(sessionId || \"\"))\n\tconst sendingMessageId = useAtomValue(sessionSendingMessageIdAtomFamily(sessionId || \"\"))\n\tconst updateStatus = useSetAtom(updateMessageStatusAtom)\n\tconst removeFromQueue = useSetAtom(removeFromQueueAtom)\n\tconst setSendingMessage = useSetAtom(setSendingMessageAtom)\n\n\t// Send the next queued message\n\tconst sendNextMessage = useCallback(\n\t\t(messageId: string, content: string) => {\n\t\t\tif (!sessionId) return\n\n\t\t\tsetSendingMessage({ sessionId, messageId })\n\t\t\tvscode.postMessage({\n\t\t\t\ttype: \"agentManager.messageQueued\",\n\t\t\t\tsessionId,\n\t\t\t\tmessageId,\n\t\t\t\tcontent,\n\t\t\t})\n\t\t},\n\t\t[sessionId, setSendingMessage],\n\t)\n\n\t// Listen for message status updates from the extension\n\tuseEffect(() => {\n\t\tif (!sessionId) return\n\n\t\tconst handleMessage = (event: MessageEvent) => {\n\t\t\tif (event.data.type !== \"agentManager.messageStatus\") return\n\n\t\t\tconst { sessionId: eventSessionId, messageId, status, error } = event.data\n\n\t\t\tif (eventSessionId !== sessionId) return\n\n\t\t\tif (status === \"sending\" || status === \"failed\") {\n\t\t\t\tupdateStatus({ sessionId, messageId, status, error })\n\t\t\t}\n\n\t\t\tif (status === \"sent\") {\n\t\t\t\tremoveFromQueue({ sessionId, messageId })\n\t\t\t\tsetSendingMessage({ sessionId, messageId: null })\n\t\t\t\t// Next message is picked up by the auto-process effect when sendingMessageId becomes null\n\t\t\t}\n\n\t\t\tif (status === \"failed\") {\n\t\t\t\tsetSendingMessage({ sessionId, messageId: null })\n\t\t\t}\n\t\t}\n\n\t\twindow.addEventListener(\"message\", handleMessage)\n\t\treturn () => window.removeEventListener(\"message\", handleMessage)\n\t}, [sessionId, updateStatus, removeFromQueue, setSendingMessage])\n\n\t// Auto-process queue when it changes and nothing is currently sending\n\tuseEffect(() => {\n\t\tif (!sessionId) return\n\t\tif (sendingMessageId) return\n\n\t\tconst queuedMsg = queue.find((msg) => msg.status === \"queued\")\n\t\tif (queuedMsg) {\n\t\t\tsendNextMessage(queuedMsg.id, queuedMsg.content)\n\t\t}\n\t}, [sessionId, queue, sendingMessageId, sendNextMessage])\n}\n",
    "export interface RelativeTimeLabels {\n\tjustNow: string\n\tminuteAgo: string\n\tminutesAgo: (count: number) => string\n\thourAgo: string\n\thoursAgo: (count: number) => string\n\tdayAgo: string\n\tdaysAgo: (count: number) => string\n\tweekAgo: string\n\tweeksAgo: (count: number) => string\n}\n\n/**\n * Formats a timestamp as a human-readable relative time string\n * @param timestamp - Unix timestamp in milliseconds\n * @param labels - Localized labels for time units\n * @returns Formatted relative time string, or empty string if timestamp is invalid\n */\nexport function formatRelativeTime(timestamp: number, labels: RelativeTimeLabels): string {\n\tif (!timestamp || isNaN(timestamp)) {\n\t\treturn \"\"\n\t}\n\n\tconst now = Date.now()\n\tconst diff = now - timestamp\n\tconst seconds = Math.floor(diff / 1000)\n\tconst minutes = Math.floor(seconds / 60)\n\tconst hours = Math.floor(minutes / 60)\n\tconst days = Math.floor(hours / 24)\n\n\tif (days > 7) {\n\t\tconst weeks = Math.floor(days / 7)\n\t\treturn weeks === 1 ? labels.weekAgo : labels.weeksAgo(weeks)\n\t}\n\tif (days > 0) {\n\t\treturn days === 1 ? labels.dayAgo : labels.daysAgo(days)\n\t}\n\tif (hours > 0) {\n\t\treturn hours === 1 ? labels.hourAgo : labels.hoursAgo(hours)\n\t}\n\tif (minutes > 0) {\n\t\treturn minutes === 1 ? labels.minuteAgo : labels.minutesAgo(minutes)\n\t}\n\treturn labels.justNow\n}\n\n/**\n * Creates RelativeTimeLabels from an i18next translation function\n */\nexport function createRelativeTimeLabels(t: (key: string, options?: { count: number }) => string): RelativeTimeLabels {\n\treturn {\n\t\tjustNow: t(\"time.justNow\"),\n\t\tminuteAgo: t(\"time.minuteAgo\"),\n\t\tminutesAgo: (count: number) => t(\"time.minutesAgo\", { count }),\n\t\thourAgo: t(\"time.hourAgo\"),\n\t\thoursAgo: (count: number) => t(\"time.hoursAgo\", { count }),\n\t\tdayAgo: t(\"time.dayAgo\"),\n\t\tdaysAgo: (count: number) => t(\"time.daysAgo\", { count }),\n\t\tweekAgo: t(\"time.weekAgo\"),\n\t\tweeksAgo: (count: number) => t(\"time.weeksAgo\", { count }),\n\t}\n}\n",
    "import React, { useMemo, useState } from \"react\"\nimport { useAtom, useAtomValue, useSetAtom } from \"jotai\"\nimport { useTranslation } from \"react-i18next\"\nimport {\n\tmergedSessionsAtom,\n\tselectedSessionIdAtom,\n\tisRefreshingRemoteSessionsAtom,\n\tpendingSessionAtom,\n\ttype AgentSession,\n} from \"../state/atoms/sessions\"\nimport { sessionMachineUiStateAtom } from \"../state/atoms/stateMachine\"\nimport { vscode } from \"../utils/vscode\"\nimport { formatRelativeTime, createRelativeTimeLabels } from \"../utils/timeUtils\"\nimport { Plus, Loader2, RefreshCw, GitBranch, Folder, Share2 } from \"lucide-react\"\n\nexport function SessionSidebar() {\n\tconst { t } = useTranslation(\"agentManager\")\n\tconst sessions = useAtomValue(mergedSessionsAtom)\n\tconst pendingSession = useAtomValue(pendingSessionAtom)\n\tconst [selectedId, setSelectedId] = useAtom(selectedSessionIdAtom)\n\tconst isRefreshing = useAtomValue(isRefreshingRemoteSessionsAtom)\n\tconst setIsRefreshing = useSetAtom(isRefreshingRemoteSessionsAtom)\n\tconst machineUiState = useAtomValue(sessionMachineUiStateAtom)\n\n\tconst handleNewSession = () => {\n\t\tsetSelectedId(null)\n\t}\n\n\tconst handleSelectSession = (id: string) => {\n\t\tsetSelectedId(id)\n\t\tvscode.postMessage({ type: \"agentManager.selectSession\", sessionId: id })\n\t}\n\n\tconst handleRefresh = () => {\n\t\tif (isRefreshing) return // Prevent multiple clicks while loading\n\t\tsetIsRefreshing(true)\n\t\tvscode.postMessage({ type: \"agentManager.refreshRemoteSessions\" })\n\t}\n\n\tconst isNewAgentSelected = selectedId === null && !pendingSession\n\n\treturn (\n\t\t<div className=\"am-sidebar\">\n\t\t\t<div className=\"am-sidebar-header\">\n\t\t\t\t<span>{t(\"sidebar.title\")}</span>\n\t\t\t</div>\n\n\t\t\t<div\n\t\t\t\tclassName={`am-new-agent-item ${isNewAgentSelected ? \"am-selected\" : \"\"}`}\n\t\t\t\tonClick={handleNewSession}\n\t\t\t\trole=\"button\"\n\t\t\t\ttabIndex={0}\n\t\t\t\tonKeyDown={(e) => e.key === \"Enter\" && handleNewSession()}>\n\t\t\t\t<Plus size={16} />\n\t\t\t\t<span>{t(\"sidebar.newAgent\")}</span>\n\t\t\t</div>\n\n\t\t\t<div className=\"am-sidebar-section-header\">\n\t\t\t\t<span>{t(\"sidebar.sessionsSection\")}</span>\n\t\t\t\t<button\n\t\t\t\t\tclassName=\"am-icon-btn\"\n\t\t\t\t\tonClick={handleRefresh}\n\t\t\t\t\tdisabled={isRefreshing}\n\t\t\t\t\ttitle={t(\"sidebar.refresh\")}>\n\t\t\t\t\t{isRefreshing ? <Loader2 size={14} className=\"am-spinning\" /> : <RefreshCw size={14} />}\n\t\t\t\t</button>\n\t\t\t</div>\n\n\t\t\t<div className=\"am-session-list\">\n\t\t\t\t{/* Show pending session at the top */}\n\t\t\t\t{pendingSession && (\n\t\t\t\t\t<PendingSessionItem\n\t\t\t\t\t\tpendingSession={pendingSession}\n\t\t\t\t\t\tisSelected={selectedId === null}\n\t\t\t\t\t\tonSelect={() => setSelectedId(null)}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\n\t\t\t\t{sessions.length === 0 && !pendingSession ? (\n\t\t\t\t\t<div className=\"am-no-sessions\">\n\t\t\t\t\t\t<p>{t(\"sidebar.emptyState\")}</p>\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\tsessions.map((session) => (\n\t\t\t\t\t\t<SessionItem\n\t\t\t\t\t\t\tkey={session.sessionId}\n\t\t\t\t\t\t\tsession={session}\n\t\t\t\t\t\t\tisSelected={selectedId === session.sessionId}\n\t\t\t\t\t\t\tuiState={machineUiState[session.sessionId]}\n\t\t\t\t\t\t\tonSelect={() => handleSelectSession(session.sessionId)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t))\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nfunction PendingSessionItem({\n\tpendingSession,\n\tisSelected,\n\tonSelect,\n}: {\n\tpendingSession: { label: string; startTime: number }\n\tisSelected: boolean\n\tonSelect: () => void\n}) {\n\tconst { t } = useTranslation(\"agentManager\")\n\n\treturn (\n\t\t<div className={`am-session-item pending ${isSelected ? \"am-selected\" : \"\"}`} onClick={onSelect}>\n\t\t\t<div className=\"am-status-icon creating\" title={t(\"status.creating\")}>\n\t\t\t\t<Loader2 size={14} className=\"am-spinning\" />\n\t\t\t</div>\n\t\t\t<div className=\"am-session-content\">\n\t\t\t\t<div className=\"am-session-label\">{pendingSession.label}</div>\n\t\t\t\t<div className=\"am-session-meta\">{t(\"status.creating\")}</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nfunction SessionItem({\n\tsession,\n\tisSelected,\n\tuiState,\n\tonSelect,\n}: {\n\tsession: AgentSession\n\tisSelected: boolean\n\tuiState: { showSpinner: boolean; isActive: boolean } | undefined\n\tonSelect: () => void\n}) {\n\tconst { t } = useTranslation(\"agentManager\")\n\tconst timeLabels = useMemo(() => createRelativeTimeLabels(t), [t])\n\tconst [showShareConfirm, setShowShareConfirm] = useState(false)\n\tconst [isHovered, setIsHovered] = useState(false)\n\n\tconst showSpinner = uiState?.showSpinner ?? false\n\tconst isActive = uiState?.isActive ?? false\n\tconst isWorktree = session.parallelMode?.enabled\n\tconst branchName = session.parallelMode?.branch\n\tconst isCompleted = session.status === \"done\"\n\n\tconst handleShareClick = (e: React.MouseEvent) => {\n\t\te.stopPropagation()\n\t\tsetShowShareConfirm(true)\n\t}\n\n\tconst handleShareConfirm = (e: React.MouseEvent) => {\n\t\te.stopPropagation()\n\t\tsetShowShareConfirm(false)\n\t\tsetIsHovered(false)\n\t\tvscode.postMessage({ type: \"agentManager.sessionShare\", sessionId: session.sessionId })\n\t}\n\n\tconst handleShareCancel = (e: React.MouseEvent) => {\n\t\te.stopPropagation()\n\t\tsetShowShareConfirm(false)\n\t\tsetIsHovered(false)\n\t}\n\n\treturn (\n\t\t<div\n\t\t\tclassName={`am-session-item ${isSelected ? \"am-selected\" : \"\"}`}\n\t\t\tonClick={onSelect}\n\t\t\tonMouseEnter={() => setIsHovered(true)}\n\t\t\tonMouseLeave={() => !showShareConfirm && setIsHovered(false)}>\n\t\t\t{session.status === \"creating\" && (\n\t\t\t\t<div className=\"am-status-icon creating\" title={t(\"status.creating\")}>\n\t\t\t\t\t<Loader2 size={14} className=\"am-spinning\" />\n\t\t\t\t</div>\n\t\t\t)}\n\t\t\t{showSpinner && (\n\t\t\t\t<div className=\"am-status-icon running\" title={t(\"status.running\")}>\n\t\t\t\t\t<Loader2 size={14} className=\"am-spinning\" />\n\t\t\t\t</div>\n\t\t\t)}\n\t\t\t<div className=\"am-session-content\">\n\t\t\t\t<div className=\"am-session-label\">{session.label}</div>\n\t\t\t\t<div className=\"am-session-meta\">\n\t\t\t\t\t{session.status === \"creating\" && isActive\n\t\t\t\t\t\t? t(\"status.creating\")\n\t\t\t\t\t\t: formatRelativeTime(session.startTime, timeLabels)}\n\t\t\t\t\t{isWorktree && (\n\t\t\t\t\t\t<span className=\"am-worktree-indicator\" title={branchName || t(\"sidebar.worktree\")}>\n\t\t\t\t\t\t\t<GitBranch size={10} />\n\t\t\t\t\t\t\t{branchName ? (\n\t\t\t\t\t\t\t\t<span className=\"am-branch-name\">\n\t\t\t\t\t\t\t\t\t{branchName.length > 20 ? branchName.slice(0, 20) + \"...\" : branchName}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<span>{t(\"sidebar.worktree\")}</span>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t)}\n\t\t\t\t\t{!isWorktree && (\n\t\t\t\t\t\t<span className=\"am-workspace-indicator\" title={t(\"sidebar.local\")}>\n\t\t\t\t\t\t\t<Folder size={10} />\n\t\t\t\t\t\t</span>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t{isWorktree && isCompleted && <div className=\"am-ready-to-merge\">{t(\"sidebar.readyToMerge\")}</div>}\n\t\t\t</div>\n\t\t\t{(isHovered || showShareConfirm) && (\n\t\t\t\t<button\n\t\t\t\t\tclassName=\"w-5 h-5 border-none bg-transparent rounded-[3px] cursor-pointer flex items-center justify-center -mt-0.5 hover:bg-vscode-toolbar-hoverBackground\"\n\t\t\t\t\tonClick={handleShareClick}\n\t\t\t\t\ttitle={t(\"sidebar.shareSession\")}\n\t\t\t\t\taria-label={t(\"sidebar.shareSession\")}>\n\t\t\t\t\t<Share2 size={14} />\n\t\t\t\t</button>\n\t\t\t)}\n\t\t\t{showShareConfirm && (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"absolute top-full left-2 right-2 mt-1 p-3 bg-vscode-dropdown-background border border-vscode-dropdown-border rounded z-[100] shadow-[0_4px_12px_rgba(0,0,0,0.3)]\"\n\t\t\t\t\tonClick={(e) => e.stopPropagation()}>\n\t\t\t\t\t<div className=\"text-sm mb-2\">{t(\"sidebar.shareConfirmMessage\")}</div>\n\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName=\"px-3 py-1 rounded-sm text-xs cursor-pointer border border-transparent transition-colors duration-150 bg-vscode-button-background text-vscode-button-foreground hover:bg-vscode-button-hoverBackground\"\n\t\t\t\t\t\t\tonClick={handleShareConfirm}>\n\t\t\t\t\t\t\t{t(\"sidebar.shareConfirmYes\")}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName=\"px-3 py-1 rounded-sm text-xs cursor-pointer border border-transparent transition-colors duration-150 bg-vscode-button-secondaryBackground text-vscode-button-secondaryForeground hover:bg-vscode-button-secondaryHoverBackground\"\n\t\t\t\t\t\t\tonClick={handleShareCancel}>\n\t\t\t\t\t\t\t{t(\"sidebar.shareConfirmNo\")}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t)\n}\n",
    "import React from \"react\"\nimport ReactMarkdown from \"react-markdown\"\nimport remarkGfm from \"remark-gfm\"\n\ninterface SimpleMarkdownProps {\n\tcontent: string\n}\n\nexport const SimpleMarkdown: React.FC<SimpleMarkdownProps> = ({ content }) => {\n\treturn (\n\t\t<div className=\"am-markdown-content\">\n\t\t\t<ReactMarkdown remarkPlugins={[remarkGfm]}>{content}</ReactMarkdown>\n\t\t</div>\n\t)\n}\n",
    "import React from \"react\"\nimport { useTranslation } from \"react-i18next\"\nimport { ClipboardCopy } from \"lucide-react\"\n\nimport { StandardTooltip } from \"../../../components/ui\"\nimport type { SuggestionItem } from \"@roo-code/types\"\n\ninterface FollowUpSuggestionsProps {\n\tsuggestions: SuggestionItem[]\n\tonSuggestionClick: (suggestion: SuggestionItem) => void\n\tonCopyToInput?: (suggestion: SuggestionItem) => void\n}\n\n/**\n * Displays clickable suggestion buttons for follow-up questions in the agent manager.\n * Simplified version of the main sidebar's FollowUpSuggest component without auto-approval features.\n */\nexport function FollowUpSuggestions({ suggestions, onSuggestionClick, onCopyToInput }: FollowUpSuggestionsProps) {\n\tconst { t } = useTranslation(\"agentManager\")\n\n\tif (!suggestions?.length) {\n\t\treturn null\n\t}\n\n\treturn (\n\t\t<div className=\"am-followup-suggestions\">\n\t\t\t{suggestions.map((suggestion, index) => (\n\t\t\t\t<div key={`${suggestion.answer}-${index}`} className=\"am-followup-suggestion-wrapper\">\n\t\t\t\t\t<button\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tonClick={() => onSuggestionClick(suggestion)}\n\t\t\t\t\t\tclassName=\"am-followup-suggestion-btn\"\n\t\t\t\t\t\taria-label={suggestion.answer}>\n\t\t\t\t\t\t{suggestion.answer}\n\t\t\t\t\t</button>\n\t\t\t\t\t{onCopyToInput && (\n\t\t\t\t\t\t<StandardTooltip content={t(\"chat:followUpSuggest.copyToInput\")}>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclassName=\"am-followup-copy-btn\"\n\t\t\t\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t\t\t\te.stopPropagation()\n\t\t\t\t\t\t\t\t\tonCopyToInput(suggestion)\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\taria-label={t(\"chat:followUpSuggest.copyToInput\")}>\n\t\t\t\t\t\t\t\t<ClipboardCopy size={16} />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</StandardTooltip>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t))}\n\t\t</div>\n\t)\n}\n",
    "import { memo, useState, useMemo } from \"react\"\nimport { ChevronDown, Copy, Check, Loader2 } from \"lucide-react\"\nimport { useTranslation } from \"react-i18next\"\nimport { COMMAND_OUTPUT_STRING } from \"@roo/combineCommandSequences\"\nimport { cn } from \"../../../lib/utils\"\n\ntype CommandStatus = \"pending\" | \"running\" | \"success\" | \"error\"\n\ninterface CommandExecutionBlockProps {\n\ttext: string\n\tisRunning?: boolean\n\tisLast?: boolean\n\texitCode?: number\n\tterminalStatus?: string\n}\n\n/**\n * Parses the combined command+output text into separate parts.\n * The format is: \"command\\nOutput:\\noutput_text\"\n */\nfunction parseCommandAndOutput(text: string | undefined): { command: string; output: string } {\n\tif (!text) {\n\t\treturn { command: \"\", output: \"\" }\n\t}\n\n\tconst index = text.indexOf(COMMAND_OUTPUT_STRING)\n\n\tif (index === -1) {\n\t\treturn { command: text, output: \"\" }\n\t}\n\n\tlet output = text.slice(index + COMMAND_OUTPUT_STRING.length)\n\n\t// `combineCommandSequences` adds \"\\nOutput:\" before output; real output often starts with a newline.\n\toutput = output.replace(/^\\n/, \"\")\n\n\t// Clean up output - remove leading \"command_output\" lines that may appear from message parsing\n\tconst lines = output.split(\"\\n\")\n\tconst cleanedLines = lines.filter((line) => line.trim() !== \"command_output\")\n\toutput = cleanedLines.join(\"\\n\").replace(/\\n+$/, \"\")\n\n\treturn {\n\t\tcommand: text.slice(0, index).trim(),\n\t\toutput,\n\t}\n}\n\n/**\n * Strip terminal escape sequences and non-printable control characters.\n * This prevents \"blank\" outputs caused by ANSI control codes.\n */\nfunction sanitizeOutput(raw: string): string {\n\tif (!raw) return \"\"\n\n\t// OSC: ESC ] ... BEL  OR  ESC ] ... ESC \\\n\t// eslint-disable-next-line no-control-regex\n\tconst withoutOsc = raw.replace(/\\u001B\\][^\\u0007]*(?:\\u0007|\\u001B\\\\)/g, \"\")\n\t// CSI: ESC [ ... command\n\t// eslint-disable-next-line no-control-regex\n\tconst withoutCsi = withoutOsc.replace(/\\u001B\\[[0-?]*[ -/]*[@-~]/g, \"\")\n\t// Other stray ESC sequences\n\t// eslint-disable-next-line no-control-regex\n\tconst withoutEsc = withoutCsi.replace(/\\u001B./g, \"\")\n\n\t// Remove control chars except \\t, \\n, \\r\n\t// eslint-disable-next-line no-control-regex\n\treturn withoutEsc.replace(/[\\u0000-\\u0008\\u000B\\u000C\\u000E-\\u001F\\u007F]/g, \"\")\n}\n\nexport const CommandExecutionBlock = memo(\n\t({ text, isRunning = false, isLast = false, exitCode, terminalStatus }: CommandExecutionBlockProps) => {\n\t\tconst { t } = useTranslation(\"agentManager\")\n\t\tconst { command, output: rawOutput } = useMemo(() => parseCommandAndOutput(text), [text])\n\t\tconst [isExpanded, setIsExpanded] = useState(true)\n\t\tconst [copied, setCopied] = useState(false)\n\n\t\tconst output = useMemo(() => sanitizeOutput(rawOutput), [rawOutput])\n\t\tconst hasOutput = useMemo(() => /\\S/.test(output), [output])\n\t\tconst hasOutputMarker = useMemo(() => text.indexOf(COMMAND_OUTPUT_STRING) !== -1, [text])\n\t\tconst isCompleted = exitCode !== undefined || terminalStatus === \"timeout\" || terminalStatus === \"exited\"\n\n\t\t// Determine status - deterministic based on exit code\n\t\tconst status: CommandStatus = useMemo(() => {\n\t\t\t// Running: has output marker but no output yet, only for the most recent command\n\t\t\tif (!isCompleted && (isRunning || (hasOutputMarker && isLast)) && !hasOutput) {\n\t\t\t\treturn \"running\"\n\t\t\t}\n\t\t\t// Error: timeout or non-zero exit code\n\t\t\tif (terminalStatus === \"timeout\" || (exitCode !== undefined && exitCode !== 0)) {\n\t\t\t\treturn \"error\"\n\t\t\t}\n\t\t\t// Success: zero exit code, has output, or has output marker (executed but no visible output)\n\t\t\tif (exitCode === 0 || hasOutput || hasOutputMarker) {\n\t\t\t\treturn \"success\"\n\t\t\t}\n\t\t\t// Pending: waiting for approval/execution\n\t\t\treturn \"pending\"\n\t\t}, [isCompleted, isRunning, hasOutputMarker, isLast, hasOutput, terminalStatus, exitCode])\n\n\t\tconst isError = status === \"error\"\n\n\t\tconst handleCopy = async () => {\n\t\t\ttry {\n\t\t\t\tawait navigator.clipboard.writeText(command)\n\t\t\t\tsetCopied(true)\n\t\t\t\tsetTimeout(() => setCopied(false), 2000)\n\t\t\t} catch {\n\t\t\t\t// Clipboard API may fail in some contexts\n\t\t\t}\n\t\t}\n\n\t\treturn (\n\t\t\t<div className=\"bg-vscode-editor-background border border-vscode-panel-border rounded-sm font-mono text-sm\">\n\t\t\t\t{/* Header with status and command */}\n\t\t\t\t<div className=\"flex items-center justify-between gap-2 px-2 py-1.5\">\n\t\t\t\t\t<div className=\"flex items-center gap-2 min-w-0 flex-1\">\n\t\t\t\t\t\t<StatusIndicator status={status} />\n\t\t\t\t\t\t<pre className=\"overflow-x-auto whitespace-pre m-0 p-0 flex-1 min-w-0\">{command}</pre>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"flex items-center gap-1 flex-shrink-0\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonClick={handleCopy}\n\t\t\t\t\t\t\tclassName=\"p-1 text-vscode-descriptionForeground hover:text-vscode-foreground transition-colors rounded hover:bg-vscode-toolbar-hoverBackground\"\n\t\t\t\t\t\t\ttitle={t(\"messages.copyCommand\")}>\n\t\t\t\t\t\t\t{copied ? <Check size={14} /> : <Copy size={14} />}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{hasOutput && (\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tonClick={() => setIsExpanded(!isExpanded)}\n\t\t\t\t\t\t\t\tclassName=\"p-1 text-vscode-descriptionForeground hover:text-vscode-foreground transition-colors rounded hover:bg-vscode-toolbar-hoverBackground\"\n\t\t\t\t\t\t\t\ttitle={isExpanded ? t(\"messages.collapseOutput\") : t(\"messages.expandOutput\")}>\n\t\t\t\t\t\t\t\t<ChevronDown\n\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\"size-4 transition-transform duration-200\",\n\t\t\t\t\t\t\t\t\t\tisExpanded && \"rotate-180\",\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Output */}\n\t\t\t\t{hasOutput && (\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\"overflow-hidden transition-all duration-200 border-t border-vscode-panel-border\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"max-h-0 border-t-0\": !isExpanded,\n\t\t\t\t\t\t\t\t\"max-h-[500px] overflow-y-auto\": isExpanded,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)}>\n\t\t\t\t\t\t<div className=\"p-2 bg-vscode-editor-background\">\n\t\t\t\t\t\t\t<pre\n\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\"overflow-x-auto whitespace-pre m-0 p-0 text-xs\",\n\t\t\t\t\t\t\t\t\tisError ? \"text-red-400\" : \"text-vscode-descriptionForeground\",\n\t\t\t\t\t\t\t\t)}>\n\t\t\t\t\t\t\t\t{output}\n\t\t\t\t\t\t\t</pre>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t)\n\t},\n)\n\nCommandExecutionBlock.displayName = \"CommandExecutionBlock\"\n\n/**\n * Status indicator dot/spinner\n */\nfunction StatusIndicator({ status }: { status: CommandStatus }) {\n\tswitch (status) {\n\t\tcase \"pending\":\n\t\t\treturn <div className=\"size-2 rounded-full bg-yellow-500/70 flex-shrink-0\" />\n\t\tcase \"running\":\n\t\t\treturn <Loader2 size={10} className=\"animate-spin text-blue-400 flex-shrink-0\" />\n\t\tcase \"success\":\n\t\t\treturn <div className=\"size-2 rounded-full bg-green-500 flex-shrink-0\" />\n\t\tcase \"error\":\n\t\t\treturn <div className=\"size-2 rounded-full bg-red-500 flex-shrink-0\" />\n\t}\n}\n",
    "import React, { useEffect, useRef, useCallback, useMemo } from \"react\"\nimport { useAtomValue, useSetAtom } from \"jotai\"\nimport { useTranslation } from \"react-i18next\"\nimport { Virtuoso, VirtuosoHandle } from \"react-virtuoso\"\nimport { sessionMessagesAtomFamily } from \"../state/atoms/messages\"\nimport { sessionInputAtomFamily } from \"../state/atoms/sessions\"\nimport {\n\tsessionMessageQueueAtomFamily,\n\tsessionSendingMessageIdAtomFamily,\n\tremoveFromQueueAtom,\n\tretryFailedMessageAtom,\n} from \"../state/atoms/messageQueue\"\nimport type { QueuedMessage } from \"../state/atoms/messageQueue\"\nimport type { ClineMessage, SuggestionItem, FollowUpData } from \"@roo-code/types\"\nimport { safeJsonParse } from \"@roo/safeJsonParse\"\nimport { combineCommandSequences } from \"@roo/combineCommandSequences\"\nimport { SimpleMarkdown } from \"./SimpleMarkdown\"\nimport { FollowUpSuggestions } from \"./FollowUpSuggestions\"\nimport { CommandExecutionBlock } from \"./CommandExecutionBlock\"\nimport { vscode } from \"../utils/vscode\"\nimport {\n\tMessageCircle,\n\tMessageCircleQuestion,\n\tArrowRightLeft,\n\tTerminalSquare,\n\tCheckCircle2,\n\tAlertCircle,\n\tUser,\n\tClock,\n\tLoader,\n} from \"lucide-react\"\nimport { cn } from \"../../../lib/utils\"\n\ninterface MessageListProps {\n\tsessionId: string\n}\n\n// Parse exit code from various formats (number, string, etc.)\nfunction parseExitCode(raw: unknown): number | undefined {\n\tif (typeof raw === \"number\") return raw\n\tif (typeof raw === \"string\" && raw.trim() && !Number.isNaN(Number(raw))) return Number(raw)\n\treturn undefined\n}\n\n// Extract execution metadata from command output message\nfunction extractCommandMetadata(msg: ClineMessage): { exitCode?: number; status?: string; isRunning?: boolean } | null {\n\tconst metadata = msg.metadata as Record<string, unknown> | undefined\n\tif (!metadata) return null\n\n\treturn {\n\t\texitCode: parseExitCode(metadata.exitCode),\n\t\tstatus: typeof metadata.status === \"string\" ? metadata.status : undefined,\n\t\tisRunning: msg.partial ?? false,\n\t}\n}\n\n/**\n * Displays messages for a session from Jotai state.\n */\nexport function MessageList({ sessionId }: MessageListProps) {\n\tconst { t } = useTranslation(\"agentManager\")\n\tconst messages = useAtomValue(sessionMessagesAtomFamily(sessionId))\n\tconst queue = useAtomValue(sessionMessageQueueAtomFamily(sessionId))\n\tconst sendingMessageId = useAtomValue(sessionSendingMessageIdAtomFamily(sessionId))\n\tconst setInputValue = useSetAtom(sessionInputAtomFamily(sessionId))\n\tconst retryFailedMessage = useSetAtom(retryFailedMessageAtom)\n\tconst removeFromQueue = useSetAtom(removeFromQueueAtom)\n\tconst virtuosoRef = useRef<VirtuosoHandle>(null)\n\n\t// Combine command and command_output messages into single entries\n\tconst combinedMessages = useMemo(() => combineCommandSequences(messages), [messages])\n\n\tconst commandExecutionByTs = useMemo(() => {\n\t\tconst info = new Map<number, { exitCode?: number; status?: string; isRunning?: boolean }>()\n\n\t\tfor (let i = 0; i < messages.length; i++) {\n\t\t\tconst msg = messages[i]\n\t\t\tif (msg.type !== \"ask\" || msg.ask !== \"command\") continue\n\n\t\t\tlet data: ReturnType<typeof extractCommandMetadata> = null\n\n\t\t\t// Find output messages following this command\n\t\t\tfor (let j = i + 1; j < messages.length; j++) {\n\t\t\t\tconst next = messages[j]\n\t\t\t\tif (next.type === \"ask\" && next.ask === \"command\") break\n\t\t\t\tif (next.ask !== \"command_output\" && next.say !== \"command_output\") continue\n\n\t\t\t\tdata = extractCommandMetadata(next)\n\t\t\t}\n\n\t\t\tif (data) info.set(msg.ts, data)\n\t\t}\n\n\t\treturn info\n\t}, [messages])\n\n\t// Auto-scroll to bottom when new messages arrive using Virtuoso API\n\tuseEffect(() => {\n\t\tif (combinedMessages.length > 0) {\n\t\t\tvirtuosoRef.current?.scrollToIndex({\n\t\t\t\tindex: combinedMessages.length - 1,\n\t\t\t\tbehavior: \"smooth\",\n\t\t\t})\n\t\t}\n\t}, [combinedMessages.length])\n\n\tconst handleSuggestionClick = useCallback(\n\t\t(suggestion: SuggestionItem) => {\n\t\t\tvscode.postMessage({\n\t\t\t\ttype: \"agentManager.sendMessage\",\n\t\t\t\tsessionId,\n\t\t\t\tcontent: suggestion.answer,\n\t\t\t})\n\t\t},\n\t\t[sessionId],\n\t)\n\n\tconst handleCopyToInput = useCallback(\n\t\t(suggestion: SuggestionItem) => {\n\t\t\tsetInputValue((current) => (current !== \"\" ? `${current} \\n${suggestion.answer}` : suggestion.answer))\n\t\t},\n\t\t[setInputValue],\n\t)\n\n\tconst handleRetryMessage = useCallback(\n\t\t(sessionId: string, messageId: string) => {\n\t\t\tretryFailedMessage({ sessionId, messageId })\n\t\t},\n\t\t[retryFailedMessage],\n\t)\n\n\tconst handleDiscardMessage = useCallback(\n\t\t(sessionId: string, messageId: string) => {\n\t\t\tremoveFromQueue({ sessionId, messageId })\n\t\t},\n\t\t[removeFromQueue],\n\t)\n\n\t// Combine messages and queued messages for virtualization\n\tconst allItems = useMemo(() => {\n\t\treturn [...combinedMessages, ...queue.map((q) => ({ type: \"queued\" as const, data: q }))]\n\t}, [combinedMessages, queue])\n\n\t// Item content renderer for Virtuoso\n\tconst itemContent = useCallback(\n\t\t(index: number, item: ClineMessage | { type: \"queued\"; data: QueuedMessage }) => {\n\t\t\t// Check if this is a queued message\n\t\t\tif (\"type\" in item && item.type === \"queued\") {\n\t\t\t\tconst queuedMsg = item.data\n\t\t\t\treturn (\n\t\t\t\t\t<QueuedMessageItem\n\t\t\t\t\t\tkey={`queued-${queuedMsg.id}`}\n\t\t\t\t\t\tqueuedMessage={queuedMsg}\n\t\t\t\t\t\tisSending={sendingMessageId === queuedMsg.id}\n\t\t\t\t\t\tonRetry={handleRetryMessage}\n\t\t\t\t\t\tonDiscard={handleDiscardMessage}\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t}\n\n\t\t\t// Regular message\n\t\t\tconst msg = item as ClineMessage\n\t\t\t// isLastCombinedMessage: true for the last regular message, excluding queued user messages\n\t\t\tconst isLastCombinedMessage = index === combinedMessages.length - 1\n\t\t\treturn (\n\t\t\t\t<MessageItem\n\t\t\t\t\tkey={msg.ts || index}\n\t\t\t\t\tmessage={msg}\n\t\t\t\t\tisLast={isLastCombinedMessage}\n\t\t\t\t\tcommandExecutionByTs={commandExecutionByTs}\n\t\t\t\t\tonSuggestionClick={handleSuggestionClick}\n\t\t\t\t\tonCopyToInput={handleCopyToInput}\n\t\t\t\t/>\n\t\t\t)\n\t\t},\n\t\t[\n\t\t\tcombinedMessages.length,\n\t\t\tcommandExecutionByTs,\n\t\t\thandleSuggestionClick,\n\t\t\thandleCopyToInput,\n\t\t\tsendingMessageId,\n\t\t\thandleRetryMessage,\n\t\t\thandleDiscardMessage,\n\t\t],\n\t)\n\n\tif (messages.length === 0 && queue.length === 0) {\n\t\treturn (\n\t\t\t<div className=\"am-messages-empty\">\n\t\t\t\t<MessageCircle className=\"w-12 h-12 mx-auto mb-4 opacity-20\" />\n\t\t\t\t<p>{t(\"messages.waiting\")}</p>\n\t\t\t</div>\n\t\t)\n\t}\n\n\treturn (\n\t\t<div className=\"am-messages-container\">\n\t\t\t<Virtuoso\n\t\t\t\tref={virtuosoRef}\n\t\t\t\tdata={allItems}\n\t\t\t\titemContent={itemContent}\n\t\t\t\tfollowOutput=\"smooth\"\n\t\t\t\tincreaseViewportBy={{ top: 400, bottom: 400 }}\n\t\t\t\tclassName=\"am-messages-list\"\n\t\t\t/>\n\t\t</div>\n\t)\n}\n\ninterface FollowUpMetadata {\n\tquestion?: string\n\tsuggest?: SuggestionItem[]\n}\n\nfunction extractFollowUpData(message: ClineMessage): { question: string; suggestions?: SuggestionItem[] } | null {\n\tconst messageText = message.text || (message as { content?: string }).content || \"\"\n\tconst metadata = (message.metadata as FollowUpMetadata | undefined) ?? {}\n\tconst parsedData = safeJsonParse<FollowUpData>(messageText)\n\n\tconst question = metadata.question || parsedData?.question || messageText\n\tconst suggestions = metadata.suggest || parsedData?.suggest\n\n\tif (!question) return null\n\treturn { question, suggestions }\n}\n\ninterface MessageItemProps {\n\tmessage: ClineMessage\n\tisLast: boolean\n\tcommandExecutionByTs: Map<number, { exitCode?: number; status?: string; isRunning?: boolean }>\n\tonSuggestionClick?: (suggestion: SuggestionItem) => void\n\tonCopyToInput?: (suggestion: SuggestionItem) => void\n}\n\nfunction MessageItem({ message, isLast, commandExecutionByTs, onSuggestionClick, onCopyToInput }: MessageItemProps) {\n\tconst { t } = useTranslation(\"agentManager\")\n\n\t// --- 1. Determine Message Style & Content ---\n\t// Note: CLI JSON output uses \"content\" instead of \"text\" for message body\n\tconst messageText = message.text || (message as any).content || \"\"\n\n\tlet icon = <MessageCircle size={16} />\n\tlet title = t(\"messages.kiloSaid\")\n\tlet content: React.ReactNode = null\n\tlet extraInfo: React.ReactNode = null\n\tlet suggestions: SuggestionItem[] | undefined\n\n\t// --- SAY ---\n\tif (message.type === \"say\") {\n\t\tswitch (message.say) {\n\t\t\tcase \"api_req_started\": {\n\t\t\t\ticon = <ArrowRightLeft size={16} className=\"opacity-70\" />\n\t\t\t\ttitle = t(\"messages.apiRequest\")\n\t\t\t\tconst info = safeJsonParse<{ cost?: number }>(messageText)\n\t\t\t\tif (info?.cost !== undefined) {\n\t\t\t\t\textraInfo = <span className=\"am-message-cost\">${info.cost.toFixed(4)}</span>\n\t\t\t\t}\n\t\t\t\t// Don't show content for API req started, just header\n\t\t\t\tcontent = null\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase \"text\": {\n\t\t\t\ticon = <MessageCircle size={16} />\n\t\t\t\ttitle = t(\"messages.kiloSaid\")\n\t\t\t\tcontent = <SimpleMarkdown content={messageText} />\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase \"user_feedback\": {\n\t\t\t\ticon = <User size={16} />\n\t\t\t\ttitle = t(\"messages.youSaid\")\n\t\t\t\tcontent = <SimpleMarkdown content={messageText} />\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase \"completion_result\": {\n\t\t\t\ticon = <CheckCircle2 size={16} className=\"text-green-500\" />\n\t\t\t\ttitle = t(\"messages.taskCompleted\")\n\t\t\t\tcontent = <SimpleMarkdown content={messageText} />\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase \"error\": {\n\t\t\t\ticon = <AlertCircle size={16} className=\"text-red-500\" />\n\t\t\t\ttitle = t(\"messages.error\")\n\t\t\t\tcontent = <SimpleMarkdown content={messageText} />\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase \"api_req_finished\":\n\t\t\tcase \"checkpoint_saved\":\n\t\t\tcase \"command_output\":\n\t\t\t\treturn null // Skip internal messages (command_output is combined with command)\n\t\t\tdefault:\n\t\t\t\tcontent = <SimpleMarkdown content={messageText} />\n\t\t}\n\t}\n\n\t// --- ASK ---\n\tif (message.type === \"ask\") {\n\t\tswitch (message.ask) {\n\t\t\tcase \"followup\": {\n\t\t\t\ticon = <MessageCircleQuestion size={16} />\n\t\t\t\ttitle = t(\"messages.question\")\n\t\t\t\tconst followUpData = extractFollowUpData(message)\n\t\t\t\tsuggestions = followUpData?.suggestions\n\t\t\t\tcontent = (\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<SimpleMarkdown content={followUpData?.question || messageText} />\n\t\t\t\t\t</div>\n\t\t\t\t)\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase \"command\": {\n\t\t\t\ticon = <TerminalSquare size={16} />\n\t\t\t\ttitle = t(\"messages.command\")\n\t\t\t\tconst execInfo = commandExecutionByTs.get(message.ts)\n\t\t\t\tcontent = (\n\t\t\t\t\t<CommandExecutionBlock\n\t\t\t\t\t\ttext={messageText}\n\t\t\t\t\t\tisRunning={execInfo?.isRunning ?? message.partial}\n\t\t\t\t\t\tisLast={isLast}\n\t\t\t\t\t\texitCode={execInfo?.exitCode}\n\t\t\t\t\t\tterminalStatus={execInfo?.status}\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase \"command_output\": {\n\t\t\t\t// Skip standalone command_output - combined with command message\n\t\t\t\treturn null\n\t\t\t}\n\t\t\tcase \"tool\": {\n\t\t\t\t// Tool info can be in metadata (from CLI) or parsed from text\n\t\t\t\tconst metadata = message.metadata as { tool?: string; path?: string; todos?: unknown[] } | undefined\n\t\t\t\tconst toolInfo = metadata?.tool ? metadata : safeJsonParse<{ tool: string; path?: string }>(messageText)\n\t\t\t\t// Skip updateTodoList - it's displayed in the header via TodoListDisplay\n\t\t\t\tif (toolInfo?.tool === \"updateTodoList\") {\n\t\t\t\t\treturn null\n\t\t\t\t}\n\t\t\t\ticon = <TerminalSquare size={16} />\n\t\t\t\ttitle = t(\"messages.tool\")\n\t\t\t\t// Try to parse tool use for better display\n\t\t\t\tif (toolInfo) {\n\t\t\t\t\tconst toolDetails = toolInfo.path ? `(${toolInfo.path})` : \"\"\n\t\t\t\t\tcontent = (\n\t\t\t\t\t\t<SimpleMarkdown\n\t\t\t\t\t\t\tcontent={t(\"messages.usingTool\", { tool: toolInfo.tool, details: toolDetails })}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)\n\t\t\t\t} else {\n\t\t\t\t\tcontent = <SimpleMarkdown content={messageText} />\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tdefault:\n\t\t\t\tcontent = <SimpleMarkdown content={messageText} />\n\t\t}\n\t}\n\n\treturn (\n\t\t<div\n\t\t\tclassName={`am-message-item ${message.type === \"say\" && message.say === \"api_req_started\" ? \"am-api-req\" : \"\"}`}>\n\t\t\t<div className=\"am-message-icon\">{icon}</div>\n\t\t\t<div className=\"am-message-content-wrapper\">\n\t\t\t\t<div className=\"am-message-header\">\n\t\t\t\t\t<span className=\"am-message-author\">{title}</span>\n\t\t\t\t\t<span className=\"am-message-ts\">{new Date(message.ts).toLocaleTimeString()}</span>\n\t\t\t\t\t{extraInfo}\n\t\t\t\t</div>\n\t\t\t\t{content && <div className=\"am-message-body\">{content}</div>}\n\t\t\t\t{suggestions && suggestions.length > 0 && onSuggestionClick && (\n\t\t\t\t\t<FollowUpSuggestions\n\t\t\t\t\t\tsuggestions={suggestions}\n\t\t\t\t\t\tonSuggestionClick={onSuggestionClick}\n\t\t\t\t\t\tonCopyToInput={onCopyToInput}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\ninterface QueuedMessageItemProps {\n\tqueuedMessage: QueuedMessage\n\tisSending: boolean\n\tonRetry: (sessionId: string, messageId: string) => void\n\tonDiscard: (sessionId: string, messageId: string) => void\n}\n\nfunction QueuedMessageItem({ queuedMessage, isSending: _isSending, onRetry, onDiscard }: QueuedMessageItemProps) {\n\tconst { t } = useTranslation(\"agentManager\")\n\n\tlet icon = <Clock size={16} className=\"opacity-70\" />\n\tlet statusText = t(\"chatInput.messageSending\")\n\tlet statusColor = \"text-vscode-descriptionForeground\"\n\n\tif (queuedMessage.status === \"sending\") {\n\t\ticon = <Loader size={16} className=\"animate-spin opacity-70\" />\n\t\tstatusText = t(\"chatInput.messageSending\")\n\t\tstatusColor = \"text-vscode-descriptionForeground\"\n\t} else if (queuedMessage.status === \"failed\") {\n\t\ticon = <AlertCircle size={16} className=\"text-vscode-errorForeground\" />\n\t\tstatusText = queuedMessage.error || \"Failed to send message\"\n\t\tstatusColor = \"text-vscode-errorForeground\"\n\t} else {\n\t\ticon = <Clock size={16} className=\"opacity-70\" />\n\t\tstatusText = t(\"chatInput.messageSending\")\n\t\tstatusColor = \"text-vscode-descriptionForeground\"\n\t}\n\n\tconst handleRetry = () => {\n\t\tonRetry(queuedMessage.sessionId, queuedMessage.id)\n\t}\n\n\tconst handleDiscard = () => {\n\t\tonDiscard(queuedMessage.sessionId, queuedMessage.id)\n\t}\n\n\tconst canRetry = queuedMessage.retryCount < queuedMessage.maxRetries\n\n\treturn (\n\t\t<div className={cn(\"am-message-item\", queuedMessage.status === \"failed\" && \"opacity-75\")}>\n\t\t\t<div className=\"am-message-icon\">{icon}</div>\n\t\t\t<div className=\"am-message-content-wrapper\">\n\t\t\t\t<div className=\"am-message-header\">\n\t\t\t\t\t<span className=\"am-message-author text-vscode-descriptionForeground\">{t(\"messages.youSaid\")}</span>\n\t\t\t\t\t<span className={cn(\"am-message-ts text-xs\", statusColor)}>{statusText}</span>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"am-message-body\">\n\t\t\t\t\t<SimpleMarkdown content={queuedMessage.content} />\n\t\t\t\t</div>\n\t\t\t\t{queuedMessage.status === \"failed\" && (\n\t\t\t\t\t<div className=\"mt-2 space-y-2\">\n\t\t\t\t\t\t{queuedMessage.error && (\n\t\t\t\t\t\t\t<p className=\"text-xs text-vscode-errorForeground\">Error: {queuedMessage.error}</p>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{queuedMessage.retryCount > 0 && (\n\t\t\t\t\t\t\t<p className=\"text-xs text-vscode-descriptionForeground\">\n\t\t\t\t\t\t\t\tRetry attempt {queuedMessage.retryCount} of {queuedMessage.maxRetries}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t\t{canRetry && (\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tonClick={handleRetry}\n\t\t\t\t\t\t\t\t\tclassName=\"text-xs px-2 py-1 rounded bg-vscode-button-background hover:bg-vscode-button-hoverBackground text-vscode-button-foreground\">\n\t\t\t\t\t\t\t\t\tRetry\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tonClick={handleDiscard}\n\t\t\t\t\t\t\t\tclassName=\"text-xs px-2 py-1 rounded bg-vscode-errorBackground hover:opacity-80 text-vscode-errorForeground\">\n\t\t\t\t\t\t\t\tDiscard\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n",
    "import { cn } from \"../../../lib/utils\"\nimport { useTranslation } from \"react-i18next\"\nimport { Check, ChevronDown, ChevronUp, Circle, Loader2 } from \"lucide-react\"\nimport { useState, useRef, useEffect } from \"react\"\nimport type { TodoStats } from \"../state/atoms/todos\"\n\ninterface AgentTodoListProps {\n\tstats: TodoStats\n\tisIntegrated?: boolean\n}\n\nfunction TodoIcon({ status, size = \"sm\" }: { status: string; size?: \"sm\" | \"xs\" }) {\n\tconst iconSize = size === \"xs\" ? \"w-3 h-3\" : \"w-3.5 h-3.5\"\n\tconst checkSize = size === \"xs\" ? \"w-2 h-2\" : \"w-2.5 h-2.5\"\n\n\tswitch (status) {\n\t\tcase \"completed\":\n\t\t\treturn (\n\t\t\t\t<div className={cn(\"flex items-center justify-center rounded-full bg-green-500/20\", iconSize)}>\n\t\t\t\t\t<Check className={cn(\"text-green-400\", checkSize)} strokeWidth={3} />\n\t\t\t\t</div>\n\t\t\t)\n\t\tcase \"in_progress\":\n\t\t\treturn <Loader2 className={cn(\"text-vscode-charts-yellow animate-spin\", iconSize)} />\n\t\tdefault:\n\t\t\treturn <Circle className={cn(\"text-vscode-descriptionForeground/40\", iconSize)} strokeWidth={2} />\n\t}\n}\n\nexport function AgentTodoList({ stats, isIntegrated = false }: AgentTodoListProps) {\n\tconst { t } = useTranslation(\"chat\")\n\tconst [isExpanded, setIsExpanded] = useState(false)\n\tconst listRef = useRef<HTMLDivElement>(null)\n\n\tconst { todos, completedCount, totalCount, currentTodo, allCompleted, progressPercent } = stats\n\n\t// Auto-scroll to in-progress item when expanded\n\tuseEffect(() => {\n\t\tif (!isExpanded || !listRef.current) return\n\t\tconst inProgressIdx = todos.findIndex((t) => t.status === \"in_progress\")\n\t\tif (inProgressIdx === -1) return\n\t\tconst items = listRef.current.querySelectorAll(\"[data-todo-item]\")\n\t\tconst target = items[inProgressIdx] as HTMLElement\n\t\tif (target) {\n\t\t\ttarget.scrollIntoView({ behavior: \"smooth\", block: \"center\" })\n\t\t}\n\t}, [isExpanded, todos])\n\n\tif (totalCount <= 0) return null\n\n\treturn (\n\t\t<div\n\t\t\tclassName={cn(\n\t\t\t\t\"overflow-hidden transition-all duration-200\",\n\t\t\t\t// When integrated, parent handles outer border; just add bottom separator\n\t\t\t\tisIntegrated\n\t\t\t\t\t? \"border-b border-vscode-input-border/50\"\n\t\t\t\t\t: \"rounded-t-md border-x border-t border-vscode-input-border\",\n\t\t\t\t\"bg-vscode-input-background\",\n\t\t\t)}>\n\t\t\t{/* Header - compact single line */}\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tonClick={() => setIsExpanded(!isExpanded)}\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"w-full flex items-center gap-2 px-3 py-1.5\",\n\t\t\t\t\t\"hover:bg-vscode-list-hoverBackground/30 transition-colors\",\n\t\t\t\t\t\"focus:outline-none\",\n\t\t\t\t\t\"cursor-pointer\",\n\t\t\t\t)}>\n\t\t\t\t{/* Progress ring - smaller */}\n\t\t\t\t<div className=\"relative flex-shrink-0\">\n\t\t\t\t\t<svg className=\"w-4 h-4 -rotate-90\" viewBox=\"0 0 16 16\">\n\t\t\t\t\t\t<circle\n\t\t\t\t\t\t\tcx=\"8\"\n\t\t\t\t\t\t\tcy=\"8\"\n\t\t\t\t\t\t\tr=\"6\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\t\t\tclassName=\"text-vscode-input-border/40\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<circle\n\t\t\t\t\t\t\tcx=\"8\"\n\t\t\t\t\t\t\tcy=\"8\"\n\t\t\t\t\t\t\tr=\"6\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\t\t\tstrokeDasharray={`${progressPercent * 0.377} 100`}\n\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\"transition-all duration-300\",\n\t\t\t\t\t\t\t\tallCompleted ? \"text-green-400\" : \"text-vscode-charts-yellow\",\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t\t{allCompleted && (\n\t\t\t\t\t\t<Check className=\"absolute inset-0 m-auto w-2 h-2 text-green-400\" strokeWidth={3} />\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t\t{/* Current task text */}\n\t\t\t\t<span\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\"flex-1 text-xs truncate text-left\",\n\t\t\t\t\t\tallCompleted ? \"text-green-400\" : \"text-vscode-foreground\",\n\t\t\t\t\t)}>\n\t\t\t\t\t{allCompleted\n\t\t\t\t\t\t? t(\"todo.complete\", { total: completedCount })\n\t\t\t\t\t\t: currentTodo?.content || t(\"todo.partial\", { completed: completedCount, total: totalCount })}\n\t\t\t\t</span>\n\n\t\t\t\t{/* Counter */}\n\t\t\t\t<span className=\"flex-shrink-0 text-[10px] text-vscode-descriptionForeground/70 tabular-nums\">\n\t\t\t\t\t{completedCount}/{totalCount}\n\t\t\t\t</span>\n\n\t\t\t\t{/* Chevron */}\n\t\t\t\t{isExpanded ? (\n\t\t\t\t\t<ChevronDown className=\"w-3 h-3 text-vscode-descriptionForeground/50\" />\n\t\t\t\t) : (\n\t\t\t\t\t<ChevronUp className=\"w-3 h-3 text-vscode-descriptionForeground/50\" />\n\t\t\t\t)}\n\t\t\t</button>\n\n\t\t\t{/* Expanded list - compact */}\n\t\t\t{isExpanded && (\n\t\t\t\t<div ref={listRef} className=\"max-h-[140px] overflow-y-auto border-t border-vscode-input-border/50\">\n\t\t\t\t\t<div className=\"py-1 px-1\">\n\t\t\t\t\t\t{todos.map((todo, idx) => (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tkey={todo.id || idx}\n\t\t\t\t\t\t\t\tdata-todo-item\n\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\"flex items-center gap-2 py-0.5 px-2 rounded transition-colors\",\n\t\t\t\t\t\t\t\t\ttodo.status === \"in_progress\" && \"bg-vscode-charts-yellow/10\",\n\t\t\t\t\t\t\t\t)}>\n\t\t\t\t\t\t\t\t<TodoIcon status={todo.status} size=\"xs\" />\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\"text-xs truncate\",\n\t\t\t\t\t\t\t\t\t\ttodo.status === \"in_progress\" && \"text-vscode-charts-yellow\",\n\t\t\t\t\t\t\t\t\t\ttodo.status === \"completed\" &&\n\t\t\t\t\t\t\t\t\t\t\t\"line-through text-vscode-descriptionForeground/50\",\n\t\t\t\t\t\t\t\t\t\ttodo.status === \"pending\" && \"text-vscode-descriptionForeground\",\n\t\t\t\t\t\t\t\t\t)}>\n\t\t\t\t\t\t\t\t\t{todo.content}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t)\n}\n",
    "import React, { useState, useRef, useEffect, useMemo } from \"react\"\nimport { useAtom, useAtomValue, useSetAtom } from \"jotai\"\nimport { useTranslation } from \"react-i18next\"\nimport { vscode } from \"../utils/vscode\"\nimport { GitBranch, GitPullRequest, SendHorizontal, Square } from \"lucide-react\"\nimport { modelsConfigAtom } from \"../state/atoms/models\"\nimport DynamicTextArea from \"react-textarea-autosize\"\nimport { cn } from \"../../../lib/utils\"\nimport { StandardTooltip } from \"../../../components/ui\"\nimport { SelectDropdown, type DropdownOption } from \"../../../components/ui/select-dropdown\"\nimport { sessionInputAtomFamily } from \"../state/atoms/sessions\"\nimport { sessionTodoStatsAtomFamily } from \"../state/atoms/todos\"\nimport { AgentTodoList } from \"./AgentTodoList\"\nimport { addToQueueAtom } from \"../state/atoms/messageQueue\"\n\ninterface ChatInputProps {\n\tsessionId: string\n\tsessionLabel?: string\n\tisActive?: boolean\n\tshowCancel?: boolean\n\tshowFinishToBranch?: boolean\n\tshowCreatePR?: boolean\n\tworktreeBranchName?: string\n\tparentBranch?: string\n\tsessionStatus?: \"creating\" | \"running\" | \"done\" | \"error\" | \"stopped\"\n\tmodelId?: string // Model ID used for this session (displayed read-only)\n}\n\nexport const ChatInput: React.FC<ChatInputProps> = ({\n\tsessionId,\n\tsessionLabel,\n\tisActive = false,\n\tshowCancel = false,\n\tshowFinishToBranch = false,\n\tshowCreatePR = false,\n\tworktreeBranchName,\n\tparentBranch,\n\tsessionStatus,\n\tmodelId,\n}) => {\n\tconst { t } = useTranslation(\"agentManager\")\n\tconst [messageText, setMessageText] = useAtom(sessionInputAtomFamily(sessionId))\n\tconst todoStats = useAtomValue(sessionTodoStatsAtomFamily(sessionId))\n\tconst modelsConfig = useAtomValue(modelsConfigAtom)\n\tconst [isFocused, setIsFocused] = useState(false)\n\tconst textareaRef = useRef<HTMLTextAreaElement>(null)\n\tconst addToQueue = useSetAtom(addToQueueAtom)\n\n\t// Build model options for the disabled dropdown (consistent with NewAgentForm)\n\tconst modelOptions: DropdownOption[] = useMemo(() => {\n\t\tif (!modelsConfig) return []\n\t\treturn modelsConfig.models.map((model) => ({\n\t\t\tvalue: model.id,\n\t\t\tlabel: model.displayName || model.id,\n\t\t\tdescription: model.contextWindow ? `${Math.floor(model.contextWindow / 1000)}K context` : undefined,\n\t\t}))\n\t}, [modelsConfig])\n\n\t// Auto-focus the textarea when the session changes (user selects a different session)\n\tuseEffect(() => {\n\t\ttextareaRef.current?.focus()\n\t}, [sessionId])\n\n\tconst trimmedMessage = messageText.trim()\n\tconst isEmpty = trimmedMessage.length === 0\n\tconst isSessionCompleted = sessionStatus === \"done\" || sessionStatus === \"error\" || sessionStatus === \"stopped\"\n\n\t// Send is disabled when empty\n\t// Note: Users CAN queue multiple messages while one is sending (for running sessions)\n\t// Note: Users CAN send messages to completed sessions (to resume them)\n\tconst sendDisabled = isEmpty\n\n\tconst handleSend = () => {\n\t\tif (isEmpty) return\n\n\t\tif (isSessionCompleted) {\n\t\t\t// Resume a completed session with a new message (sent directly, not queued)\n\t\t\tvscode.postMessage({\n\t\t\t\ttype: \"agentManager.resumeSession\",\n\t\t\t\tsessionId,\n\t\t\t\tsessionLabel,\n\t\t\t\tcontent: trimmedMessage,\n\t\t\t})\n\t\t\tsetMessageText(\"\")\n\t\t} else {\n\t\t\t// For running sessions, queue the message instead of sending directly\n\t\t\tconst queuedMsg = addToQueue({ sessionId, content: trimmedMessage })\n\n\t\t\tif (queuedMsg) {\n\t\t\t\t// Notify the extension that a message has been queued\n\t\t\t\tvscode.postMessage({\n\t\t\t\t\ttype: \"agentManager.messageQueued\",\n\t\t\t\t\tsessionId,\n\t\t\t\t\tmessageId: queuedMsg.id,\n\t\t\t\t\tsessionLabel,\n\t\t\t\t\tcontent: trimmedMessage,\n\t\t\t\t})\n\n\t\t\t\tsetMessageText(\"\")\n\t\t\t}\n\t\t}\n\t}\n\n\tconst handleCancel = () => {\n\t\tvscode.postMessage({\n\t\t\ttype: \"agentManager.cancelSession\",\n\t\t\tsessionId,\n\t\t})\n\t}\n\n\tconst handleFinishToBranch = () => {\n\t\tvscode.postMessage({\n\t\t\ttype: \"agentManager.finishWorktreeSession\",\n\t\t\tsessionId,\n\t\t})\n\t}\n\n\tconst handleCreatePR = () => {\n\t\tconst branch = worktreeBranchName || \"current-branch\"\n\t\tconst targetBranch = parentBranch || \"main\"\n\n\t\tconst instructions = `The user wants to create a pull request.\n\nLocal branch: ${branch}\nTarget branch: origin/${targetBranch}\n\nFollow these steps:\n\n1. First, verify gh CLI is ready by running: gh auth status\n   - If gh is not installed, ask the user to install it: https://cli.github.com/\n   - If not authenticated, ask the user to run: gh auth login\n   - Do not proceed until gh is ready.\n\n2. Run git status to check for uncommitted changes\n\n3. Run git diff to understand what changes exist (both staged and unstaged)\n\n4. Based on the changes, prepare suggestions for the user:\n   - Propose a CLEAN branch name following conventions (e.g., feat/description, fix/description, docs/description)\n     Do NOT suggest the auto-generated local branch name \"${branch}\" - always propose a better name.\n   - Propose a descriptive commit message (if there are uncommitted changes)\n   - Propose a PR title (under 80 chars)\n   - Propose a PR description (concise summary)\n\n5. STOP and present your suggestions to the user. Ask them to confirm or edit:\n   - Branch name for the PR (your clean suggestion, not the auto-generated one)\n   - Commit message (if applicable)\n   - PR title\n   - PR description\n\n   DO NOT commit, push, or create the PR until the user explicitly confirms.\n\n6. Once the user confirms, execute in this order:\n   a. If there are uncommitted changes, commit with the confirmed message\n   b. Push to origin with the confirmed branch name:\n      git push origin ${branch}:<confirmed-branch-name>\n   c. Create the PR: gh pr create --base ${targetBranch} --head <confirmed-branch-name> --title \"<confirmed-title>\" --body \"<confirmed-description>\"\n\nIf any step fails, ask the user for help.`\n\n\t\tif (isSessionCompleted) {\n\t\t\t// Resume session with PR instructions\n\t\t\tvscode.postMessage({\n\t\t\t\ttype: \"agentManager.resumeSession\",\n\t\t\t\tsessionId,\n\t\t\t\tsessionLabel,\n\t\t\t\tcontent: instructions,\n\t\t\t})\n\t\t} else {\n\t\t\t// Queue message for running session\n\t\t\tconst queuedMsg = addToQueue({ sessionId, content: instructions })\n\t\t\tif (queuedMsg) {\n\t\t\t\tvscode.postMessage({\n\t\t\t\t\ttype: \"agentManager.messageQueued\",\n\t\t\t\t\tsessionId,\n\t\t\t\t\tmessageId: queuedMsg.id,\n\t\t\t\t\tsessionLabel,\n\t\t\t\t\tcontent: instructions,\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n\n\tconst handleKeyDown = (e: React.KeyboardEvent) => {\n\t\tif (e.key === \"Enter\" && !e.shiftKey && !e.nativeEvent.isComposing) {\n\t\t\te.preventDefault()\n\t\t\thandleSend()\n\t\t}\n\t}\n\n\tconst hasTodos = todoStats.totalCount > 0\n\n\treturn (\n\t\t<div className=\"am-chat-input-container\">\n\t\t\t{/* Unified wrapper when todos present - handles border and focus state */}\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"relative flex-1 flex flex-col min-h-0 overflow-hidden rounded\",\n\t\t\t\t\thasTodos && [\n\t\t\t\t\t\t\"border bg-vscode-input-background\",\n\t\t\t\t\t\tisFocused\n\t\t\t\t\t\t\t? \"border-vscode-focusBorder outline outline-vscode-focusBorder\"\n\t\t\t\t\t\t\t: \"border-vscode-input-border\",\n\t\t\t\t\t],\n\t\t\t\t)}>\n\t\t\t\t{/* Todo list above input */}\n\t\t\t\t{hasTodos && <AgentTodoList stats={todoStats} isIntegrated />}\n\t\t\t\t<div className={cn(\"relative\", \"flex-1\", \"flex\", \"flex-col-reverse\", \"min-h-0\", \"overflow-hidden\")}>\n\t\t\t\t\t<DynamicTextArea\n\t\t\t\t\t\tref={textareaRef}\n\t\t\t\t\t\tvalue={messageText}\n\t\t\t\t\t\tonChange={(e) => setMessageText(e.target.value)}\n\t\t\t\t\t\tonKeyDown={handleKeyDown}\n\t\t\t\t\t\tonFocus={() => setIsFocused(true)}\n\t\t\t\t\t\tonBlur={() => setIsFocused(false)}\n\t\t\t\t\t\taria-label={t(\"chatInput.ariaLabel\")}\n\t\t\t\t\t\tplaceholder={t(\"chatInput.placeholderTypeTask\")}\n\t\t\t\t\t\tminRows={3}\n\t\t\t\t\t\tmaxRows={15}\n\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\"w-full\",\n\t\t\t\t\t\t\t\"text-vscode-input-foreground\",\n\t\t\t\t\t\t\t\"font-vscode-font-family\",\n\t\t\t\t\t\t\t\"text-vscode-editor-font-size\",\n\t\t\t\t\t\t\t\"leading-vscode-editor-line-height\",\n\t\t\t\t\t\t\t\"cursor-text\",\n\t\t\t\t\t\t\t\"!pt-3 !pl-3 pr-9\",\n\t\t\t\t\t\t\t// Only show border when no todos (standalone mode)\n\t\t\t\t\t\t\t!hasTodos && [\n\t\t\t\t\t\t\t\tisFocused\n\t\t\t\t\t\t\t\t\t? \"border border-vscode-focusBorder outline outline-vscode-focusBorder\"\n\t\t\t\t\t\t\t\t\t: \"border border-vscode-input-border\",\n\t\t\t\t\t\t\t\t\"rounded\",\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"bg-vscode-input-background\",\n\t\t\t\t\t\t\t\"transition-background-color duration-150 ease-in-out\",\n\t\t\t\t\t\t\t\"will-change-background-color\",\n\t\t\t\t\t\t\t\"min-h-[90px]\",\n\t\t\t\t\t\t\t\"box-border\",\n\t\t\t\t\t\t\t\"resize-none\",\n\t\t\t\t\t\t\t\"overflow-x-hidden\",\n\t\t\t\t\t\t\t\"overflow-y-auto\",\n\t\t\t\t\t\t\t\"!pb-10\",\n\t\t\t\t\t\t\t\"flex-none flex-grow\",\n\t\t\t\t\t\t\t\"z-[2]\",\n\t\t\t\t\t\t\t\"scrollbar-none\",\n\t\t\t\t\t\t\t\"scrollbar-hide\",\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\n\t\t\t\t\t{/* Transparent overlay at bottom */}\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"absolute bottom-[1px] left-2 right-2 h-10 bg-gradient-to-t from-[var(--vscode-input-background)] via-[var(--vscode-input-background)] to-transparent pointer-events-none z-[2]\"\n\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t/>\n\n\t\t\t\t\t{/* Floating Actions */}\n\t\t\t\t\t<div className=\"absolute bottom-2 right-2 z-30 flex items-center gap-1\">\n\t\t\t\t\t\t{/* Model indicator (read-only) - disabled SelectDropdown for visual consistency */}\n\t\t\t\t\t\t{modelId && modelOptions.length > 0 && (\n\t\t\t\t\t\t\t<div className=\"am-model-selector mr-1\">\n\t\t\t\t\t\t\t\t<SelectDropdown\n\t\t\t\t\t\t\t\t\tvalue={modelId}\n\t\t\t\t\t\t\t\t\toptions={modelOptions}\n\t\t\t\t\t\t\t\t\tonChange={() => {}} // No-op since disabled\n\t\t\t\t\t\t\t\t\tdisabled={true}\n\t\t\t\t\t\t\t\t\ttriggerClassName=\"am-model-selector-trigger\"\n\t\t\t\t\t\t\t\t\tcontentClassName=\"am-model-selector-content\"\n\t\t\t\t\t\t\t\t\talign=\"end\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{showFinishToBranch && (\n\t\t\t\t\t\t\t<StandardTooltip\n\t\t\t\t\t\t\t\tcontent={\n\t\t\t\t\t\t\t\t\tworktreeBranchName\n\t\t\t\t\t\t\t\t\t\t? t(\"chatInput.finishToBranchTitle\", { branch: worktreeBranchName })\n\t\t\t\t\t\t\t\t\t\t: t(\"chatInput.finishToBranchTitleNoBranch\")\n\t\t\t\t\t\t\t\t}>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\taria-label={\n\t\t\t\t\t\t\t\t\t\tworktreeBranchName\n\t\t\t\t\t\t\t\t\t\t\t? t(\"chatInput.finishToBranchTitle\", { branch: worktreeBranchName })\n\t\t\t\t\t\t\t\t\t\t\t: t(\"chatInput.finishToBranchTitleNoBranch\")\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tonClick={handleFinishToBranch}\n\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\"relative inline-flex items-center justify-center\",\n\t\t\t\t\t\t\t\t\t\t\"bg-transparent border-none p-1.5\",\n\t\t\t\t\t\t\t\t\t\t\"rounded-md min-w-[28px] min-h-[28px]\",\n\t\t\t\t\t\t\t\t\t\t\"opacity-60 hover:opacity-100 text-vscode-descriptionForeground hover:text-vscode-foreground\",\n\t\t\t\t\t\t\t\t\t\t\"transition-all duration-150\",\n\t\t\t\t\t\t\t\t\t\t\"hover:bg-[rgba(255,255,255,0.03)] hover:border-[rgba(255,255,255,0.15)]\",\n\t\t\t\t\t\t\t\t\t\t\"focus:outline-none focus-visible:ring-1 focus-visible:ring-vscode-focusBorder\",\n\t\t\t\t\t\t\t\t\t\t\"active:bg-[rgba(255,255,255,0.1)]\",\n\t\t\t\t\t\t\t\t\t\t\"cursor-pointer\",\n\t\t\t\t\t\t\t\t\t)}>\n\t\t\t\t\t\t\t\t\t<GitBranch size={14} />\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</StandardTooltip>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{showCreatePR && (\n\t\t\t\t\t\t\t<StandardTooltip content={t(\"chatInput.createPRTitle\")}>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\taria-label={t(\"chatInput.createPRTitle\")}\n\t\t\t\t\t\t\t\t\tonClick={handleCreatePR}\n\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\"relative inline-flex items-center justify-center\",\n\t\t\t\t\t\t\t\t\t\t\"bg-transparent border-none p-1.5\",\n\t\t\t\t\t\t\t\t\t\t\"rounded-md min-w-[28px] min-h-[28px]\",\n\t\t\t\t\t\t\t\t\t\t\"opacity-60 hover:opacity-100 text-vscode-descriptionForeground hover:text-vscode-foreground\",\n\t\t\t\t\t\t\t\t\t\t\"transition-all duration-150\",\n\t\t\t\t\t\t\t\t\t\t\"hover:bg-[rgba(255,255,255,0.03)] hover:border-[rgba(255,255,255,0.15)]\",\n\t\t\t\t\t\t\t\t\t\t\"focus:outline-none focus-visible:ring-1 focus-visible:ring-vscode-focusBorder\",\n\t\t\t\t\t\t\t\t\t\t\"active:bg-[rgba(255,255,255,0.1)]\",\n\t\t\t\t\t\t\t\t\t\t\"cursor-pointer\",\n\t\t\t\t\t\t\t\t\t)}>\n\t\t\t\t\t\t\t\t\t<GitPullRequest size={14} />\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</StandardTooltip>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{isActive && showCancel && (\n\t\t\t\t\t\t\t<StandardTooltip content={t(\"chatInput.cancelTitle\")}>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\taria-label={t(\"chatInput.cancelTitle\")}\n\t\t\t\t\t\t\t\t\tonClick={handleCancel}\n\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\"relative inline-flex items-center justify-center\",\n\t\t\t\t\t\t\t\t\t\t\"bg-transparent border-none p-1.5\",\n\t\t\t\t\t\t\t\t\t\t\"rounded-md min-w-[28px] min-h-[28px]\",\n\t\t\t\t\t\t\t\t\t\t\"opacity-60 hover:opacity-100 text-vscode-errorForeground\",\n\t\t\t\t\t\t\t\t\t\t\"transition-all duration-150\",\n\t\t\t\t\t\t\t\t\t\t\"hover:bg-[rgba(255,255,255,0.03)] hover:border-[rgba(255,255,255,0.15)]\",\n\t\t\t\t\t\t\t\t\t\t\"focus:outline-none focus-visible:ring-1 focus-visible:ring-vscode-focusBorder\",\n\t\t\t\t\t\t\t\t\t\t\"active:bg-[rgba(255,255,255,0.1)]\",\n\t\t\t\t\t\t\t\t\t\t\"cursor-pointer\",\n\t\t\t\t\t\t\t\t\t)}>\n\t\t\t\t\t\t\t\t\t<Square size={14} fill=\"currentColor\" />\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</StandardTooltip>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<StandardTooltip content={t(\"chatInput.sendTitle\")}>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\taria-label={t(\"chatInput.sendTitle\")}\n\t\t\t\t\t\t\t\tdisabled={sendDisabled}\n\t\t\t\t\t\t\t\tonClick={handleSend}\n\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\"relative inline-flex items-center justify-center\",\n\t\t\t\t\t\t\t\t\t\"bg-transparent border-none p-1.5\",\n\t\t\t\t\t\t\t\t\t\"rounded-md min-w-[28px] min-h-[28px]\",\n\t\t\t\t\t\t\t\t\t\"opacity-60 hover:opacity-100 text-vscode-descriptionForeground hover:text-vscode-foreground\",\n\t\t\t\t\t\t\t\t\t\"transition-all duration-150\",\n\t\t\t\t\t\t\t\t\t\"hover:bg-[rgba(255,255,255,0.03)] hover:border-[rgba(255,255,255,0.15)]\",\n\t\t\t\t\t\t\t\t\t\"focus:outline-none focus-visible:ring-1 focus-visible:ring-vscode-focusBorder\",\n\t\t\t\t\t\t\t\t\t\"active:bg-[rgba(255,255,255,0.1)]\",\n\t\t\t\t\t\t\t\t\t!sendDisabled && \"cursor-pointer\",\n\t\t\t\t\t\t\t\t\tsendDisabled &&\n\t\t\t\t\t\t\t\t\t\t\"opacity-40 cursor-not-allowed grayscale-[30%] hover:bg-transparent hover:border-[rgba(255,255,255,0.08)] active:bg-transparent\",\n\t\t\t\t\t\t\t\t)}>\n\t\t\t\t\t\t\t\t{/* rtl support */}\n\t\t\t\t\t\t\t\t<SendHorizontal className=\"w-4 h-4 rtl:-scale-x-100\" />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</StandardTooltip>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Hint Text inside input */}\n\t\t\t\t\t{!messageText && (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"absolute left-3 right-[100px] z-30 flex items-center h-8 overflow-hidden text-ellipsis whitespace-nowrap\"\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tbottom: \"0.25rem\",\n\t\t\t\t\t\t\t\tcolor: \"var(--vscode-descriptionForeground)\",\n\t\t\t\t\t\t\t\topacity: 0.7,\n\t\t\t\t\t\t\t\tfontSize: \"11px\",\n\t\t\t\t\t\t\t\tuserSelect: \"none\",\n\t\t\t\t\t\t\t\tpointerEvents: \"none\",\n\t\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t{t(\"chatInput.hint\")}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n",
    "import { useEffect, useCallback } from \"react\"\nimport { useAtomValue } from \"jotai\"\nimport { useTranslation } from \"react-i18next\"\nimport { GitBranch, Check } from \"lucide-react\"\nimport { branchesAtom, currentBranchAtom } from \"../state/atoms/branches\"\nimport {\n\tCommand,\n\tCommandInput,\n\tCommandList,\n\tCommandEmpty,\n\tCommandGroup,\n\tCommandItem,\n\tCommandSeparator,\n} from \"@/components/ui/command\"\n\ninterface BranchPickerProps {\n\tselectedBranch: string | null\n\tonSelect: (branch: string) => void\n\tonClose: () => void\n}\n\n/**\n * Branch picker component using cmdk for keyboard-navigable searchable list\n * with \"Your branches\" (current) and \"Other branches\" sections\n */\nexport function BranchPicker({ selectedBranch, onSelect, onClose }: BranchPickerProps) {\n\tconst { t } = useTranslation(\"agentManager\")\n\tconst branches = useAtomValue(branchesAtom)\n\tconst currentBranch = useAtomValue(currentBranchAtom)\n\n\tconst yourBranches = currentBranch && branches.includes(currentBranch) ? [currentBranch] : []\n\tconst otherBranches = branches.filter((b) => b !== currentBranch)\n\n\tconst handleSelect = useCallback(\n\t\t(branch: string) => {\n\t\t\tonSelect(branch)\n\t\t\tonClose()\n\t\t},\n\t\t[onSelect, onClose],\n\t)\n\n\tuseEffect(() => {\n\t\tconst handleKeyDown = (e: KeyboardEvent) => {\n\t\t\tif (e.key === \"Escape\") {\n\t\t\t\tonClose()\n\t\t\t}\n\t\t}\n\t\tdocument.addEventListener(\"keydown\", handleKeyDown)\n\t\treturn () => document.removeEventListener(\"keydown\", handleKeyDown)\n\t}, [onClose])\n\n\tconst handleBackdropClick = (e: React.MouseEvent) => {\n\t\tif (e.target === e.currentTarget) {\n\t\t\tonClose()\n\t\t}\n\t}\n\n\tif (branches.length === 0) {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName=\"fixed inset-0 bg-black/50 flex items-start justify-center pt-20 z-50\"\n\t\t\t\tonClick={handleBackdropClick}>\n\t\t\t\t<div className=\"bg-vscode-editor-background border border-vscode-editorWidget-border rounded-md shadow-lg w-96 p-4 text-center text-vscode-descriptionForeground\">\n\t\t\t\t\t<GitBranch size={24} className=\"mx-auto mb-2 opacity-50\" />\n\t\t\t\t\t{t(\"sessionDetail.noBranches\")}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t)\n\t}\n\n\treturn (\n\t\t<div\n\t\t\tclassName=\"fixed inset-0 bg-black/50 flex items-start justify-center pt-20 z-50\"\n\t\t\tonClick={handleBackdropClick}>\n\t\t\t<Command className=\"bg-vscode-editor-background border border-vscode-editorWidget-border rounded-md shadow-lg w-96 max-h-96 flex flex-col overflow-hidden\">\n\t\t\t\t<CommandInput placeholder={t(\"sessionDetail.searchBranches\")} autoFocus />\n\t\t\t\t<CommandList>\n\t\t\t\t\t<CommandEmpty>{t(\"sessionDetail.noMatchingBranches\")}</CommandEmpty>\n\n\t\t\t\t\t{yourBranches.length > 0 && (\n\t\t\t\t\t\t<CommandGroup heading={t(\"sessionDetail.yourBranches\")}>\n\t\t\t\t\t\t\t{yourBranches.map((branch) => (\n\t\t\t\t\t\t\t\t<CommandItem key={branch} value={branch} onSelect={() => handleSelect(branch)}>\n\t\t\t\t\t\t\t\t\t<GitBranch size={12} className=\"flex-shrink-0\" />\n\t\t\t\t\t\t\t\t\t<span className=\"truncate flex-1\">{branch}</span>\n\t\t\t\t\t\t\t\t\t{selectedBranch === branch && <Check size={12} className=\"ml-auto\" />}\n\t\t\t\t\t\t\t\t</CommandItem>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</CommandGroup>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{yourBranches.length > 0 && otherBranches.length > 0 && <CommandSeparator />}\n\n\t\t\t\t\t{otherBranches.length > 0 && (\n\t\t\t\t\t\t<CommandGroup heading={t(\"sessionDetail.otherBranches\")}>\n\t\t\t\t\t\t\t{otherBranches.map((branch) => (\n\t\t\t\t\t\t\t\t<CommandItem key={branch} value={branch} onSelect={() => handleSelect(branch)}>\n\t\t\t\t\t\t\t\t\t<GitBranch size={12} className=\"flex-shrink-0\" />\n\t\t\t\t\t\t\t\t\t<span className=\"truncate flex-1\">{branch}</span>\n\t\t\t\t\t\t\t\t\t{selectedBranch === branch && <Check size={12} className=\"ml-auto\" />}\n\t\t\t\t\t\t\t\t</CommandItem>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</CommandGroup>\n\t\t\t\t\t)}\n\t\t\t\t</CommandList>\n\t\t\t</Command>\n\t\t</div>\n\t)\n}\n",
    "import React from \"react\"\n\nexport const KiloLogo = () => {\n\treturn (\n\t\t<svg\n\t\t\tid=\"Layer_2\"\n\t\t\tdata-name=\"Layer 2\"\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\tviewBox=\"0 0 100 100\"\n\t\t\twidth=\"100%\"\n\t\t\theight=\"100%\"\n\t\t\tstyle={{ display: \"block\" }}>\n\t\t\t<g id=\"Kilo_Code_Branding\" data-name=\"Kilo Code Branding\">\n\t\t\t\t<path\n\t\t\t\t\tid=\"Logo_Outline_-_White\"\n\t\t\t\t\tdata-name=\"Logo Outline - White\"\n\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\td=\"M0,0v100h100V0H0ZM92.5925926,92.5925926H7.4074074V7.4074074h85.1851852v85.1851852ZM61.1111044,71.9096084h9.2592593v7.4074074h-11.6402116l-5.026455-5.026455v-11.6402116h7.4074074v9.2592593ZM77.7777711,71.9096084h-7.4074074v-9.2592593h-9.2592593v-7.4074074h11.6402116l5.026455,5.026455v11.6402116ZM46.2962963,61.1114207h-7.4074074v-7.4074074h7.4074074v7.4074074ZM22.2222222,53.7040133h7.4074074v16.6666667h16.6666667v7.4074074h-19.047619l-5.026455-5.026455v-19.047619ZM77.7777711,38.8888889v7.4074074h-24.0740741v-7.4074074h8.2781918v-9.2592593h-8.2781918v-7.4074074h10.6591442l5.026455,5.026455v11.6402116h8.3884749ZM29.6296296,30.5555556h9.2592593l7.4074074,7.4074074v8.3333333h-7.4074074v-8.3333333h-9.2592593v8.3333333h-7.4074074v-24.0740741h7.4074074v8.3333333ZM46.2962963,30.5555556h-7.4074074v-8.3333333h7.4074074v8.3333333Z\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t</svg>\n\t)\n}\n",
    "import React, { useState, useEffect, useMemo, useRef } from \"react\"\nimport { useAtom, useAtomValue, useSetAtom } from \"jotai\"\nimport { useTranslation } from \"react-i18next\"\nimport {\n\tselectedSessionAtom,\n\tstartSessionFailedCounterAtom,\n\tpendingSessionAtom,\n\tpreferredRunModeAtom,\n\tversionCountAtom,\n\tgenerateVersionLabels,\n\tVERSION_COUNT_OPTIONS,\n\ttype RunMode,\n\ttype VersionCount,\n} from \"../state/atoms/sessions\"\nimport {\n\tmodelsConfigAtom,\n\tmodelsLoadingAtom,\n\teffectiveModelIdAtom,\n\tsetSelectedModelIdAtom,\n} from \"../state/atoms/models\"\nimport { SelectDropdown, type DropdownOption } from \"../../../components/ui/select-dropdown\"\nimport { sessionMachineUiStateAtom, selectedSessionMachineStateAtom } from \"../state/atoms/stateMachine\"\nimport { MessageList } from \"./MessageList\"\nimport { ChatInput } from \"./ChatInput\"\nimport { BranchPicker } from \"./BranchPicker\"\nimport { vscode } from \"../utils/vscode\"\nimport { formatRelativeTime, createRelativeTimeLabels } from \"../utils/timeUtils\"\nimport {\n\tLoader2,\n\tSendHorizontal,\n\tGitBranch,\n\tFolder,\n\tChevronDown,\n\tAlertCircle,\n\tZap,\n\tLayers,\n\tX,\n\tTerminal,\n} from \"lucide-react\"\nimport DynamicTextArea from \"react-textarea-autosize\"\nimport { cn } from \"../../../lib/utils\"\nimport { StandardTooltip } from \"../../../components/ui\"\nimport { KiloLogo } from \"./KiloLogo\"\n\nexport function SessionDetail() {\n\tconst { t } = useTranslation(\"agentManager\")\n\tconst selectedSession = useAtomValue(selectedSessionAtom)\n\tconst pendingSession = useAtomValue(pendingSessionAtom)\n\tconst machineUiState = useAtomValue(sessionMachineUiStateAtom)\n\tconst selectedSessionState = useAtomValue(selectedSessionMachineStateAtom)\n\tconst prevSessionStateRef = useRef<{ id: string; status: string } | undefined>(undefined)\n\n\t// Hooks must be called unconditionally before any early returns\n\tconst timeLabels = useMemo(() => createRelativeTimeLabels(t), [t])\n\n\t// Auto-cancel session when it ends (as if user clicked the red cancel button)\n\t// Only send cancel once when transitioning from \"running\" to a terminal state\n\t// Track both sessionId and status to avoid spurious cancels on session switches\n\tuseEffect(() => {\n\t\tif (!selectedSession) return\n\n\t\tconst prevState = prevSessionStateRef.current\n\t\tconst currentState = { id: selectedSession.sessionId, status: selectedSession.status }\n\n\t\t// Update the ref for next render\n\t\tprevSessionStateRef.current = currentState\n\n\t\t// Only send cancel if same session transitioned from running to terminal state\n\t\tif (prevState?.id === currentState.id && prevState.status === \"running\" && currentState.status !== \"running\") {\n\t\t\tvscode.postMessage({\n\t\t\t\ttype: \"agentManager.cancelSession\",\n\t\t\t\tsessionId: selectedSession.sessionId,\n\t\t\t})\n\t\t}\n\t}, [selectedSession])\n\n\t// Show pending session view only when no other session is selected\n\tif (pendingSession && !selectedSession) {\n\t\treturn <PendingSessionView pendingSession={pendingSession} />\n\t}\n\n\tif (!selectedSession) {\n\t\treturn <NewAgentForm />\n\t}\n\n\t// Use state machine UI state as the single source of truth for activity/spinner\n\tconst sessionUiState = machineUiState[selectedSession.sessionId]\n\tconst isActive = sessionUiState?.isActive ?? false\n\tconst showSpinner = sessionUiState?.showSpinner ?? false\n\tconst isWorktree = selectedSession.parallelMode?.enabled\n\tconst branchName = selectedSession.parallelMode?.branch\n\tconst isProvisionalSession = selectedSession.sessionId.startsWith(\"provisional-\")\n\n\t// Determine if \"Finish to Branch\" button should be shown\n\t// Simplified logic: show when session is a worktree session and running\n\t// Users should be able to finish at any point while the session is active\n\tconst isSessionRunning = selectedSession.status === \"running\"\n\tconst canFinishWorktree = !!isWorktree && isSessionRunning\n\n\t// Determine if \"Create PR\" button should be shown\n\t// Show for worktree sessions with a branch, whether running or completed (can resume)\n\tconst canCreatePR = !!isWorktree && !!branchName\n\tconst parentBranch = selectedSession.parallelMode?.parentBranch\n\n\treturn (\n\t\t<div className=\"am-session-detail\">\n\t\t\t<div className=\"am-detail-header\">\n\t\t\t\t<div className=\"am-header-info\">\n\t\t\t\t\t<div className=\"am-header-title\" title={selectedSession.prompt}>\n\t\t\t\t\t\t{selectedSession.label}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"am-header-meta\">\n\t\t\t\t\t\t{showSpinner && (\n\t\t\t\t\t\t\t<div style={{ display: \"flex\", alignItems: \"center\", gap: 4 }}>\n\t\t\t\t\t\t\t\t<Loader2 size={12} className=\"am-spinning\" />\n\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t{selectedSessionState === \"creating\" ? t(\"status.creating\") : t(\"status.running\")}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<span>{formatRelativeTime(selectedSession.startTime, timeLabels)}</span>\n\t\t\t\t\t\t{isWorktree ? (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName=\"am-worktree-badge\"\n\t\t\t\t\t\t\t\tstyle={{ display: \"flex\", alignItems: \"center\", gap: 4 }}\n\t\t\t\t\t\t\t\ttitle={branchName || t(\"sessionDetail.runningInWorktree\")}>\n\t\t\t\t\t\t\t\t<GitBranch size={12} />\n\t\t\t\t\t\t\t\t<span>{branchName || t(\"sidebar.worktree\")}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName=\"am-local-badge\"\n\t\t\t\t\t\t\t\tstyle={{ display: \"flex\", alignItems: \"center\", gap: 4 }}\n\t\t\t\t\t\t\t\ttitle={t(\"sessionDetail.runningLocally\")}>\n\t\t\t\t\t\t\t\t<Folder size={12} />\n\t\t\t\t\t\t\t\t<span>{t(\"sessionDetail.runModeLocal\")}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"am-header-actions\">\n\t\t\t\t\t{!isProvisionalSession && (\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName=\"am-icon-btn\"\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tvscode.postMessage({\n\t\t\t\t\t\t\t\t\ttype: \"agentManager.showTerminal\",\n\t\t\t\t\t\t\t\t\tsessionId: selectedSession.sessionId,\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\taria-label={t(\"sessionDetail.openTerminal\")}\n\t\t\t\t\t\t\ttitle={t(\"sessionDetail.openTerminal\")}>\n\t\t\t\t\t\t\t<Terminal size={14} />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{selectedSession.status === \"error\" && selectedSession.error && (\n\t\t\t\t<div className=\"am-session-error-banner\" role=\"alert\">\n\t\t\t\t\t<AlertCircle size={16} />\n\t\t\t\t\t<span>{selectedSession.error}</span>\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{isActive && (\n\t\t\t\t<div className=\"am-full-auto-banner\">\n\t\t\t\t\t<Zap size={14} />\n\t\t\t\t\t<span>{t(\"sessionDetail.autoModeWarning\")}</span>\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t<MessageList sessionId={selectedSession.sessionId} />\n\n\t\t\t<ChatInput\n\t\t\t\tsessionId={selectedSession.sessionId}\n\t\t\t\tsessionLabel={selectedSession.label}\n\t\t\t\tisActive={isActive}\n\t\t\t\tshowCancel={isActive}\n\t\t\t\tshowFinishToBranch={canFinishWorktree}\n\t\t\t\tshowCreatePR={canCreatePR}\n\t\t\t\tworktreeBranchName={branchName}\n\t\t\t\tparentBranch={parentBranch}\n\t\t\t\tsessionStatus={selectedSession.status}\n\t\t\t\tmodelId={selectedSession.model}\n\t\t\t/>\n\t\t</div>\n\t)\n}\n\n/**\n * View shown while a session is being created (waiting for CLI's session_created event)\n */\nfunction PendingSessionView({\n\tpendingSession,\n}: {\n\tpendingSession: { label: string; prompt: string; startTime: number }\n}) {\n\tconst { t } = useTranslation(\"agentManager\")\n\n\tconst handleCancel = () => {\n\t\tvscode.postMessage({ type: \"agentManager.cancelPendingSession\" })\n\t}\n\n\treturn (\n\t\t<div className=\"am-session-detail\">\n\t\t\t<div className=\"am-detail-header\">\n\t\t\t\t<div className=\"am-header-info\">\n\t\t\t\t\t<div className=\"am-header-title\" title={pendingSession.prompt}>\n\t\t\t\t\t\t{pendingSession.label}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"am-header-meta\">\n\t\t\t\t\t\t<div style={{ display: \"flex\", alignItems: \"center\", gap: 4 }}>\n\t\t\t\t\t\t\t<Loader2 size={12} className=\"am-spinning\" />\n\t\t\t\t\t\t\t<span>{t(\"status.creating\")}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"am-header-actions\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName=\"am-icon-btn\"\n\t\t\t\t\t\tonClick={handleCancel}\n\t\t\t\t\t\taria-label={t(\"sessionDetail.cancelCreating\")}\n\t\t\t\t\t\ttitle={t(\"sessionDetail.cancelCreating\")}>\n\t\t\t\t\t\t<X size={14} />\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div className=\"am-center-form\">\n\t\t\t\t<Loader2 size={48} className=\"am-spinning\" style={{ opacity: 0.5 }} />\n\t\t\t\t<h2 style={{ marginTop: 16 }}>{t(\"sessionDetail.creatingSession\")}</h2>\n\t\t\t\t<p>{t(\"sessionDetail.waitingForCli\")}</p>\n\t\t\t\t<button className=\"am-cancel-btn\" onClick={handleCancel} style={{ marginTop: 16 }}>\n\t\t\t\t\t{t(\"sessionDetail.cancelButton\")}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nfunction NewAgentForm() {\n\tconst { t } = useTranslation(\"agentManager\")\n\tconst [promptText, setPromptText] = useState(\"\")\n\tconst [runMode, setRunMode] = useAtom(preferredRunModeAtom)\n\tconst [versionCount, setVersionCount] = useAtom(versionCountAtom)\n\tconst setSelectedModelId = useSetAtom(setSelectedModelIdAtom)\n\tconst modelsConfig = useAtomValue(modelsConfigAtom)\n\tconst modelsLoading = useAtomValue(modelsLoadingAtom)\n\tconst effectiveModelId = useAtomValue(effectiveModelIdAtom)\n\tconst [isStarting, setIsStarting] = useState(false)\n\tconst [isFocused, setIsFocused] = useState(false)\n\tconst [isDropdownOpen, setIsDropdownOpen] = useState(false)\n\tconst [isVersionDropdownOpen, setIsVersionDropdownOpen] = useState(false)\n\tconst [selectedBranch, setSelectedBranch] = useState<string | null>(null)\n\tconst [isBranchPickerOpen, setIsBranchPickerOpen] = useState(false)\n\tconst dropdownRef = useRef<HTMLDivElement>(null)\n\tconst versionDropdownRef = useRef<HTMLDivElement>(null)\n\tconst startSessionFailedCounter = useAtomValue(startSessionFailedCounterAtom)\n\n\t// Multi-version mode forces worktree mode\n\tconst isMultiVersion = versionCount > 1\n\tconst effectiveRunMode = isMultiVersion ? \"worktree\" : runMode\n\n\t// Reset loading state when session start fails (e.g., no workspace folder)\n\tuseEffect(() => {\n\t\tif (startSessionFailedCounter > 0) {\n\t\t\tsetIsStarting(false)\n\t\t}\n\t}, [startSessionFailedCounter])\n\n\t// Request branches on mount and when switching to worktree mode\n\tuseEffect(() => {\n\t\tvscode.postMessage({ type: \"agentManager.listBranches\" })\n\t}, [])\n\n\t// Also request when switching to worktree mode\n\tuseEffect(() => {\n\t\tif (effectiveRunMode === \"worktree\") {\n\t\t\tvscode.postMessage({ type: \"agentManager.listBranches\" })\n\t\t}\n\t}, [effectiveRunMode])\n\n\t// Close dropdowns when clicking outside\n\tuseEffect(() => {\n\t\tconst handleClickOutside = (event: MouseEvent) => {\n\t\t\tif (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n\t\t\t\tsetIsDropdownOpen(false)\n\t\t\t}\n\t\t\tif (versionDropdownRef.current && !versionDropdownRef.current.contains(event.target as Node)) {\n\t\t\t\tsetIsVersionDropdownOpen(false)\n\t\t\t}\n\t\t}\n\n\t\tif (isDropdownOpen || isVersionDropdownOpen) {\n\t\t\tdocument.addEventListener(\"mousedown\", handleClickOutside)\n\t\t}\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener(\"mousedown\", handleClickOutside)\n\t\t}\n\t}, [isDropdownOpen, isVersionDropdownOpen])\n\n\tconst trimmedPrompt = promptText.trim()\n\tconst isEmpty = trimmedPrompt.length === 0\n\n\tconst handleStart = () => {\n\t\tif (isEmpty || isStarting) return\n\n\t\tsetIsStarting(true)\n\n\t\t// Generate labels for multi-version mode\n\t\tconst labels = isMultiVersion ? generateVersionLabels(trimmedPrompt.slice(0, 50), versionCount) : undefined\n\n\t\tvscode.postMessage({\n\t\t\ttype: \"agentManager.startSession\",\n\t\t\tprompt: trimmedPrompt,\n\t\t\tparallelMode: effectiveRunMode === \"worktree\",\n\t\t\tversions: versionCount,\n\t\t\tlabels,\n\t\t\texistingBranch: selectedBranch || undefined,\n\t\t\tmodel: effectiveModelId || undefined,\n\t\t})\n\t}\n\n\tconst handleKeyDown = (e: React.KeyboardEvent) => {\n\t\tif (e.key === \"Enter\" && !e.shiftKey && !e.nativeEvent.isComposing) {\n\t\t\te.preventDefault()\n\t\t\thandleStart()\n\t\t}\n\t}\n\n\tconst handleSelectMode = (mode: RunMode) => {\n\t\tsetRunMode(mode)\n\t\tsetIsDropdownOpen(false)\n\t}\n\n\tconst handleSelectVersionCount = (count: VersionCount) => {\n\t\tsetVersionCount(count)\n\t\tsetIsVersionDropdownOpen(false)\n\t}\n\n\t// Convert models to SelectDropdown options\n\tconst modelOptions: DropdownOption[] = useMemo(() => {\n\t\tif (!modelsConfig) return []\n\t\treturn modelsConfig.models.map((model) => ({\n\t\t\tvalue: model.id,\n\t\t\tlabel: model.displayName || model.id,\n\t\t\tdescription: model.contextWindow ? `${Math.floor(model.contextWindow / 1000)}K context` : undefined,\n\t\t}))\n\t}, [modelsConfig])\n\n\t// Check if models are available (loaded and have items)\n\tconst hasModels = modelsConfig && modelsConfig.models.length > 0\n\n\treturn (\n\t\t<div className=\"am-center-form\">\n\t\t\t<div\n\t\t\t\tclassName=\"text-[var(--vscode-editor-foreground)]\"\n\t\t\t\tstyle={{ width: 48, height: 48, margin: \"0 auto 16px auto\" }}>\n\t\t\t\t<KiloLogo />\n\t\t\t</div>\n\t\t\t<div style={{ width: \"100%\", maxWidth: \"100%\", minWidth: \"280px\" }}>\n\t\t\t\t<div\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\"relative\",\n\t\t\t\t\t\t\"flex\",\n\t\t\t\t\t\t\"flex-col-reverse\",\n\t\t\t\t\t\t\"min-h-0\",\n\t\t\t\t\t\t\"overflow-visible\", // Allow dropdown to overflow\n\t\t\t\t\t\t\"rounded\",\n\t\t\t\t\t)}>\n\t\t\t\t\t<DynamicTextArea\n\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\tvalue={promptText}\n\t\t\t\t\t\tonChange={(e) => setPromptText(e.target.value)}\n\t\t\t\t\t\tonKeyDown={handleKeyDown}\n\t\t\t\t\t\tonFocus={() => setIsFocused(true)}\n\t\t\t\t\t\tonBlur={() => setIsFocused(false)}\n\t\t\t\t\t\taria-label={t(\"sessionDetail.startNewAgent\")}\n\t\t\t\t\t\tdisabled={isStarting}\n\t\t\t\t\t\tplaceholder={t(\"sessionDetail.placeholderTask\")}\n\t\t\t\t\t\tminRows={5}\n\t\t\t\t\t\tmaxRows={12}\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tpaddingTop: \"12px\",\n\t\t\t\t\t\t\tpaddingBottom: \"40px\",\n\t\t\t\t\t\t\tpaddingLeft: \"16px\",\n\t\t\t\t\t\t\tpaddingRight: \"36px\",\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\"w-full\",\n\t\t\t\t\t\t\t\"text-vscode-input-foreground\",\n\t\t\t\t\t\t\t\"font-vscode-font-family\",\n\t\t\t\t\t\t\t\"text-vscode-editor-font-size\",\n\t\t\t\t\t\t\t\"leading-vscode-editor-line-height\",\n\t\t\t\t\t\t\t\"cursor-text\",\n\t\t\t\t\t\t\t// Padding handled by style prop now\n\t\t\t\t\t\t\tisFocused\n\t\t\t\t\t\t\t\t? \"border border-vscode-focusBorder outline outline-vscode-focusBorder\"\n\t\t\t\t\t\t\t\t: \"border border-vscode-input-border\",\n\t\t\t\t\t\t\t\"bg-vscode-input-background\",\n\t\t\t\t\t\t\t\"transition-background-color duration-150 ease-in-out\",\n\t\t\t\t\t\t\t\"will-change-background-color\",\n\t\t\t\t\t\t\t\"box-border\",\n\t\t\t\t\t\t\t\"rounded\",\n\t\t\t\t\t\t\t\"resize-none\",\n\t\t\t\t\t\t\t\"overflow-x-hidden\",\n\t\t\t\t\t\t\t\"overflow-y-auto\",\n\t\t\t\t\t\t\t\"flex-none flex-grow\",\n\t\t\t\t\t\t\t\"z-[2]\",\n\t\t\t\t\t\t\t\"scrollbar-none\",\n\t\t\t\t\t\t\t\"scrollbar-hide\",\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"absolute bottom-[1px] left-2 right-2 h-10 bg-gradient-to-t from-[var(--vscode-input-background)] via-[var(--vscode-input-background)] to-transparent pointer-events-none z-[2]\"\n\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t/>\n\n\t\t\t\t\t<div className=\"absolute bottom-2 right-2 z-30 flex items-center gap-2\">\n\t\t\t\t\t\t<div ref={dropdownRef} className=\"am-run-mode-dropdown-inline relative\">\n\t\t\t\t\t\t\t<StandardTooltip\n\t\t\t\t\t\t\t\tcontent={\n\t\t\t\t\t\t\t\t\tisMultiVersion\n\t\t\t\t\t\t\t\t\t\t? t(\"sessionDetail.versionsHelperText\", { count: versionCount })\n\t\t\t\t\t\t\t\t\t\t: effectiveRunMode === \"local\"\n\t\t\t\t\t\t\t\t\t\t\t? t(\"sessionDetail.runModeLocal\")\n\t\t\t\t\t\t\t\t\t\t\t: t(\"sessionDetail.runModeWorktree\")\n\t\t\t\t\t\t\t\t}>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName={cn(\"am-run-mode-trigger-inline\", isMultiVersion && \"am-locked\")}\n\t\t\t\t\t\t\t\t\tonClick={() => !isMultiVersion && setIsDropdownOpen(!isDropdownOpen)}\n\t\t\t\t\t\t\t\t\tdisabled={isStarting || isMultiVersion}\n\t\t\t\t\t\t\t\t\ttype=\"button\">\n\t\t\t\t\t\t\t\t\t{effectiveRunMode === \"local\" ? <Folder size={14} /> : <GitBranch size={14} />}\n\t\t\t\t\t\t\t\t\t{!isMultiVersion && (\n\t\t\t\t\t\t\t\t\t\t<ChevronDown\n\t\t\t\t\t\t\t\t\t\t\tsize={10}\n\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\"am-chevron\", isDropdownOpen && \"am-open\")}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</StandardTooltip>\n\t\t\t\t\t\t\t{isDropdownOpen && !isMultiVersion && (\n\t\t\t\t\t\t\t\t<div className=\"am-run-mode-menu-inline\">\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\"am-run-mode-option-inline\",\n\t\t\t\t\t\t\t\t\t\t\trunMode === \"local\" && \"am-selected\",\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\tonClick={() => handleSelectMode(\"local\")}\n\t\t\t\t\t\t\t\t\t\ttype=\"button\">\n\t\t\t\t\t\t\t\t\t\t<Folder size={12} />\n\t\t\t\t\t\t\t\t\t\t<span>{t(\"sessionDetail.runModeLocal\")}</span>\n\t\t\t\t\t\t\t\t\t\t{runMode === \"local\" && <span className=\"am-checkmark\"></span>}\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\"am-run-mode-option-inline\",\n\t\t\t\t\t\t\t\t\t\t\trunMode === \"worktree\" && \"am-selected\",\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\tonClick={() => handleSelectMode(\"worktree\")}\n\t\t\t\t\t\t\t\t\t\ttype=\"button\">\n\t\t\t\t\t\t\t\t\t\t<GitBranch size={12} />\n\t\t\t\t\t\t\t\t\t\t<span className=\"am-run-mode-label\">{t(\"sessionDetail.runModeWorktree\")}</span>\n\t\t\t\t\t\t\t\t\t\t{runMode === \"worktree\" && <span className=\"am-checkmark\"></span>}\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div ref={versionDropdownRef} className=\"am-run-mode-dropdown-inline relative\">\n\t\t\t\t\t\t\t<StandardTooltip content={t(\"sessionDetail.versionsTooltip\")}>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName=\"am-run-mode-trigger-inline\"\n\t\t\t\t\t\t\t\t\tonClick={() => setIsVersionDropdownOpen(!isVersionDropdownOpen)}\n\t\t\t\t\t\t\t\t\tdisabled={isStarting}\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\ttitle={t(\"sessionDetail.versions\")}>\n\t\t\t\t\t\t\t\t\t<Layers size={14} />\n\t\t\t\t\t\t\t\t\t<span className=\"am-version-count\">{versionCount}</span>\n\t\t\t\t\t\t\t\t\t<ChevronDown\n\t\t\t\t\t\t\t\t\t\tsize={10}\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\"am-chevron\", isVersionDropdownOpen && \"am-open\")}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</StandardTooltip>\n\t\t\t\t\t\t\t{isVersionDropdownOpen && (\n\t\t\t\t\t\t\t\t<div className=\"am-run-mode-menu-inline\">\n\t\t\t\t\t\t\t\t\t{VERSION_COUNT_OPTIONS.map((count) => (\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tkey={count}\n\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\t\"am-run-mode-option-inline\",\n\t\t\t\t\t\t\t\t\t\t\t\tversionCount === count && \"am-selected\",\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleSelectVersionCount(count)}\n\t\t\t\t\t\t\t\t\t\t\ttype=\"button\">\n\t\t\t\t\t\t\t\t\t\t\t<span>{t(\"sessionDetail.versionCount\", { count })}</span>\n\t\t\t\t\t\t\t\t\t\t\t{versionCount === count && <span className=\"am-checkmark\"></span>}\n\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Model selector - show loading spinner while fetching, then SelectDropdown */}\n\t\t\t\t\t\t{modelsLoading ? (\n\t\t\t\t\t\t\t<div className=\"am-run-mode-trigger-inline opacity-70\">\n\t\t\t\t\t\t\t\t<Loader2 size={14} className=\"am-spinning\" />\n\t\t\t\t\t\t\t\t<span className=\"text-sm\">{t(\"sessionDetail.loadingModels\")}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) : hasModels ? (\n\t\t\t\t\t\t\t<div className=\"am-model-selector\">\n\t\t\t\t\t\t\t\t<SelectDropdown\n\t\t\t\t\t\t\t\t\tvalue={effectiveModelId || \"\"}\n\t\t\t\t\t\t\t\t\toptions={modelOptions}\n\t\t\t\t\t\t\t\t\tonChange={(value) => setSelectedModelId(value)}\n\t\t\t\t\t\t\t\t\tdisabled={isStarting}\n\t\t\t\t\t\t\t\t\tplaceholder={t(\"sessionDetail.selectModel\")}\n\t\t\t\t\t\t\t\t\ttitle={t(\"sessionDetail.modelTooltip\")}\n\t\t\t\t\t\t\t\t\ttriggerClassName=\"am-model-selector-trigger\"\n\t\t\t\t\t\t\t\t\tcontentClassName=\"am-model-selector-content\"\n\t\t\t\t\t\t\t\t\talign=\"end\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) : null}\n\n\t\t\t\t\t\t{effectiveRunMode === \"worktree\" && !isMultiVersion && (\n\t\t\t\t\t\t\t<StandardTooltip content={t(\"sessionDetail.branchPickerTooltip\")}>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName=\"am-run-mode-trigger-inline\"\n\t\t\t\t\t\t\t\t\tonClick={() => setIsBranchPickerOpen(true)}\n\t\t\t\t\t\t\t\t\tdisabled={isStarting}\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\ttitle={t(\"sessionDetail.selectBranch\")}>\n\t\t\t\t\t\t\t\t\t<GitBranch size={14} />\n\t\t\t\t\t\t\t\t\t<span className=\"truncate max-w-[80px] text-sm\">\n\t\t\t\t\t\t\t\t\t\t{selectedBranch || t(\"sessionDetail.selectBranch\")}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t<ChevronDown size={10} className=\"am-chevron\" />\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</StandardTooltip>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\"relative inline-flex items-center justify-center\",\n\t\t\t\t\t\t\t\t\"bg-transparent border-none p-1.5\",\n\t\t\t\t\t\t\t\t\"rounded-md min-w-[28px] min-h-[28px]\",\n\t\t\t\t\t\t\t\t\"opacity-60 hover:opacity-100 text-vscode-descriptionForeground hover:text-vscode-foreground\",\n\t\t\t\t\t\t\t\t\"transition-all duration-150\",\n\t\t\t\t\t\t\t\t\"hover:bg-[rgba(255,255,255,0.03)] hover:border-[rgba(255,255,255,0.15)]\",\n\t\t\t\t\t\t\t\t\"focus:outline-none focus-visible:ring-1 focus-visible:ring-vscode-focusBorder\",\n\t\t\t\t\t\t\t\t\"active:bg-[rgba(255,255,255,0.1)]\",\n\t\t\t\t\t\t\t\t!isEmpty && !isStarting && \"cursor-pointer\",\n\t\t\t\t\t\t\t\t(isEmpty || isStarting) &&\n\t\t\t\t\t\t\t\t\t\"opacity-40 cursor-not-allowed grayscale-[30%] hover:bg-transparent hover:border-[rgba(255,255,255,0.08)] active:bg-transparent\",\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\tonClick={handleStart}\n\t\t\t\t\t\t\tdisabled={isEmpty || isStarting}\n\t\t\t\t\t\t\taria-label={isStarting ? t(\"sessionDetail.starting\") : t(\"sessionDetail.startAriaLabel\")}\n\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\tisMultiVersion\n\t\t\t\t\t\t\t\t\t? t(\"sessionDetail.launchVersions\", { count: versionCount })\n\t\t\t\t\t\t\t\t\t: t(\"sessionDetail.startAgent\")\n\t\t\t\t\t\t\t}>\n\t\t\t\t\t\t\t{isStarting ? <Loader2 size={16} className=\"am-spinning\" /> : <SendHorizontal size={16} />}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{isBranchPickerOpen && (\n\t\t\t\t<BranchPicker\n\t\t\t\t\tselectedBranch={selectedBranch}\n\t\t\t\t\tonSelect={setSelectedBranch}\n\t\t\t\t\tonClose={() => setIsBranchPickerOpen(false)}\n\t\t\t\t/>\n\t\t\t)}\n\t\t</div>\n\t)\n}\n",
    "import React from \"react\"\nimport { Provider, useAtomValue } from \"jotai\"\nimport { useAgentManagerMessages } from \"../state/hooks\"\nimport { useMessageQueueProcessor } from \"../state/hooks/useMessageQueueProcessor\"\nimport { selectedSessionIdAtom } from \"../state/atoms/sessions\"\nimport { SessionSidebar } from \"./SessionSidebar\"\nimport { SessionDetail } from \"./SessionDetail\"\nimport { TooltipProvider } from \"../../../components/ui/tooltip\"\nimport { STANDARD_TOOLTIP_DELAY } from \"../../../components/ui/standard-tooltip\"\nimport \"./AgentManagerApp.css\"\n\n/**\n * Root component for the Agent Manager webview.\n * Wraps everything in Jotai Provider and sets up message handling.\n */\nexport function AgentManagerApp() {\n\treturn (\n\t\t<Provider>\n\t\t\t<TooltipProvider delayDuration={STANDARD_TOOLTIP_DELAY}>\n\t\t\t\t<AgentManagerContent />\n\t\t\t</TooltipProvider>\n\t\t</Provider>\n\t)\n}\n\nfunction AgentManagerContent() {\n\t// Bridge VS Code IPC messages to Jotai state\n\tuseAgentManagerMessages()\n\n\t// Get the currently selected session\n\tconst selectedSessionId = useAtomValue(selectedSessionIdAtom)\n\n\t// Process the message queue for the selected session\n\t// Hook must always be called, but will skip processing if no session selected\n\tuseMessageQueueProcessor(selectedSessionId)\n\n\treturn (\n\t\t<div className=\"agent-manager-container\">\n\t\t\t<SessionSidebar />\n\t\t\t<SessionDetail />\n\t\t</div>\n\t)\n}\n",
    "import React from \"react\"\nimport { createRoot } from \"react-dom/client\"\nimport { I18nextProvider } from \"react-i18next\"\nimport i18next, { loadTranslations } from \"../../i18n/setup\"\nimport ErrorBoundary from \"../../components/ErrorBoundary\"\nimport { AgentManagerApp } from \"./components/AgentManagerApp\"\nimport \"../../../node_modules/@vscode/codicons/dist/codicon.css\"\nimport \"../../index.css\"\n\n// Initialize i18n translations\nloadTranslations()\n\n// Mount the Agent Manager React app\nconst container = document.getElementById(\"root\")\nif (container) {\n\tconst root = createRoot(container)\n\troot.render(\n\t\t<React.StrictMode>\n\t\t\t<I18nextProvider i18n={i18next}>\n\t\t\t\t<div className=\"am-app-wrapper\">\n\t\t\t\t\t<ErrorBoundary>\n\t\t\t\t\t\t<AgentManagerApp />\n\t\t\t\t\t</ErrorBoundary>\n\t\t\t\t</div>\n\t\t\t</I18nextProvider>\n\t\t</React.StrictMode>,\n\t)\n}\n\n// Notify extension that webview is ready\nimport { vscode } from \"./utils/vscode\"\nvscode.postMessage({ type: \"agentManager.webviewReady\" })\n"
  ],
  "names": [
    "I18nextProvider",
    "i18n",
    "defaultNS",
    "children",
    "value",
    "useMemo",
    "createElement",
    "I18nContext",
    "__iconNode",
    "ArrowRightLeft",
    "createLucideIcon",
    "CircleAlert",
    "CircleCheck",
    "Circle",
    "GitPullRequest",
    "Layers",
    "Loader",
    "Terminal",
    "hasInitialValue",
    "atom",
    "isActuallyWritableAtom",
    "isAtomStateInitialized",
    "atomState",
    "returnAtomValue",
    "__vite_import_meta_env__",
    "promiseStateMap",
    "isPendingPromise",
    "_a",
    "isPromiseLike",
    "abortPromise",
    "promise",
    "promiseState",
    "fn",
    "registerAbortHandler",
    "abortHandler",
    "settle",
    "p",
    "addPendingPromiseToDependency",
    "dependencyAtomState",
    "cleanup",
    "getMountedOrPendingDependents",
    "mountedMap",
    "dependents",
    "a",
    "atomWithPendingPromise",
    "atomRead",
    "_store",
    "params",
    "atomWrite",
    "atomOnInit",
    "store",
    "atomOnMount",
    "setAtom",
    "ensureAtomState",
    "buildingBlocks",
    "getInternalBuildingBlocks",
    "atomStateMap",
    "storeHooks",
    "atomOnInit2",
    "flushCallbacks",
    "changedAtoms",
    "mountCallbacks",
    "unmountCallbacks",
    "recomputeInvalidatedAtoms2",
    "errors",
    "call",
    "e",
    "callbacks",
    "add",
    "recomputeInvalidatedAtoms",
    "invalidatedAtoms",
    "ensureAtomState2",
    "readAtomState2",
    "mountDependencies2",
    "topSortedReversed",
    "visiting",
    "visited",
    "stack",
    "aState",
    "d",
    "i",
    "hasChangedDeps",
    "dep",
    "storeMutationSet",
    "readAtomState",
    "_b",
    "atomRead2",
    "flushCallbacks2",
    "writeAtomState2",
    "n",
    "isSync",
    "mountDependenciesIfAsync",
    "getter",
    "_a2",
    "aState2",
    "setAtomStateValueOrPromise",
    "controller",
    "setSelf",
    "options",
    "args",
    "prevEpochNumber",
    "valueOrPromise",
    "error",
    "invalidateDependents",
    "dState",
    "writeAtomState",
    "atomWrite2",
    "invalidateDependents2",
    "setter",
    "args2",
    "v",
    "mountDependencies",
    "mountAtom2",
    "unmountAtom2",
    "mounted",
    "aMounted",
    "mountAtom",
    "atomOnMount2",
    "processOnMount",
    "onUnmount",
    "unmountAtom",
    "hasPrevValue",
    "prevValue",
    "storeGet",
    "storeSet",
    "storeSub",
    "listener",
    "listeners",
    "buildingBlockMap",
    "buildStore",
    "buildArgs",
    "storeGet2",
    "storeSet2",
    "storeSub2",
    "keyCount",
    "read",
    "write",
    "key",
    "config",
    "defaultRead",
    "defaultWrite",
    "get",
    "set",
    "arg",
    "createStore",
    "INTERNAL_buildStoreRev2",
    "defaultStore",
    "getDefaultStore",
    "StoreContext",
    "createContext",
    "useStore",
    "useContext",
    "Provider",
    "storeRef",
    "useRef",
    "x",
    "attachPromiseStatus",
    "use",
    "React",
    "continuablePromiseMap",
    "createContinuablePromise",
    "getValue",
    "continuablePromise",
    "resolve",
    "reject",
    "curr",
    "onFulfilled",
    "me",
    "onRejected",
    "onAbort",
    "nextValue",
    "INTERNAL_registerAbortHandler",
    "useAtomValue",
    "delay",
    "promiseStatus",
    "valueFromReducer",
    "storeFromReducer",
    "atomFromReducer",
    "rerender",
    "useReducer",
    "prev",
    "useEffect",
    "unsub",
    "value2",
    "useDebugValue",
    "useSetAtom",
    "useCallback",
    "useAtom",
    "atomFamily",
    "initializeAtom",
    "areEqual",
    "shouldRemove",
    "atoms",
    "createAtom",
    "param",
    "item",
    "newAtom",
    "notifyListeners",
    "type",
    "callback",
    "createdAt",
    "isPromiseLike$3",
    "createJSONStorage",
    "getStringStorage",
    "lastStr",
    "lastValue",
    "storage",
    "initialValue",
    "parse",
    "str2",
    "str",
    "newValue",
    "createHandleSubscribe",
    "subscriber2",
    "subscriber",
    "storageEventCallback",
    "SessionState",
    "createInitialContext",
    "createSessionStateMachine",
    "state",
    "context",
    "event",
    "nextState",
    "contextUpdate",
    "transition",
    "currentState",
    "transitionFromIdle",
    "transitionFromCreating",
    "transitionFromStreaming",
    "transitionFromWaitingApproval",
    "transitionFromWaitingInput",
    "transitionFromCompleted",
    "transitionFromPaused",
    "transitionFromError",
    "transitionFromStopped",
    "newContext",
    "sessionsMapAtom",
    "sessionOrderAtom",
    "selectedSessionIdAtom",
    "remoteSessionsAtom",
    "isRefreshingRemoteSessionsAtom",
    "pendingSessionAtom",
    "startSessionFailedCounterAtom",
    "sessionInputAtomFamily",
    "_sessionId",
    "preferredRunModeAtom",
    "MAX_VERSION_COUNT",
    "VERSION_COUNT_OPTIONS",
    "_",
    "versionCountAtom",
    "generateVersionLabels",
    "baseLabel",
    "count",
    "sessionsArrayAtom",
    "map",
    "id",
    "s",
    "toAgentSession",
    "remote",
    "createdTime",
    "updatedTime",
    "mergedSessionsAtom",
    "localSessions",
    "remoteSessions",
    "localSessionIds",
    "remoteAsDisplay",
    "rs",
    "selectedSessionAtom",
    "localSession",
    "remoteSession",
    "upsertSessionAtom",
    "session",
    "current",
    "order",
    "isNewSession",
    "removeSessionAtom",
    "sessionId",
    "rest",
    "remaining",
    "payload",
    "_get",
    "sessions",
    "sessionStateMachines",
    "getOrCreateMachine",
    "machine",
    "sessionMachineStateAtom",
    "sessionMachineUiStateAtom",
    "sendSessionEventAtom",
    "currentStates",
    "currentUiStates",
    "cleanupSessionMachineAtom",
    "_set",
    "selectedSessionMachineStateAtom",
    "uiStates",
    "sessionMessagesAtomFamily",
    "sessionMessageVersionsAtomFamily",
    "messages",
    "updateSessionMessagesAtom",
    "versions",
    "reconciled",
    "reconcileMessages",
    "newVersions",
    "m",
    "getContentLength",
    "previous",
    "msg",
    "isNew",
    "becameComplete",
    "messageToEvent",
    "message",
    "idx",
    "newMessages",
    "_c",
    "incoming",
    "currentMap",
    "incomingMsg",
    "existing",
    "currentLen",
    "partial",
    "sessionTodosAtomFamily",
    "computeTodoStats",
    "todos",
    "completedCount",
    "t",
    "totalCount",
    "inProgressTodo",
    "nextPendingTodo",
    "currentTodo",
    "allCompleted",
    "progressPercent",
    "sessionTodoStatsAtomFamily",
    "updateSessionTodosAtom",
    "branchesAtom",
    "currentBranchAtom",
    "updateBranchesAtom",
    "branches",
    "currentBranch",
    "STORAGE_KEY",
    "modelsLoadingAtom",
    "modelsConfigAtom",
    "getPersistedModelId",
    "persistModelId",
    "modelId",
    "selectedModelIdAtom",
    "effectiveModelIdAtom",
    "selected",
    "updateModelsConfigAtom",
    "currentSelection",
    "modelsLoadFailedAtom",
    "_error",
    "setSelectedModelIdAtom",
    "extractTodosFromMessages",
    "metadata",
    "mapToStateMachineEvent",
    "eventType",
    "useAgentManagerMessages",
    "updateSessionMessages",
    "updateSessionTodos",
    "updateBranches",
    "updateModelsConfig",
    "handleModelsLoadFailed",
    "upsertSession",
    "removeSession",
    "setSelectedSessionId",
    "setStartSessionFailedCounter",
    "setRemoteSessions",
    "setPendingSession",
    "setIsRefreshingRemoteSessions",
    "sendSessionEvent",
    "cleanupSessionMachine",
    "sessionOrder",
    "hasInitializedSelection",
    "knownSessionsRef",
    "handleMessage",
    "extensionSessionIds",
    "c",
    "pendingSession",
    "provider",
    "currentModel",
    "models",
    "generateId",
    "sessionMessageQueueAtomFamily",
    "sessionSendingMessageIdAtomFamily",
    "addToQueueAtom",
    "content",
    "queue",
    "newMessage",
    "updateMessageStatusAtom",
    "messageId",
    "status",
    "updated",
    "removeFromQueueAtom",
    "filtered",
    "retryFailedMessageAtom",
    "setSendingMessageAtom",
    "vsCodeApi",
    "getVSCodeApi",
    "vscode",
    "useMessageQueueProcessor",
    "sendingMessageId",
    "updateStatus",
    "removeFromQueue",
    "setSendingMessage",
    "sendNextMessage",
    "eventSessionId",
    "queuedMsg",
    "formatRelativeTime",
    "timestamp",
    "labels",
    "diff",
    "seconds",
    "minutes",
    "hours",
    "days",
    "weeks",
    "createRelativeTimeLabels",
    "SessionSidebar",
    "useTranslation",
    "selectedId",
    "setSelectedId",
    "isRefreshing",
    "setIsRefreshing",
    "machineUiState",
    "handleNewSession",
    "handleSelectSession",
    "handleRefresh",
    "isNewAgentSelected",
    "jsxs",
    "jsx",
    "Plus",
    "Loader2",
    "RefreshCw",
    "PendingSessionItem",
    "SessionItem",
    "isSelected",
    "onSelect",
    "uiState",
    "timeLabels",
    "showShareConfirm",
    "setShowShareConfirm",
    "useState",
    "isHovered",
    "setIsHovered",
    "showSpinner",
    "isActive",
    "isWorktree",
    "branchName",
    "isCompleted",
    "handleShareClick",
    "handleShareConfirm",
    "handleShareCancel",
    "GitBranch",
    "Folder",
    "Share2",
    "SimpleMarkdown",
    "ReactMarkdown",
    "remarkGfm",
    "FollowUpSuggestions",
    "suggestions",
    "onSuggestionClick",
    "onCopyToInput",
    "suggestion",
    "index",
    "StandardTooltip",
    "ClipboardCopy",
    "parseCommandAndOutput",
    "text",
    "COMMAND_OUTPUT_STRING",
    "output",
    "line",
    "sanitizeOutput",
    "raw",
    "CommandExecutionBlock",
    "memo",
    "isRunning",
    "isLast",
    "exitCode",
    "terminalStatus",
    "command",
    "rawOutput",
    "isExpanded",
    "setIsExpanded",
    "copied",
    "setCopied",
    "hasOutput",
    "hasOutputMarker",
    "isError",
    "handleCopy",
    "StatusIndicator",
    "Check",
    "Copy",
    "ChevronDown",
    "cn",
    "parseExitCode",
    "extractCommandMetadata",
    "MessageList",
    "setInputValue",
    "retryFailedMessage",
    "virtuosoRef",
    "combinedMessages",
    "combineCommandSequences",
    "commandExecutionByTs",
    "info",
    "data",
    "j",
    "next",
    "handleSuggestionClick",
    "handleCopyToInput",
    "handleRetryMessage",
    "handleDiscardMessage",
    "allItems",
    "q",
    "itemContent",
    "QueuedMessageItem",
    "isLastCombinedMessage",
    "MessageItem",
    "MessageCircle",
    "Virtuoso",
    "extractFollowUpData",
    "messageText",
    "parsedData",
    "safeJsonParse",
    "question",
    "icon",
    "title",
    "extraInfo",
    "User",
    "CheckCircle2",
    "AlertCircle",
    "MessageCircleQuestion",
    "followUpData",
    "TerminalSquare",
    "execInfo",
    "toolInfo",
    "toolDetails",
    "queuedMessage",
    "_isSending",
    "onRetry",
    "onDiscard",
    "Clock",
    "statusText",
    "statusColor",
    "handleRetry",
    "handleDiscard",
    "canRetry",
    "TodoIcon",
    "size",
    "iconSize",
    "checkSize",
    "AgentTodoList",
    "stats",
    "isIntegrated",
    "listRef",
    "inProgressIdx",
    "target",
    "ChevronUp",
    "todo",
    "ChatInput",
    "sessionLabel",
    "showCancel",
    "showFinishToBranch",
    "showCreatePR",
    "worktreeBranchName",
    "parentBranch",
    "sessionStatus",
    "setMessageText",
    "todoStats",
    "modelsConfig",
    "isFocused",
    "setIsFocused",
    "textareaRef",
    "addToQueue",
    "modelOptions",
    "model",
    "trimmedMessage",
    "isEmpty",
    "isSessionCompleted",
    "sendDisabled",
    "handleSend",
    "handleCancel",
    "handleFinishToBranch",
    "handleCreatePR",
    "branch",
    "targetBranch",
    "instructions",
    "handleKeyDown",
    "hasTodos",
    "DynamicTextArea",
    "SelectDropdown",
    "Square",
    "SendHorizontal",
    "BranchPicker",
    "selectedBranch",
    "onClose",
    "yourBranches",
    "otherBranches",
    "b",
    "handleSelect",
    "handleBackdropClick",
    "Command",
    "CommandInput",
    "CommandList",
    "CommandEmpty",
    "CommandGroup",
    "CommandItem",
    "CommandSeparator",
    "KiloLogo",
    "SessionDetail",
    "selectedSession",
    "selectedSessionState",
    "prevSessionStateRef",
    "prevState",
    "PendingSessionView",
    "NewAgentForm",
    "sessionUiState",
    "isProvisionalSession",
    "isSessionRunning",
    "canFinishWorktree",
    "canCreatePR",
    "Zap",
    "X",
    "promptText",
    "setPromptText",
    "runMode",
    "setRunMode",
    "versionCount",
    "setVersionCount",
    "setSelectedModelId",
    "modelsLoading",
    "effectiveModelId",
    "isStarting",
    "setIsStarting",
    "isDropdownOpen",
    "setIsDropdownOpen",
    "isVersionDropdownOpen",
    "setIsVersionDropdownOpen",
    "setSelectedBranch",
    "isBranchPickerOpen",
    "setIsBranchPickerOpen",
    "dropdownRef",
    "versionDropdownRef",
    "startSessionFailedCounter",
    "isMultiVersion",
    "effectiveRunMode",
    "handleClickOutside",
    "trimmedPrompt",
    "handleStart",
    "handleSelectMode",
    "mode",
    "handleSelectVersionCount",
    "hasModels",
    "AgentManagerApp",
    "TooltipProvider",
    "STANDARD_TOOLTIP_DELAY",
    "AgentManagerContent",
    "selectedSessionId",
    "loadTranslations",
    "container",
    "createRoot",
    "i18next",
    "ErrorBoundary"
  ],
  "mappings": "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",
  "x_google_ignoreList": [
    0,
    1,
    2,
    3,
    4,
    5,
    6,
    7,
    8,
    9,
    10,
    11,
    12
  ],
  "sourceRoot": ""
}